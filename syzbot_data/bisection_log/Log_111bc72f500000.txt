bisecting cause commit starting from f6e7a024bfe5e11d91ccff46bb576e3fb5a516ea
building syzkaller on b1c228e1773559f05fa98950902ab025d6ab946e
testing commit f6e7a024bfe5e11d91ccff46bb576e3fb5a516ea with gcc (GCC) 8.1.0
kernel signature: 91c055f07f410c3f608ae766e7449abd25257b102a19a29148b4060393c3dafc
all runs: crashed: WARNING in tcindex_alloc_perfect_hash
testing release v5.10
testing commit 2c85ebc57b3e1817b6ce1a6b703928e113a90442 with gcc (GCC) 8.1.0
kernel signature: 395a614079c9030036488f72c030c4708fae86b9aba956ca15d15003efd3a593
all runs: crashed: WARNING in tcindex_alloc_perfect_hash
testing release v5.9
testing commit bbf5c979011a099af5dc76498918ed7df445635b with gcc (GCC) 8.1.0
kernel signature: 267e4e72ea6151d6ca484a7d3cc70be89ff7365b860f2a296ca76a677664b0bf
all runs: crashed: WARNING in tcindex_alloc_perfect_hash
testing release v5.8
testing commit bcf876870b95592b52519ed4aafcf9d95999bc9c with gcc (GCC) 8.1.0
kernel signature: e1b748eb2406e6b7622d3ac2ddd4d5444e7de9e64fd85ab34f83bf371b1755d5
all runs: crashed: WARNING in tcindex_alloc_perfect_hash
testing release v5.7
testing commit 3d77e6a8804abcc0504c904bd6e5cdf3a5cf8162 with gcc (GCC) 8.1.0
kernel signature: 47862bb6707373f5ffcdd61ba6af4294f0c423a6cb2ee4daa5590631048de304
all runs: crashed: WARNING in tcindex_alloc_perfect_hash
testing release v5.6
testing commit 7111951b8d4973bda27ff663f2cf18b663d15b48 with gcc (GCC) 8.1.0
kernel signature: 61d2f47e590b5f5b9af99913aeee4a183890a5a3a42d33ead5af338d6fce77b0
all runs: crashed: WARNING in tcindex_alloc_perfect_hash
testing release v5.5
testing commit d5226fa6dbae0569ee43ecfc08bdcd6770fc4755 with gcc (GCC) 8.1.0
kernel signature: c02e30c85a426c1e8f9c3abeaf54f05a4c728b21f645f4db12a4be37adab4f4f
all runs: crashed: WARNING in tcindex_alloc_perfect_hash
testing release v5.4
testing commit 219d54332a09e8d8741c1e1982f5eae56099de85 with gcc (GCC) 8.1.0
kernel signature: 418d776f3a3a1cc9254eb5d6ca3b32cfdd18be0b9d67b015b468405fb2daecff
all runs: crashed: WARNING in tcindex_alloc_perfect_hash
testing release v5.3
testing commit 4d856f72c10ecb060868ed10ff1b1453943fc6c8 with gcc (GCC) 8.1.0
kernel signature: e249628c1ee34f77f2aa319be282abb58f3d9140778e2d153979f2cd76c9b777
all runs: crashed: WARNING in tcindex_alloc_perfect_hash
testing release v5.2
testing commit 0ecfebd2b52404ae0c54a878c872bb93363ada36 with gcc (GCC) 8.1.0
kernel signature: a6a68d9583d3a8125b02c95fc9622169e78400904b09f46799b9f3c98b341f31
all runs: crashed: WARNING in tcindex_alloc_perfect_hash
testing release v5.1
testing commit e93c9c99a629c61837d5a7fc2120cd2b6c70dbdd with gcc (GCC) 8.1.0
kernel signature: f8444d7f606701f2cba2c2b1e79ec64e2e00a9604951e8f29c97fd39394d2e63
all runs: crashed: WARNING in tcindex_alloc_perfect_hash
testing release v5.0
testing commit 1c163f4c7b3f621efff9b28a47abb36f7378d783 with gcc (GCC) 8.1.0
kernel signature: d1de21bb044e544efe5b0b18676c1120101c7d2ac339371f47a9b257538ce7cb
all runs: crashed: WARNING in tcindex_alloc_perfect_hash
testing release v4.20
testing commit 8fe28cb58bcb235034b64cbbb7550a8a43fd88be with gcc (GCC) 8.1.0
kernel signature: 18ab06c76e213d938d70492684c52e0c9a405ff7c5ba9113fe318d0230c609e4
all runs: crashed: WARNING in tcindex_alloc_perfect_hash
testing release v4.19
testing commit 84df9525b0c27f3ebc2ebb1864fa62a97fdedb7d with gcc (GCC) 8.1.0
kernel signature: 3dc7480cc8924b88d5175e910d32219e8f7b5a35f90dc8e6c71df21a23ea8a28
all runs: crashed: WARNING in tcindex_alloc_perfect_hash
testing release v4.18
testing commit 94710cac0ef4ee177a63b5227664b38c95bbf703 with gcc (GCC) 8.1.0
kernel signature: 7ae1c3e73c96daa6c11d8a449d30ef4a926383e18547c3a5b62f29b1a8eb7a76
all runs: crashed: WARNING in tcindex_alloc_perfect_hash
testing release v4.17
testing commit 29dcea88779c856c7dc92040a0c01233263101d4 with gcc (GCC) 8.1.0
kernel signature: 363d923d32e5760f6c34d9c218d93deb15f2e57bb07a30be3459d07713c2277c
all runs: crashed: WARNING in tcindex_alloc_perfect_hash
testing release v4.16
testing commit 0adb32858b0bddf4ada5f364a84ed60b196dbcda with gcc (GCC) 8.1.0
kernel signature: 6833adccf32c7c7ab63b8c8cfce31143be26b368c7671ccb7e9fc602eb86257f
all runs: crashed: WARNING in tcindex_alloc_perfect_hash
testing release v4.15
testing commit d8a5b80568a9cb66810e75b182018e9edb68e8ff with gcc (GCC) 8.1.0
kernel signature: fe56cb072f89bc0da278c92ea6601e0b2edf51585c72627447b405c9440178e0
all runs: crashed: WARNING in tcindex_alloc_perfect_hash
testing release v4.14
testing commit bebc6082da0a9f5d47a1ea2edc099bf671058bd4 with gcc (GCC) 8.1.0
kernel signature: 15a24cf71cd7f8ce7f8c6c89efb672eb560c2f6f522bfbcb6078b15e996d4d23
all runs: crashed: WARNING in tcindex_alloc_perfect_hash
testing release v4.13
testing commit 569dbb88e80deb68974ef6fdd6a13edb9d686261 with gcc (GCC) 8.1.0
kernel signature: 26c83db68621958ba38b2701bbf841ed0a3282b9a22b2da6dff34b720c70ec14
all runs: crashed: WARNING in tcindex_alloc_perfect_hash
testing release v4.12
testing commit 6f7da290413ba713f0cdd9ff1a2a9bb129ef4f6c with gcc (GCC) 8.1.0
kernel signature: 2c7b7b94b1f5223ab7878409c9944bac71ea05fb3c797e1879396914f0007c60
all runs: basic kernel testing failed: BUG: sleeping function called from invalid context in tap_get_minor
testing release v4.11
testing commit a351e9b9fc24e982ec2f0e76379a49826036da12 with gcc (GCC) 7.3.0
kernel signature: 25de69028dd0a933a7a542a560574868c74c19e1d18385d1c47033b9e3217fc7
all runs: basic kernel testing failed: BUG: sleeping function called from invalid context in tap_get_minor
testing release v4.10
testing commit c470abd4fde40ea6a0846a2beab642a578c0b8cd with gcc (GCC) 5.5.0
kernel signature: 1d325c94fb31691028d18060a4af5dd7a23a60d0724723706665ae6c65ce7c76
all runs: crashed: WARNING in tcindex_alloc_perfect_hash
testing release v4.9
testing commit 69973b830859bc6529a7a0468ba0d80ee5117826 with gcc (GCC) 5.5.0
kernel signature: ac0a75bb59a0f4e67cc9c70d985950704e843f688eab2a88dc82b11fecf864ce
all runs: crashed: WARNING in tcindex_alloc_perfect_hash
testing release v4.8
testing commit c8d2bc9bc39ebea8437fd974fdbc21847bb897a3 with gcc (GCC) 5.5.0
kernel signature: 7c8ccf6a6d3535eb463f5639d1b4d699c328d989333f5fa0c07549850924d866
all runs: crashed: WARNING in tcindex_set_parms
testing release v4.7
testing commit 523d939ef98fd712632d93a5a2b588e477a7565e with gcc (GCC) 5.5.0
kernel signature: 1fb65df0fea54150b0dcacd8848644804f5c66832c4928b97fd60fa4b20fdd8a
all runs: crashed: WARNING in alloc_kmem_pages
testing release v4.6
testing commit 2dcd0af568b0cf583645c8a317dd12e344b1c72a with gcc (GCC) 5.5.0
kernel signature: 84be91f1e5201797637adb9d96fc712bd5ecd6995168ff289ad90c6f94dfda2e
all runs: crashed: WARNING in sysfs_warn_dup
revisions tested: 27, total time: 3h28m11.680774446s (build: 2h8m24.651602368s, test: 1h15m54.104482807s)
the crash already happened on the oldest tested release
commit msg: Linux 4.6
crash: WARNING in sysfs_warn_dup
IPv6: ADDRCONF(NETDEV_UP): hsr_slave_0: link is not ready
IPv6: ADDRCONF(NETDEV_UP): hsr_slave_1: link is not ready
8021q: adding VLAN 0 to HW filter on device bond0
IPv6: ADDRCONF(NETDEV_UP): veth0: link is not ready
------------[ cut here ]------------
WARNING: CPU: 0 PID: 7934 at fs/sysfs/dir.c:31 sysfs_warn_dup+0x7b/0xa0 fs/sysfs/dir.c:30
sysfs: cannot create duplicate filename '/class/macvtap/tap50'
Kernel panic - not syncing: panic_on_warn set ...

CPU: 0 PID: 7934 Comm: syz-executor.0 Not tainted 4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 0000000000000000 ffff88013757efc8 ffffffff82dab352 ffffffff8667aec0
 ffff88013757f0a0 ffffffff8672c880 ffffffff818db72b 0000000000000009
 ffff88013757f090 ffffffff815c7a54 0000000041b58ab3 ffffffff8777b6e3
Call Trace:
 [<ffffffff82dab352>] __dump_stack lib/dump_stack.c:15 [inline]
 [<ffffffff82dab352>] dump_stack+0x136/0x1d4 lib/dump_stack.c:51
 [<ffffffff815c7a54>] panic+0x1af/0x348 kernel/panic.c:152
 [<ffffffff812effcd>] __warn+0x18d/0x1b0 kernel/panic.c:504
 [<ffffffff812f0082>] warn_slowpath_fmt+0x92/0xb0 kernel/panic.c:527
 [<ffffffff818db72b>] sysfs_warn_dup+0x7b/0xa0 fs/sysfs/dir.c:30
 [<ffffffff818dbfa1>] sysfs_do_create_link_sd.isra.0+0xd1/0xf0 fs/sysfs/symlink.c:51
 [<ffffffff818dc003>] sysfs_do_create_link fs/sysfs/symlink.c:80 [inline]
 [<ffffffff818dc003>] sysfs_create_link+0x43/0xb0 fs/sysfs/symlink.c:92
 [<ffffffff833794c1>] device_add_class_symlinks drivers/base/core.c:891 [inline]
 [<ffffffff833794c1>] device_add+0x6a1/0x1400 drivers/base/core.c:1086
 [<ffffffff8337a588>] device_create_groups_vargs+0x1c8/0x220 drivers/base/core.c:1709
 [<ffffffff8337a688>] device_create_vargs drivers/base/core.c:1749 [inline]
 [<ffffffff8337a688>] device_create+0x88/0xa0 drivers/base/core.c:1785
 [<ffffffff837c0644>] macvtap_device_event+0x1c4/0x2a0 drivers/net/macvtap.c:1298
 [<ffffffff8135417b>] notifier_call_chain+0x8b/0x170 kernel/notifier.c:93
 [<ffffffff81354281>] __raw_notifier_call_chain kernel/notifier.c:394 [inline]
 [<ffffffff81354281>] raw_notifier_call_chain+0x11/0x20 kernel/notifier.c:401
 [<ffffffff852713a7>] call_netdevice_notifiers_info+0x47/0x80 net/core/dev.c:1643
 [<ffffffff85296248>] call_netdevice_notifiers net/core/dev.c:1659 [inline]
 [<ffffffff85296248>] register_netdevice+0x8e8/0xd00 net/core/dev.c:7027
 [<ffffffff837b7d99>] macvlan_common_newlink+0x8b9/0x1090 drivers/net/macvlan.c:1316
 [<ffffffff837bea0f>] macvtap_newlink+0xbf/0x110 drivers/net/macvtap.c:471
 [<ffffffff852c6cfb>] rtnl_newlink+0xd4b/0x1230 net/core/rtnetlink.c:2466
 [<ffffffff852c17a2>] rtnetlink_rcv_msg+0x222/0x680 net/core/rtnetlink.c:3513
 [<ffffffff854461c2>] netlink_rcv_skb+0x242/0x350 net/netlink/af_netlink.c:2277
 [<ffffffff852c1575>] rtnetlink_rcv+0x25/0x30 net/core/rtnetlink.c:3519
 [<ffffffff85444d5a>] netlink_unicast_kernel net/netlink/af_netlink.c:1214 [inline]
 [<ffffffff85444d5a>] netlink_unicast+0x3da/0x560 net/netlink/af_netlink.c:1240
 [<ffffffff8544598b>] netlink_sendmsg+0x9bb/0xb40 net/netlink/af_netlink.c:1786
 [<ffffffff852205d5>] sock_sendmsg_nosec net/socket.c:612 [inline]
 [<ffffffff852205d5>] sock_sendmsg+0xb5/0xf0 net/socket.c:622
 [<ffffffff852243ca>] SYSC_sendto net/socket.c:1648 [inline]
 [<ffffffff852243ca>] SyS_sendto+0x1ca/0x290 net/socket.c:1616
 [<ffffffff864c15c0>] entry_SYSCALL_64_fastpath+0x23/0xc1
Kernel Offset: disabled

