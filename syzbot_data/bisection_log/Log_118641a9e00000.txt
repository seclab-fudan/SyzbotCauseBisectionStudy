bisecting cause commit starting from ae4b064e2a616b545acf02b8f50cc513b32c7522
building syzkaller on 08003f6440deafc4e193b159c4acece64f7864b1
testing commit ae4b064e2a616b545acf02b8f50cc513b32c7522 with gcc (GCC) 8.1.0
kernel signature: ae721cdf616a0b70a091b97b6b4b550766927680
all runs: crashed: KASAN: use-after-free Write in __alloc_skb
testing release v5.4
testing commit 219d54332a09e8d8741c1e1982f5eae56099de85 with gcc (GCC) 8.1.0
kernel signature: 14651fda5f0864007f6a43bd519071996b266747
all runs: crashed: KASAN: use-after-free Write in __alloc_skb
testing release v5.3
testing commit 4d856f72c10ecb060868ed10ff1b1453943fc6c8 with gcc (GCC) 8.1.0
kernel signature: d3e58f895f7076ac455e838ec3fcfaeddafd57f0
all runs: crashed: KASAN: use-after-free Write in __alloc_skb
testing release v5.2
testing commit 0ecfebd2b52404ae0c54a878c872bb93363ada36 with gcc (GCC) 8.1.0
kernel signature: 6c2df1265477b155c9270efa3c583c2600ec2a4a
all runs: crashed: KASAN: use-after-free Write in __alloc_skb
testing release v5.1
testing commit e93c9c99a629c61837d5a7fc2120cd2b6c70dbdd with gcc (GCC) 8.1.0
kernel signature: 858c06644e9554c27507eafbfb3983ba5b64f01e
all runs: crashed: KASAN: use-after-free Write in __alloc_skb
testing release v5.0
testing commit 1c163f4c7b3f621efff9b28a47abb36f7378d783 with gcc (GCC) 8.1.0
kernel signature: 0f6f9f8206354a9a2812b6f8754360c02442e3e5
all runs: crashed: KASAN: use-after-free Write in __alloc_skb
testing release v4.20
testing commit 8fe28cb58bcb235034b64cbbb7550a8a43fd88be with gcc (GCC) 8.1.0
kernel signature: c7fd8904e6c73dfd95b8a45733ac282e694db60d
all runs: crashed: KASAN: use-after-free Write in __alloc_skb
testing release v4.19
testing commit 84df9525b0c27f3ebc2ebb1864fa62a97fdedb7d with gcc (GCC) 8.1.0
kernel signature: 97a04a8bc833739004ebdbff7be8bbdad338643e
all runs: crashed: KASAN: use-after-free Write in __alloc_skb
testing release v4.18
testing commit 94710cac0ef4ee177a63b5227664b38c95bbf703 with gcc (GCC) 8.1.0
kernel signature: 2469c37ec2e60fa54086348cdac88eb08d1037cf
all runs: crashed: KASAN: use-after-free Write in __alloc_skb
testing release v4.17
testing commit 29dcea88779c856c7dc92040a0c01233263101d4 with gcc (GCC) 8.1.0
kernel signature: d7db1d9586dcdd1c262aacb865f7bea9ba978984
all runs: crashed: KASAN: use-after-free Write in __alloc_skb
testing release v4.16
testing commit 0adb32858b0bddf4ada5f364a84ed60b196dbcda with gcc (GCC) 8.1.0
kernel signature: cdc97fa55676fb155dfd905410d6367938b5f73f
all runs: crashed: KASAN: use-after-free Write in __alloc_skb
testing release v4.15
testing commit d8a5b80568a9cb66810e75b182018e9edb68e8ff with gcc (GCC) 8.1.0
kernel signature: 729ecd9673742733f0be68697eef53c7c318e348
all runs: crashed: KASAN: use-after-free Write in __alloc_skb
testing release v4.14
testing commit bebc6082da0a9f5d47a1ea2edc099bf671058bd4 with gcc (GCC) 8.1.0
kernel signature: 61503ad50e861f47ff856a8b62e6fef2cf557a24
run #0: crashed: BUG: unable to handle kernel paging request in __alloc_skb
run #1: crashed: KASAN: use-after-free Write in __alloc_skb
run #2: crashed: BUG: unable to handle kernel paging request in __alloc_skb
run #3: crashed: BUG: unable to handle kernel paging request in __alloc_skb
run #4: crashed: BUG: unable to handle kernel paging request in __alloc_skb
run #5: crashed: BUG: unable to handle kernel paging request in __alloc_skb
run #6: crashed: BUG: unable to handle kernel paging request in __alloc_skb
run #7: crashed: BUG: unable to handle kernel paging request in __alloc_skb
run #8: crashed: BUG: unable to handle kernel paging request in __alloc_skb
run #9: crashed: BUG: unable to handle kernel paging request in __alloc_skb
testing release v4.13
testing commit 569dbb88e80deb68974ef6fdd6a13edb9d686261 with gcc (GCC) 8.1.0
kernel signature: 7fdde493271c2cbb66c80b02c56e060ca3cb1e54
run #0: crashed: BUG: unable to handle kernel paging request in __alloc_skb
run #1: crashed: BUG: unable to handle kernel paging request in __alloc_skb
run #2: crashed: BUG: unable to handle kernel paging request in __alloc_skb
run #3: crashed: BUG: unable to handle kernel paging request in __alloc_skb
run #4: crashed: BUG: unable to handle kernel paging request in __alloc_skb
run #5: crashed: KASAN: use-after-free Write in __alloc_skb
run #6: crashed: BUG: unable to handle kernel paging request in __alloc_skb
run #7: crashed: BUG: unable to handle kernel paging request in __alloc_skb
run #8: crashed: BUG: unable to handle kernel paging request in __alloc_skb
run #9: crashed: BUG: unable to handle kernel paging request in __alloc_skb
testing release v4.12
testing commit 6f7da290413ba713f0cdd9ff1a2a9bb129ef4f6c with gcc (GCC) 8.1.0
kernel signature: db571b8e25c4aec1c19bc8a2cf5cd07467464871
run #0: crashed: BUG: unable to handle kernel paging request in __alloc_skb
run #1: crashed: BUG: unable to handle kernel paging request in __alloc_skb
run #2: crashed: BUG: unable to handle kernel paging request in __alloc_skb
run #3: crashed: BUG: unable to handle kernel paging request in __alloc_skb
run #4: crashed: BUG: unable to handle kernel paging request in __alloc_skb
run #5: crashed: BUG: unable to handle kernel paging request in __alloc_skb
run #6: crashed: KASAN: use-after-free Write in __alloc_skb
run #7: crashed: BUG: unable to handle kernel paging request in __alloc_skb
run #8: crashed: KASAN: use-after-free Write in __alloc_skb
run #9: crashed: BUG: unable to handle kernel paging request in __alloc_skb
testing release v4.11
testing commit a351e9b9fc24e982ec2f0e76379a49826036da12 with gcc (GCC) 7.3.0
kernel signature: 8b73b425f8c205a66b5635dde3f22568fd7f3d61
all runs: crashed: BUG: unable to handle kernel paging request in __alloc_skb
testing release v4.10
testing commit c470abd4fde40ea6a0846a2beab642a578c0b8cd with gcc (GCC) 5.5.0
kernel signature: 74f210c0076aaaace8adf32d5acbbbad20e4d35f
all runs: crashed: BUG: unable to handle kernel paging request in __alloc_skb
testing release v4.9
testing commit 69973b830859bc6529a7a0468ba0d80ee5117826 with gcc (GCC) 5.5.0
kernel signature: 9c72dfd4cf30dbc40af21b564eb81b6721a113cc
run #0: crashed: BUG: unable to handle kernel paging request in __alloc_skb
run #1: crashed: BUG: unable to handle kernel paging request in __alloc_skb
run #2: crashed: BUG: unable to handle kernel
run #3: crashed: BUG: unable to handle kernel paging request in __alloc_skb
run #4: crashed: BUG: unable to handle kernel paging request in __alloc_skb
run #5: crashed: BUG: unable to handle kernel paging request in __alloc_skb
run #6: crashed: BUG: unable to handle kernel
run #7: crashed: BUG: unable to handle kernel paging request in __alloc_skb
run #8: crashed: BUG: unable to handle kernel
run #9: crashed: KASAN: use-after-free Write in __alloc_skb
testing release v4.8
testing commit c8d2bc9bc39ebea8437fd974fdbc21847bb897a3 with gcc (GCC) 5.5.0
kernel signature: 31afd8144837211fe1570c832bdcdfe133dba8d1
run #0: crashed: BUG: unable to handle kernel paging request in __alloc_skb
run #1: crashed: BUG: unable to handle kernel
run #2: crashed: BUG: unable to handle kernel paging request in __alloc_skb
run #3: crashed: BUG: unable to handle kernel paging request in __alloc_skb
run #4: crashed: BUG: unable to handle kernel paging request in __alloc_skb
run #5: crashed: BUG: unable to handle kernel paging request in __alloc_skb
run #6: crashed: BUG: unable to handle kernel paging request in __alloc_skb
run #7: crashed: BUG: unable to handle kernel paging request in __alloc_skb
run #8: crashed: BUG: unable to handle kernel paging request in __alloc_skb
run #9: crashed: BUG: unable to handle kernel paging request in __alloc_skb
testing release v4.7
testing commit 523d939ef98fd712632d93a5a2b588e477a7565e with gcc (GCC) 5.5.0
kernel signature: 5b5cfb45a5d6fda4acc9c999988e6ade8a8fcafd
run #0: crashed: KASAN: use-after-free Write in __alloc_skb
run #1: crashed: KASAN: use-after-free Write in __alloc_skb
run #2: crashed: KASAN: use-after-free Write in __alloc_skb
run #3: crashed: KASAN: use-after-free Write in __alloc_skb
run #4: crashed: KASAN: use-after-free Write in __alloc_skb
run #5: crashed: KASAN: use-after-free Write in __alloc_skb
run #6: crashed: BUG: unable to handle kernel paging request in __alloc_skb
run #7: crashed: KASAN: use-after-free Write in __alloc_skb
run #8: crashed: KASAN: use-after-free Write in __alloc_skb
run #9: crashed: KASAN: use-after-free Write in __alloc_skb
testing release v4.6
testing commit 2dcd0af568b0cf583645c8a317dd12e344b1c72a with gcc (GCC) 5.5.0
kernel signature: 4d7e9dc881d61334df2a13acdc496fbc1febf9b6
run #0: crashed: KASAN: use-after-free Write in __alloc_skb
run #1: crashed: KASAN: use-after-free Write in __alloc_skb
run #2: crashed: KASAN: use-after-free Write in __alloc_skb
run #3: crashed: BUG: unable to handle kernel paging request in __alloc_skb
run #4: crashed: KASAN: use-after-free Write in __alloc_skb
run #5: crashed: KASAN: use-after-free Write in __alloc_skb
run #6: crashed: KASAN: use-after-free Write in __alloc_skb
run #7: crashed: KASAN: use-after-free Write in __alloc_skb
run #8: crashed: KASAN: use-after-free Write in __alloc_skb
run #9: crashed: KASAN: use-after-free Write in __alloc_skb
revisions tested: 21, total time: 3h7m43.493244532s (build: 1h51m8.970787545s, test: 1h13m40.232527222s)
the crash already happened on the oldest tested release
commit msg: Linux 4.6
crash: KASAN: use-after-free Write in __alloc_skb
8021q: adding VLAN 0 to HW filter on device bond0
IPv6: ADDRCONF(NETDEV_CHANGE): veth0: link becomes ready
netlink: 2 bytes leftover after parsing attributes in process `syz-executor.1'.
IPv6: ADDRCONF(NETDEV_UP): veth0: link is not ready
==================================================================
BUG: KASAN: use-after-free in memset+0x1a/0x30 mm/kasan/kasan.c:301 at addr ffff8801a7fc7500
Write of size 32 by task udevd/7315
page:ffffea00069ff1c0 count:0 mapcount:0 mapping:          (null) index:0x0
flags: 0x57ffe0000000000()
page dumped because: kasan: bad access detected
IPv6: ADDRCONF(NETDEV_CHANGE): veth0: link becomes ready
CPU: 0 PID: 7315 Comm: udevd Not tainted 4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0d9577e ffff88012c0076d8 ffffffff82c4dd46 ffff8801a7fc7500
 ffff88012c007768 ffff8801a7fc7500 ffff88012c007850 ffff88012c007758
 ffffffff817405ba ffff880126aa2640 ffffffff86d0ede0 0000000000000286
Call Trace:
 <IRQ>  [<ffffffff82c4dd46>] __dump_stack lib/dump_stack.c:15 [inline]
 <IRQ>  [<ffffffff82c4dd46>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff817405ba>] print_address_description mm/kasan/report.c:190 [inline]
 [<ffffffff817405ba>] kasan_report_error+0x59a/0x5c0 mm/kasan/report.c:275
 [<ffffffff81740914>] kasan_report+0x34/0x40 mm/kasan/report.c:297
IPv6: ADDRCONF(NETDEV_CHANGE): bridge_slave_0: link becomes ready
bridge0: port 1(bridge_slave_0) entered blocking state
bridge0: port 1(bridge_slave_0) entered forwarding state
IPv6: ADDRCONF(NETDEV_CHANGE): bridge0: link becomes ready
IPv6: ADDRCONF(NETDEV_CHANGE): bridge_slave_1: link becomes ready
bridge0: port 2(bridge_slave_1) entered blocking state
bridge0: port 2(bridge_slave_1) entered forwarding state
 [<ffffffff8173f34d>] check_memory_region mm/kasan/kasan.c:285 [inline]
 [<ffffffff8173f34d>] __asan_storeN+0x12d/0x180 mm/kasan/kasan.c:688
 [<ffffffff8173f81a>] memset+0x1a/0x30 mm/kasan/kasan.c:301
 [<ffffffff848fb78a>] __alloc_skb+0x31a/0x5b0 net/core/skbuff.c:259
 [<ffffffff8490099d>] alloc_skb include/linux/skbuff.h:895 [inline]
 [<ffffffff8490099d>] alloc_skb_with_frags+0x8d/0x4b0 net/core/skbuff.c:4557
IPv6: ADDRCONF(NETDEV_UP): veth0_to_team: link is not ready
IPv6: ADDRCONF(NETDEV_UP): veth1_to_team: link is not ready
 [<ffffffff848ec559>] sock_alloc_send_pskb+0x5c9/0x740 net/core/sock.c:1851
IPv6: ADDRCONF(NETDEV_CHANGE): hsr_slave_0: link becomes ready
IPv6: ADDRCONF(NETDEV_CHANGE): hsr_slave_1: link becomes ready
 [<ffffffff848ec6e3>] sock_alloc_send_skb+0x13/0x20 net/core/sock.c:1868
 [<ffffffff85080a8b>] mld_newpack+0x1bb/0x930 net/ipv6/mcast.c:1571
 [<ffffffff850814ba>] add_grhead.isra.29+0x2ba/0x3a0 net/ipv6/mcast.c:1678
 [<ffffffff85085d7c>] add_grec+0x85c/0xcb0 net/ipv6/mcast.c:1793
 [<ffffffff8508689b>] mld_send_cr net/ipv6/mcast.c:1919 [inline]
 [<ffffffff8508689b>] mld_ifc_timer_expire+0x2fb/0x710 net/ipv6/mcast.c:2425
 [<ffffffff814a053e>] call_timer_fn+0x14e/0x620 kernel/time/timer.c:1178
 [<ffffffff814a1007>] __run_timers kernel/time/timer.c:1254 [inline]
 [<ffffffff814a1007>] run_timer_softirq+0x5f7/0x9c0 kernel/time/timer.c:1437
 [<ffffffff85b7302c>] __do_softirq+0x2cc/0xa06 kernel/softirq.c:273
 [<ffffffff81355107>] invoke_softirq kernel/softirq.c:350 [inline]
 [<ffffffff81355107>] irq_exit+0x157/0x190 kernel/softirq.c:391
 [<ffffffff85b727bb>] exiting_irq arch/x86/include/asm/apic.h:658 [inline]
 [<ffffffff85b727bb>] smp_apic_timer_interrupt+0x7b/0xa0 arch/x86/kernel/apic/apic.c:932
 [<ffffffff85b70afc>] apic_timer_interrupt+0x8c/0xa0 arch/x86/entry/entry_64.S:621
 <EOI>  [<ffffffff8297b14f>] ? __read_once_size include/linux/compiler.h:222 [inline]
 <EOI>  [<ffffffff8297b14f>] ? avc_search_node security/selinux/avc.c:583 [inline]
 <EOI>  [<ffffffff8297b14f>] ? avc_lookup security/selinux/avc.c:612 [inline]
 <EOI>  [<ffffffff8297b14f>] ? avc_has_perm_noaudit security/selinux/avc.c:1112 [inline]
 <EOI>  [<ffffffff8297b14f>] ? avc_has_perm+0x1bf/0x470 security/selinux/avc.c:1148
 [<ffffffff829899ef>] inode_has_perm.isra.47+0x13f/0x1c0 security/selinux/hooks.c:1689
 [<ffffffff8298ba7b>] dentry_has_perm security/selinux/hooks.c:1705 [inline]
 [<ffffffff8298ba7b>] selinux_inode_readlink+0xdb/0x120 security/selinux/hooks.c:2906
 [<ffffffff829721a1>] security_inode_readlink+0xb1/0xf0 security/security.c:584
 [<ffffffff817a7341>] SYSC_readlinkat fs/stat.c:333 [inline]
 [<ffffffff817a7341>] SyS_readlinkat fs/stat.c:315 [inline]
 [<ffffffff817a7341>] SYSC_readlink fs/stat.c:352 [inline]
 [<ffffffff817a7341>] SyS_readlink+0x141/0x290 fs/stat.c:349
 [<ffffffff85b6fe80>] entry_SYSCALL_64_fastpath+0x23/0xc1
Memory state around the buggy address:
 ffff8801a7fc7400: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8801a7fc7480: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
>ffff8801a7fc7500: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
                   ^
 ffff8801a7fc7580: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8801a7fc7600: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
==================================================================
==================================================================
BUG: KASAN: use-after-free in __write_once_size include/linux/compiler.h:250 [inline] at addr ffff8801a7fc7520
BUG: KASAN: use-after-free in atomic_set arch/x86/include/asm/atomic.h:38 [inline] at addr ffff8801a7fc7520
BUG: KASAN: use-after-free in __alloc_skb+0x4bb/0x5b0 net/core/skbuff.c:260 at addr ffff8801a7fc7520
Write of size 4 by task udevd/7315
page:ffffea00069ff1c0 count:0 mapcount:0 mapping:          (null) index:0x0
flags: 0x57ffe0000000000()
page dumped because: kasan: bad access detected
CPU: 0 PID: 7315 Comm: udevd Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0d9577e ffff88012c007710 ffffffff82c4dd46 0000000000000000[   68.293987] IPv6: ADDRCONF(NETDEV_CHANGE): bridge_slave_0: link becomes ready
bridge0: port 1(bridge_slave_0) entered blocking state
bridge0: port 1(bridge_slave_0) entered forwarding state
IPv6: ADDRCONF(NETDEV_CHANGE): bridge0: link becomes ready
IPv6: ADDRCONF(NETDEV_CHANGE): bridge_slave_1: link becomes ready
bridge0: port 2(bridge_slave_1) entered blocking state
bridge0: port 2(bridge_slave_1) entered forwarding state

 ffff88012c0077a0 ffff8801a7fc7520[   68.346229] IPv6: ADDRCONF(NETDEV_UP): veth0_to_team: link is not ready
IPv6: ADDRCONF(NETDEV_UP): veth1_to_team: link is not ready
IPv6: ADDRCONF(NETDEV_CHANGE): hsr_slave_0: link becomes ready
 ffff88012c007850[   68.369668] IPv6: ADDRCONF(NETDEV_CHANGE): hsr_slave_1: link becomes ready
 ffff88012c007790
 ffffffff817405ba 6637613130383866 00203a3030363763 0000000000000286
Call Trace:
 <IRQ>  [<ffffffff82c4dd46>] __dump_stack lib/dump_stack.c:15 [inline]
 <IRQ>  [<ffffffff82c4dd46>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff817405ba>] print_address_description mm/kasan/report.c:190 [inline]
 [<ffffffff817405ba>] kasan_report_error+0x59a/0x5c0 mm/kasan/report.c:275
 [<ffffffff817407de>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff817407de>] __asan_report_store4_noabort+0x3e/0x40 mm/kasan/report.c:322
 [<ffffffff848fb92b>] __write_once_size include/linux/compiler.h:250 [inline]
 [<ffffffff848fb92b>] atomic_set arch/x86/include/asm/atomic.h:38 [inline]
 [<ffffffff848fb92b>] __alloc_skb+0x4bb/0x5b0 net/core/skbuff.c:260
 [<ffffffff8490099d>] alloc_skb include/linux/skbuff.h:895 [inline]
 [<ffffffff8490099d>] alloc_skb_with_frags+0x8d/0x4b0 net/core/skbuff.c:4557
 [<ffffffff848ec559>] sock_alloc_send_pskb+0x5c9/0x740 net/core/sock.c:1851
 [<ffffffff848ec6e3>] sock_alloc_send_skb+0x13/0x20 net/core/sock.c:1868
 [<ffffffff85080a8b>] mld_newpack+0x1bb/0x930 net/ipv6/mcast.c:1571
 [<ffffffff850814ba>] add_grhead.isra.29+0x2ba/0x3a0 net/ipv6/mcast.c:1678
 [<ffffffff85085d7c>] add_grec+0x85c/0xcb0 net/ipv6/mcast.c:1793
 [<ffffffff8508689b>] mld_send_cr net/ipv6/mcast.c:1919 [inline]
 [<ffffffff8508689b>] mld_ifc_timer_expire+0x2fb/0x710 net/ipv6/mcast.c:2425
 [<ffffffff814a053e>] call_timer_fn+0x14e/0x620 kernel/time/timer.c:1178
 [<ffffffff814a1007>] __run_timers kernel/time/timer.c:1254 [inline]
 [<ffffffff814a1007>] run_timer_softirq+0x5f7/0x9c0 kernel/time/timer.c:1437
 [<ffffffff85b7302c>] __do_softirq+0x2cc/0xa06 kernel/softirq.c:273
 [<ffffffff81355107>] invoke_softirq kernel/softirq.c:350 [inline]
 [<ffffffff81355107>] irq_exit+0x157/0x190 kernel/softirq.c:391
 [<ffffffff85b727bb>] exiting_irq arch/x86/include/asm/apic.h:658 [inline]
 [<ffffffff85b727bb>] smp_apic_timer_interrupt+0x7b/0xa0 arch/x86/kernel/apic/apic.c:932
 [<ffffffff85b70afc>] apic_timer_interrupt+0x8c/0xa0 arch/x86/entry/entry_64.S:621
 <EOI>  [<ffffffff8297b14f>] ? __read_once_size include/linux/compiler.h:222 [inline]
 <EOI>  [<ffffffff8297b14f>] ? avc_search_node security/selinux/avc.c:583 [inline]
 <EOI>  [<ffffffff8297b14f>] ? avc_lookup security/selinux/avc.c:612 [inline]
 <EOI>  [<ffffffff8297b14f>] ? avc_has_perm_noaudit security/selinux/avc.c:1112 [inline]
 <EOI>  [<ffffffff8297b14f>] ? avc_has_perm+0x1bf/0x470 security/selinux/avc.c:1148
 [<ffffffff829899ef>] inode_has_perm.isra.47+0x13f/0x1c0 security/selinux/hooks.c:1689
 [<ffffffff8298ba7b>] dentry_has_perm security/selinux/hooks.c:1705 [inline]
 [<ffffffff8298ba7b>] selinux_inode_readlink+0xdb/0x120 security/selinux/hooks.c:2906
 [<ffffffff829721a1>] security_inode_readlink+0xb1/0xf0 security/security.c:584
 [<ffffffff817a7341>] SYSC_readlinkat fs/stat.c:333 [inline]
 [<ffffffff817a7341>] SyS_readlinkat fs/stat.c:315 [inline]
 [<ffffffff817a7341>] SYSC_readlink fs/stat.c:352 [inline]
 [<ffffffff817a7341>] SyS_readlink+0x141/0x290 fs/stat.c:349
 [<ffffffff85b6fe80>] entry_SYSCALL_64_fastpath+0x23/0xc1
Memory state around the buggy address:
 ffff8801a7fc7400: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8801a7fc7480: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
>ffff8801a7fc7500: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
                               ^
 ffff8801a7fc7580: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8801a7fc7600: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
==================================================================
==================================================================
BUG: KASAN: use-after-free in __dev_queue_xmit+0x1828/0x1f40 net/core/dev.c:3282 at addr ffff8801a7fc7501
Read of size 1 by task udevd/7315
page:ffffea00069ff1c0 count:0 mapcount:0 mapping:          (null) index:0x0
flags: 0x57ffe0000000000()
page dumped because: kasan: bad access detected
CPU: 0 PID: 7315 Comm: udevd Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0d9577e ffff88012c0075e8 ffffffff82c4dd46 ffff8800b5aead86
 ffff88012c007678 ffff8801a7fc7501 ffff8800b5aeace0 ffff88012c007668
 ffffffff817405ba ffffffff00000000 1ffff10025800ec2 0000000000000286
Call Trace:
 <IRQ>  [<ffffffff82c4dd46>] __dump_stack lib/dump_stack.c:15 [inline]
 <IRQ>  [<ffffffff82c4dd46>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff817405ba>] print_address_description mm/kasan/report.c:190 [inline]
 [<ffffffff817405ba>] kasan_report_error+0x59a/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174061e>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174061e>] __asan_report_load1_noabort+0x3e/0x40 mm/kasan/report.c:315
 [<ffffffff84953c48>] __dev_queue_xmit+0x1828/0x1f40 net/core/dev.c:3282
 [<ffffffff8495436b>] dev_queue_xmit+0xb/0x10 net/core/dev.c:3392
 [<ffffffff849748c8>] neigh_resolve_output+0x488/0x7d0 net/core/neighbour.c:1311
 [<ffffffff84ffaefb>] dst_neigh_output include/net/dst.h:467 [inline]
 [<ffffffff84ffaefb>] ip6_finish_output2+0x98b/0x1b90 net/ipv6/ip6_output.c:113
 [<ffffffff85004813>] ip6_finish_output+0x353/0x700 net/ipv6/ip6_output.c:131
 [<ffffffff85004d27>] NF_HOOK_COND include/linux/netfilter.h:233 [inline]
 [<ffffffff85004d27>] ip6_output+0x167/0x530 net/ipv6/ip6_output.c:145
 [<ffffffff85082c89>] dst_output include/net/dst.h:504 [inline]
 [<ffffffff85082c89>] NF_HOOK_THRESH.constprop.38+0xc9/0x290 include/linux/netfilter.h:219
 [<ffffffff85084f98>] NF_HOOK include/linux/netfilter.h:242 [inline]
 [<ffffffff85084f98>] mld_sendpack+0x5f8/0xb80 net/ipv6/mcast.c:1646
 [<ffffffff85086900>] mld_send_cr net/ipv6/mcast.c:1927 [inline]
 [<ffffffff85086900>] mld_ifc_timer_expire+0x360/0x710 net/ipv6/mcast.c:2425
 [<ffffffff814a053e>] call_timer_fn+0x14e/0x620 kernel/time/timer.c:1178
 [<ffffffff814a1007>] __run_timers kernel/time/timer.c:1254 [inline]
 [<ffffffff814a1007>] run_timer_softirq+0x5f7/0x9c0 kernel/time/timer.c:1437
 [<ffffffff85b7302c>] __do_softirq+0x2cc/0xa06 kernel/softirq.c:273
 [<ffffffff81355107>] invoke_softirq kernel/softirq.c:350 [inline]
 [<ffffffff81355107>] irq_exit+0x157/0x190 kernel/softirq.c:391
 [<ffffffff85b727bb>] exiting_irq arch/x86/include/asm/apic.h:658 [inline]
 [<ffffffff85b727bb>] smp_apic_timer_interrupt+0x7b/0xa0 arch/x86/kernel/apic/apic.c:932
 [<ffffffff85b70afc>] apic_timer_interrupt+0x8c/0xa0 arch/x86/entry/entry_64.S:621
 <EOI>  [<ffffffff8297b14f>] ? __read_once_size include/linux/compiler.h:222 [inline]
 <EOI>  [<ffffffff8297b14f>] ? avc_search_node security/selinux/avc.c:583 [inline]
 <EOI>  [<ffffffff8297b14f>] ? avc_lookup security/selinux/avc.c:612 [inline]
 <EOI>  [<ffffffff8297b14f>] ? avc_has_perm_noaudit security/selinux/avc.c:1112 [inline]
 <EOI>  [<ffffffff8297b14f>] ? avc_has_perm+0x1bf/0x470 security/selinux/avc.c:1148
 [<ffffffff829899ef>] inode_has_perm.isra.47+0x13f/0x1c0 security/selinux/hooks.c:1689
 [<ffffffff8298ba7b>] dentry_has_perm security/selinux/hooks.c:1705 [inline]
 [<ffffffff8298ba7b>] selinux_inode_readlink+0xdb/0x120 security/selinux/hooks.c:2906
 [<ffffffff829721a1>] security_inode_readlink+0xb1/0xf0 security/security.c:584
 [<ffffffff817a7341>] SYSC_readlinkat fs/stat.c:333 [inline]
 [<ffffffff817a7341>] SyS_readlinkat fs/stat.c:315 [inline]
 [<ffffffff817a7341>] SYSC_readlink fs/stat.c:352 [inline]
 [<ffffffff817a7341>] SyS_readlink+0x141/0x290 fs/stat.c:349
 [<ffffffff85b6fe80>] entry_SYSCALL_64_fastpath+0x23/0xc1
Memory state around the buggy address:
 ffff8801a7fc7400: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8801a7fc7480: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
>ffff8801a7fc7500: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
                   ^
 ffff8801a7fc7580: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8801a7fc7600: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
==================================================================
==================================================================
BUG: KASAN: use-after-free in qdisc_pkt_len_init net/core/dev.c:3002 [inline] at addr ffff8801a7fc7502
BUG: KASAN: use-after-free in __dev_queue_xmit+0x17db/0x1f40 net/core/dev.c:3292 at addr ffff8801a7fc7502
Read of size 2 by task udevd/7315
page:ffffea00069ff1c0 count:0 mapcount:0 mapping:          (null) index:0x0
flags: 0x57ffe0000000000()
page dumped because: kasan: bad access detected
CPU: 0 PID: 7315 Comm: udevd Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0d9577e ffff88012c0075e8 ffffffff82c4dd46 ffff8800b5aead86
 ffff88012c007678 ffff8801a7fc7502 ffff8801a7fc7500 ffff88012c007668
 ffffffff817405ba 0000000000000010 ffff880126aa2640 0000000000000286
Call Trace:
 <IRQ>  [<ffffffff82c4dd46>] __dump_stack lib/dump_stack.c:15 [inline]
 <IRQ>  [<ffffffff82c4dd46>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff817405ba>] print_address_description mm/kasan/report.c:190 [inline]
 [<ffffffff817405ba>] kasan_report_error+0x59a/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174065e>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174065e>] __asan_report_load2_noabort+0x3e/0x40 mm/kasan/report.c:316
 [<ffffffff84953bfb>] qdisc_pkt_len_init net/core/dev.c:3002 [inline]
 [<ffffffff84953bfb>] __dev_queue_xmit+0x17db/0x1f40 net/core/dev.c:3292
 [<ffffffff8495436b>] dev_queue_xmit+0xb/0x10 net/core/dev.c:3392
 [<ffffffff849748c8>] neigh_resolve_output+0x488/0x7d0 net/core/neighbour.c:1311
 [<ffffffff84ffaefb>] dst_neigh_output include/net/dst.h:467 [inline]
 [<ffffffff84ffaefb>] ip6_finish_output2+0x98b/0x1b90 net/ipv6/ip6_output.c:113
 [<ffffffff85004813>] ip6_finish_output+0x353/0x700 net/ipv6/ip6_output.c:131
 [<ffffffff85004d27>] NF_HOOK_COND include/linux/netfilter.h:233 [inline]
 [<ffffffff85004d27>] ip6_output+0x167/0x530 net/ipv6/ip6_output.c:145
 [<ffffffff85082c89>] dst_output include/net/dst.h:504 [inline]
 [<ffffffff85082c89>] NF_HOOK_THRESH.constprop.38+0xc9/0x290 include/linux/netfilter.h:219
 [<ffffffff85084f98>] NF_HOOK include/linux/netfilter.h:242 [inline]
 [<ffffffff85084f98>] mld_sendpack+0x5f8/0xb80 net/ipv6/mcast.c:1646
 [<ffffffff85086900>] mld_send_cr net/ipv6/mcast.c:1927 [inline]
 [<ffffffff85086900>] mld_ifc_timer_expire+0x360/0x710 net/ipv6/mcast.c:2425
 [<ffffffff814a053e>] call_timer_fn+0x14e/0x620 kernel/time/timer.c:1178
 [<ffffffff814a1007>] __run_timers kernel/time/timer.c:1254 [inline]
 [<ffffffff814a1007>] run_timer_softirq+0x5f7/0x9c0 kernel/time/timer.c:1437
 [<ffffffff85b7302c>] __do_softirq+0x2cc/0xa06 kernel/softirq.c:273
 [<ffffffff81355107>] invoke_softirq kernel/softirq.c:350 [inline]
 [<ffffffff81355107>] irq_exit+0x157/0x190 kernel/softirq.c:391
 [<ffffffff85b727bb>] exiting_irq arch/x86/include/asm/apic.h:658 [inline]
 [<ffffffff85b727bb>] smp_apic_timer_interrupt+0x7b/0xa0 arch/x86/kernel/apic/apic.c:932
 [<ffffffff85b70afc>] apic_timer_interrupt+0x8c/0xa0 arch/x86/entry/entry_64.S:621
 <EOI>  [<ffffffff8297b14f>] ? __read_once_size include/linux/compiler.h:222 [inline]
 <EOI>  [<ffffffff8297b14f>] ? avc_search_node security/selinux/avc.c:583 [inline]
 <EOI>  [<ffffffff8297b14f>] ? avc_lookup security/selinux/avc.c:612 [inline]
 <EOI>  [<ffffffff8297b14f>] ? avc_has_perm_noaudit security/selinux/avc.c:1112 [inline]
 <EOI>  [<ffffffff8297b14f>] ? avc_has_perm+0x1bf/0x470 security/selinux/avc.c:1148
 [<ffffffff829899ef>] inode_has_perm.isra.47+0x13f/0x1c0 security/selinux/hooks.c:1689
 [<ffffffff8298ba7b>] dentry_has_perm security/selinux/hooks.c:1705 [inline]
 [<ffffffff8298ba7b>] selinux_inode_readlink+0xdb/0x120 security/selinux/hooks.c:2906
 [<ffffffff829721a1>] security_inode_readlink+0xb1/0xf0 security/security.c:584
 [<ffffffff817a7341>] SYSC_readlinkat fs/stat.c:333 [inline]
 [<ffffffff817a7341>] SyS_readlinkat fs/stat.c:315 [inline]
 [<ffffffff817a7341>] SYSC_readlink fs/stat.c:352 [inline]
 [<ffffffff817a7341>] SyS_readlink+0x141/0x290 fs/stat.c:349
 [<ffffffff85b6fe80>] entry_SYSCALL_64_fastpath+0x23/0xc1
Memory state around the buggy address:
 ffff8801a7fc7400: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8801a7fc7480: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
>ffff8801a7fc7500: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
                   ^
 ffff8801a7fc7580: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8801a7fc7600: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
==================================================================
==================================================================
BUG: KASAN: use-after-free in netif_skb_features+0x601/0x7d0 net/core/dev.c:2832 at addr ffff8801a7fc7504
Read of size 2 by task udevd/7315
page:ffffea00069ff1c0 count:0 mapcount:0 mapping:          (null) index:0x0
flags: 0x57ffe0000000000()
page dumped because: kasan: bad access detected
CPU: 0 PID: 7315 Comm: udevd Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0d9577e ffff88012c0074e8 ffffffff82c4dd46 ffff8800b5aeacc0
 ffff88012c007578 ffff8801a7fc7504 ffff8800b5aeace0 ffff88012c007568
 ffffffff817405ba 1ffffffff0eca2ec 0000000000000000 0000000000000286
Call Trace:
 <IRQ>  [<ffffffff82c4dd46>] __dump_stack lib/dump_stack.c:15 [inline]
 <IRQ>  [<ffffffff82c4dd46>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff817405ba>] print_address_description mm/kasan/report.c:190 [inline]
 [<ffffffff817405ba>] kasan_report_error+0x59a/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174065e>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174065e>] __asan_report_load2_noabort+0x3e/0x40 mm/kasan/report.c:316
 [<ffffffff84950361>] netif_skb_features+0x601/0x7d0 net/core/dev.c:2832
 [<ffffffff84950550>] validate_xmit_skb.isra.107.part.108+0x20/0xa20 net/core/dev.c:2921
 [<ffffffff8495407d>] validate_xmit_skb net/core/dev.c:3059 [inline]
 [<ffffffff8495407d>] __dev_queue_xmit+0x1c5d/0x1f40 net/core/dev.c:3350
 [<ffffffff8495436b>] dev_queue_xmit+0xb/0x10 net/core/dev.c:3392
 [<ffffffff849748c8>] neigh_resolve_output+0x488/0x7d0 net/core/neighbour.c:1311
 [<ffffffff84ffaefb>] dst_neigh_output include/net/dst.h:467 [inline]
 [<ffffffff84ffaefb>] ip6_finish_output2+0x98b/0x1b90 net/ipv6/ip6_output.c:113
 [<ffffffff85004813>] ip6_finish_output+0x353/0x700 net/ipv6/ip6_output.c:131
 [<ffffffff85004d27>] NF_HOOK_COND include/linux/netfilter.h:233 [inline]
 [<ffffffff85004d27>] ip6_output+0x167/0x530 net/ipv6/ip6_output.c:145
 [<ffffffff85082c89>] dst_output include/net/dst.h:504 [inline]
 [<ffffffff85082c89>] NF_HOOK_THRESH.constprop.38+0xc9/0x290 include/linux/netfilter.h:219
 [<ffffffff85084f98>] NF_HOOK include/linux/netfilter.h:242 [inline]
 [<ffffffff85084f98>] mld_sendpack+0x5f8/0xb80 net/ipv6/mcast.c:1646
 [<ffffffff85086900>] mld_send_cr net/ipv6/mcast.c:1927 [inline]
 [<ffffffff85086900>] mld_ifc_timer_expire+0x360/0x710 net/ipv6/mcast.c:2425
 [<ffffffff814a053e>] call_timer_fn+0x14e/0x620 kernel/time/timer.c:1178
 [<ffffffff814a1007>] __run_timers kernel/time/timer.c:1254 [inline]
 [<ffffffff814a1007>] run_timer_softirq+0x5f7/0x9c0 kernel/time/timer.c:1437
 [<ffffffff85b7302c>] __do_softirq+0x2cc/0xa06 kernel/softirq.c:273
 [<ffffffff81355107>] invoke_softirq kernel/softirq.c:350 [inline]
 [<ffffffff81355107>] irq_exit+0x157/0x190 kernel/softirq.c:391
 [<ffffffff85b727bb>] exiting_irq arch/x86/include/asm/apic.h:658 [inline]
 [<ffffffff85b727bb>] smp_apic_timer_interrupt+0x7b/0xa0 arch/x86/kernel/apic/apic.c:932
 [<ffffffff85b70afc>] apic_timer_interrupt+0x8c/0xa0 arch/x86/entry/entry_64.S:621
 <EOI>  [<ffffffff8297b14f>] ? __read_once_size include/linux/compiler.h:222 [inline]
 <EOI>  [<ffffffff8297b14f>] ? avc_search_node security/selinux/avc.c:583 [inline]
 <EOI>  [<ffffffff8297b14f>] ? avc_lookup security/selinux/avc.c:612 [inline]
 <EOI>  [<ffffffff8297b14f>] ? avc_has_perm_noaudit security/selinux/avc.c:1112 [inline]
 <EOI>  [<ffffffff8297b14f>] ? avc_has_perm+0x1bf/0x470 security/selinux/avc.c:1148
 [<ffffffff829899ef>] inode_has_perm.isra.47+0x13f/0x1c0 security/selinux/hooks.c:1689
 [<ffffffff8298ba7b>] dentry_has_perm security/selinux/hooks.c:1705 [inline]
 [<ffffffff8298ba7b>] selinux_inode_readlink+0xdb/0x120 security/selinux/hooks.c:2906
 [<ffffffff829721a1>] security_inode_readlink+0xb1/0xf0 security/security.c:584
 [<ffffffff817a7341>] SYSC_readlinkat fs/stat.c:333 [inline]
 [<ffffffff817a7341>] SyS_readlinkat fs/stat.c:315 [inline]
 [<ffffffff817a7341>] SYSC_readlink fs/stat.c:352 [inline]
 [<ffffffff817a7341>] SyS_readlink+0x141/0x290 fs/stat.c:349
 [<ffffffff85b6fe80>] entry_SYSCALL_64_fastpath+0x23/0xc1
Memory state around the buggy address:
 ffff8801a7fc7400: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8801a7fc7480: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
>ffff8801a7fc7500: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
                   ^
 ffff8801a7fc7580: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8801a7fc7600: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
==================================================================
==================================================================
BUG: KASAN: use-after-free in skb_is_gso include/linux/skbuff.h:3648 [inline] at addr ffff8801a7fc7502
BUG: KASAN: use-after-free in netif_needs_gso include/linux/netdevice.h:4039 [inline] at addr ffff8801a7fc7502
BUG: KASAN: use-after-free in validate_xmit_skb.isra.107.part.108+0x831/0xa20 net/core/dev.c:2926 at addr ffff8801a7fc7502
Read of size 2 by task udevd/7315
page:ffffea00069ff1c0 count:0 mapcount:0 mapping:          (null) index:0x0
flags: 0x57ffe0000000000()
page dumped because: kasan: bad access detected
CPU: 0 PID: 7315 Comm: udevd Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0d9577e ffff88012c007590 ffffffff82c4dd46 ffff8800b5aeacc0
 ffff88012c007620 ffff8801a7fc7502 0000000000000000 ffff88012c007610
 ffffffff817405ba ffff88012c007648 ffffffff8495006e 0000000000000286
Call Trace:
 <IRQ>  [<ffffffff82c4dd46>] __dump_stack lib/dump_stack.c:15 [inline]
 <IRQ>  [<ffffffff82c4dd46>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff817405ba>] print_address_description mm/kasan/report.c:190 [inline]
 [<ffffffff817405ba>] kasan_report_error+0x59a/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174065e>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174065e>] __asan_report_load2_noabort+0x3e/0x40 mm/kasan/report.c:316
 [<ffffffff84950d61>] skb_is_gso include/linux/skbuff.h:3648 [inline]
 [<ffffffff84950d61>] netif_needs_gso include/linux/netdevice.h:4039 [inline]
 [<ffffffff84950d61>] validate_xmit_skb.isra.107.part.108+0x831/0xa20 net/core/dev.c:2926
 [<ffffffff8495407d>] validate_xmit_skb net/core/dev.c:3059 [inline]
 [<ffffffff8495407d>] __dev_queue_xmit+0x1c5d/0x1f40 net/core/dev.c:3350
 [<ffffffff8495436b>] dev_queue_xmit+0xb/0x10 net/core/dev.c:3392
 [<ffffffff849748c8>] neigh_resolve_output+0x488/0x7d0 net/core/neighbour.c:1311
 [<ffffffff84ffaefb>] dst_neigh_output include/net/dst.h:467 [inline]
 [<ffffffff84ffaefb>] ip6_finish_output2+0x98b/0x1b90 net/ipv6/ip6_output.c:113
 [<ffffffff85004813>] ip6_finish_output+0x353/0x700 net/ipv6/ip6_output.c:131
 [<ffffffff85004d27>] NF_HOOK_COND include/linux/netfilter.h:233 [inline]
 [<ffffffff85004d27>] ip6_output+0x167/0x530 net/ipv6/ip6_output.c:145
 [<ffffffff85082c89>] dst_output include/net/dst.h:504 [inline]
 [<ffffffff85082c89>] NF_HOOK_THRESH.constprop.38+0xc9/0x290 include/linux/netfilter.h:219
 [<ffffffff85084f98>] NF_HOOK include/linux/netfilter.h:242 [inline]
 [<ffffffff85084f98>] mld_sendpack+0x5f8/0xb80 net/ipv6/mcast.c:1646
 [<ffffffff85086900>] mld_send_cr net/ipv6/mcast.c:1927 [inline]
 [<ffffffff85086900>] mld_ifc_timer_expire+0x360/0x710 net/ipv6/mcast.c:2425
 [<ffffffff814a053e>] call_timer_fn+0x14e/0x620 kernel/time/timer.c:1178
 [<ffffffff814a1007>] __run_timers kernel/time/timer.c:1254 [inline]
 [<ffffffff814a1007>] run_timer_softirq+0x5f7/0x9c0 kernel/time/timer.c:1437
 [<ffffffff85b7302c>] __do_softirq+0x2cc/0xa06 kernel/softirq.c:273
 [<ffffffff81355107>] invoke_softirq kernel/softirq.c:350 [inline]
 [<ffffffff81355107>] irq_exit+0x157/0x190 kernel/softirq.c:391
 [<ffffffff85b727bb>] exiting_irq arch/x86/include/asm/apic.h:658 [inline]
 [<ffffffff85b727bb>] smp_apic_timer_interrupt+0x7b/0xa0 arch/x86/kernel/apic/apic.c:932
 [<ffffffff85b70afc>] apic_timer_interrupt+0x8c/0xa0 arch/x86/entry/entry_64.S:621
 <EOI>  [<ffffffff8297b14f>] ? __read_once_size include/linux/compiler.h:222 [inline]
 <EOI>  [<ffffffff8297b14f>] ? avc_search_node security/selinux/avc.c:583 [inline]
 <EOI>  [<ffffffff8297b14f>] ? avc_lookup security/selinux/avc.c:612 [inline]
 <EOI>  [<ffffffff8297b14f>] ? avc_has_perm_noaudit security/selinux/avc.c:1112 [inline]
 <EOI>  [<ffffffff8297b14f>] ? avc_has_perm+0x1bf/0x470 security/selinux/avc.c:1148
 [<ffffffff829899ef>] inode_has_perm.isra.47+0x13f/0x1c0 security/selinux/hooks.c:1689
 [<ffffffff8298ba7b>] dentry_has_perm security/selinux/hooks.c:1705 [inline]
 [<ffffffff8298ba7b>] selinux_inode_readlink+0xdb/0x120 security/selinux/hooks.c:2906
 [<ffffffff829721a1>] security_inode_readlink+0xb1/0xf0 security/security.c:584
 [<ffffffff817a7341>] SYSC_readlinkat fs/stat.c:333 [inline]
 [<ffffffff817a7341>] SyS_readlinkat fs/stat.c:315 [inline]
 [<ffffffff817a7341>] SYSC_readlink fs/stat.c:352 [inline]
 [<ffffffff817a7341>] SyS_readlink+0x141/0x290 fs/stat.c:349
 [<ffffffff85b6fe80>] entry_SYSCALL_64_fastpath+0x23/0xc1
Memory state around the buggy address:
 ffff8801a7fc7400: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8801a7fc7480: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
>ffff8801a7fc7500: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
                   ^
 ffff8801a7fc7580: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8801a7fc7600: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
==================================================================
==================================================================
BUG: KASAN: use-after-free in skb_release_data+0x39f/0x470 net/core/skbuff.c:592 at addr ffff8801a7fc7500
Read of size 1 by task udevd/7315
page:ffffea00069ff1c0 count:0 mapcount:0 mapping:          (null) index:0x0
flags: 0x57ffe0000000000()
page dumped because: kasan: bad access detected
CPU: 0 PID: 7315 Comm: udevd Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0d9577e ffff88012c007330 ffffffff82c4dd46 ffff8800b5aeacc0
 ffff88012c0073c0 ffff8801a7fc7500 ffff8800a78ca1c0 ffff88012c0073b0
 ffffffff817405ba 0000000000000000 ffffffff848f05c0 0000000000000286
Call Trace:
 <IRQ>  [<ffffffff82c4dd46>] __dump_stack lib/dump_stack.c:15 [inline]
 <IRQ>  [<ffffffff82c4dd46>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff817405ba>] print_address_description mm/kasan/report.c:190 [inline]
 [<ffffffff817405ba>] kasan_report_error+0x59a/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174061e>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174061e>] __asan_report_load1_noabort+0x3e/0x40 mm/kasan/report.c:315
 [<ffffffff848fffbf>] skb_release_data+0x39f/0x470 net/core/skbuff.c:592
 [<ffffffff849000cd>] skb_release_all+0x3d/0x50 net/core/skbuff.c:669
 [<ffffffff849000ed>] __kfree_skb+0xd/0x20 net/core/skbuff.c:683
 [<ffffffff84900190>] kfree_skb+0x90/0x2f0 net/core/skbuff.c:704
 [<ffffffff8519bcd6>] br_flood+0x236/0x350 net/bridge/br_forward.c:234
 [<ffffffff8519d046>] br_flood_deliver+0x16/0x20 net/bridge/br_forward.c:241
 [<ffffffff85192c70>] br_dev_xmit+0x680/0xbc0 net/bridge/br_device.c:81
 [<ffffffff84951609>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff84951609>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff84951609>] xmit_one net/core/dev.c:2871 [inline]
 [<ffffffff84951609>] dev_hard_start_xmit+0x6b9/0x1140 net/core/dev.c:2887
 [<ffffffff84953fa5>] __dev_queue_xmit+0x1b85/0x1f40 net/core/dev.c:3358
 [<ffffffff8495436b>] dev_queue_xmit+0xb/0x10 net/core/dev.c:3392
 [<ffffffff849748c8>] neigh_resolve_output+0x488/0x7d0 net/core/neighbour.c:1311
 [<ffffffff84ffaefb>] dst_neigh_output include/net/dst.h:467 [inline]
 [<ffffffff84ffaefb>] ip6_finish_output2+0x98b/0x1b90 net/ipv6/ip6_output.c:113
 [<ffffffff85004813>] ip6_finish_output+0x353/0x700 net/ipv6/ip6_output.c:131
 [<ffffffff85004d27>] NF_HOOK_COND include/linux/netfilter.h:233 [inline]
 [<ffffffff85004d27>] ip6_output+0x167/0x530 net/ipv6/ip6_output.c:145
 [<ffffffff85082c89>] dst_output include/net/dst.h:504 [inline]
 [<ffffffff85082c89>] NF_HOOK_THRESH.constprop.38+0xc9/0x290 include/linux/netfilter.h:219
 [<ffffffff85084f98>] NF_HOOK include/linux/netfilter.h:242 [inline]
 [<ffffffff85084f98>] mld_sendpack+0x5f8/0xb80 net/ipv6/mcast.c:1646
 [<ffffffff85086900>] mld_send_cr net/ipv6/mcast.c:1927 [inline]
 [<ffffffff85086900>] mld_ifc_timer_expire+0x360/0x710 net/ipv6/mcast.c:2425
 [<ffffffff814a053e>] call_timer_fn+0x14e/0x620 kernel/time/timer.c:1178
 [<ffffffff814a1007>] __run_timers kernel/time/timer.c:1254 [inline]
 [<ffffffff814a1007>] run_timer_softirq+0x5f7/0x9c0 kernel/time/timer.c:1437
 [<ffffffff85b7302c>] __do_softirq+0x2cc/0xa06 kernel/softirq.c:273
 [<ffffffff81355107>] invoke_softirq kernel/softirq.c:350 [inline]
 [<ffffffff81355107>] irq_exit+0x157/0x190 kernel/softirq.c:391
 [<ffffffff85b727bb>] exiting_irq arch/x86/include/asm/apic.h:658 [inline]
 [<ffffffff85b727bb>] smp_apic_timer_interrupt+0x7b/0xa0 arch/x86/kernel/apic/apic.c:932
 [<ffffffff85b70afc>] apic_timer_interrupt+0x8c/0xa0 arch/x86/entry/entry_64.S:621
 <EOI>  [<ffffffff8297b14f>] ? __read_once_size include/linux/compiler.h:222 [inline]
 <EOI>  [<ffffffff8297b14f>] ? avc_search_node security/selinux/avc.c:583 [inline]
 <EOI>  [<ffffffff8297b14f>] ? avc_lookup security/selinux/avc.c:612 [inline]
 <EOI>  [<ffffffff8297b14f>] ? avc_has_perm_noaudit security/selinux/avc.c:1112 [inline]
 <EOI>  [<ffffffff8297b14f>] ? avc_has_perm+0x1bf/0x470 security/selinux/avc.c:1148
 [<ffffffff829899ef>] inode_has_perm.isra.47+0x13f/0x1c0 security/selinux/hooks.c:1689
 [<ffffffff8298ba7b>] dentry_has_perm security/selinux/hooks.c:1705 [inline]
 [<ffffffff8298ba7b>] selinux_inode_readlink+0xdb/0x120 security/selinux/hooks.c:2906
 [<ffffffff829721a1>] security_inode_readlink+0xb1/0xf0 security/security.c:584
 [<ffffffff817a7341>] SYSC_readlinkat fs/stat.c:333 [inline]
 [<ffffffff817a7341>] SyS_readlinkat fs/stat.c:315 [inline]
 [<ffffffff817a7341>] SYSC_readlink fs/stat.c:352 [inline]
 [<ffffffff817a7341>] SyS_readlink+0x141/0x290 fs/stat.c:349
 [<ffffffff85b6fe80>] entry_SYSCALL_64_fastpath+0x23/0xc1
Memory state around the buggy address:
 ffff8801a7fc7400: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8801a7fc7480: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
>ffff8801a7fc7500: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
                   ^
 ffff8801a7fc7580: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8801a7fc7600: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
==================================================================
==================================================================
BUG: KASAN: use-after-free in skb_release_data+0x3f0/0x470 net/core/skbuff.c:599 at addr ffff8801a7fc7501
Read of size 1 by task udevd/7315
page:ffffea00069ff1c0 count:0 mapcount:0 mapping:          (null) index:0x0
flags: 0x57ffe0000000000()
page dumped because: kasan: bad access detected
CPU: 0 PID: 7315 Comm: udevd Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0d9577e ffff88012c007330 ffffffff82c4dd46 ffff8800b5aeacc0
 ffff88012c0073c0 ffff8801a7fc7501 ffffed0034ff8ea0 ffff88012c0073b0
 ffffffff817405ba 0000000000000010 ffffffff00000000 0000000000000286
Call Trace:
 <IRQ>  [<ffffffff82c4dd46>] __dump_stack lib/dump_stack.c:15 [inline]
 <IRQ>  [<ffffffff82c4dd46>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff817405ba>] print_address_description mm/kasan/report.c:190 [inline]
 [<ffffffff817405ba>] kasan_report_error+0x59a/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174061e>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174061e>] __asan_report_load1_noabort+0x3e/0x40 mm/kasan/report.c:315
 [<ffffffff84900010>] skb_release_data+0x3f0/0x470 net/core/skbuff.c:599
 [<ffffffff849000cd>] skb_release_all+0x3d/0x50 net/core/skbuff.c:669
 [<ffffffff849000ed>] __kfree_skb+0xd/0x20 net/core/skbuff.c:683
 [<ffffffff84900190>] kfree_skb+0x90/0x2f0 net/core/skbuff.c:704
 [<ffffffff8519bcd6>] br_flood+0x236/0x350 net/bridge/br_forward.c:234
 [<ffffffff8519d046>] br_flood_deliver+0x16/0x20 net/bridge/br_forward.c:241
 [<ffffffff85192c70>] br_dev_xmit+0x680/0xbc0 net/bridge/br_device.c:81
 [<ffffffff84951609>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff84951609>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff84951609>] xmit_one net/core/dev.c:2871 [inline]
 [<ffffffff84951609>] dev_hard_start_xmit+0x6b9/0x1140 net/core/dev.c:2887
 [<ffffffff84953fa5>] __dev_queue_xmit+0x1b85/0x1f40 net/core/dev.c:3358
 [<ffffffff8495436b>] dev_queue_xmit+0xb/0x10 net/core/dev.c:3392
 [<ffffffff849748c8>] neigh_resolve_output+0x488/0x7d0 net/core/neighbour.c:1311
 [<ffffffff84ffaefb>] dst_neigh_output include/net/dst.h:467 [inline]
 [<ffffffff84ffaefb>] ip6_finish_output2+0x98b/0x1b90 net/ipv6/ip6_output.c:113
 [<ffffffff85004813>] ip6_finish_output+0x353/0x700 net/ipv6/ip6_output.c:131
 [<ffffffff85004d27>] NF_HOOK_COND include/linux/netfilter.h:233 [inline]
 [<ffffffff85004d27>] ip6_output+0x167/0x530 net/ipv6/ip6_output.c:145
 [<ffffffff85082c89>] dst_output include/net/dst.h:504 [inline]
 [<ffffffff85082c89>] NF_HOOK_THRESH.constprop.38+0xc9/0x290 include/linux/netfilter.h:219
 [<ffffffff85084f98>] NF_HOOK include/linux/netfilter.h:242 [inline]
 [<ffffffff85084f98>] mld_sendpack+0x5f8/0xb80 net/ipv6/mcast.c:1646
 [<ffffffff85086900>] mld_send_cr net/ipv6/mcast.c:1927 [inline]
 [<ffffffff85086900>] mld_ifc_timer_expire+0x360/0x710 net/ipv6/mcast.c:2425
 [<ffffffff814a053e>] call_timer_fn+0x14e/0x620 kernel/time/timer.c:1178
 [<ffffffff814a1007>] __run_timers kernel/time/timer.c:1254 [inline]
 [<ffffffff814a1007>] run_timer_softirq+0x5f7/0x9c0 kernel/time/timer.c:1437
 [<ffffffff85b7302c>] __do_softirq+0x2cc/0xa06 kernel/softirq.c:273
 [<ffffffff81355107>] invoke_softirq kernel/softirq.c:350 [inline]
 [<ffffffff81355107>] irq_exit+0x157/0x190 kernel/softirq.c:391
 [<ffffffff85b727bb>] exiting_irq arch/x86/include/asm/apic.h:658 [inline]
 [<ffffffff85b727bb>] smp_apic_timer_interrupt+0x7b/0xa0 arch/x86/kernel/apic/apic.c:932
 [<ffffffff85b70afc>] apic_timer_interrupt+0x8c/0xa0 arch/x86/entry/entry_64.S:621
 <EOI>  [<ffffffff8297b14f>] ? __read_once_size include/linux/compiler.h:222 [inline]
 <EOI>  [<ffffffff8297b14f>] ? avc_search_node security/selinux/avc.c:583 [inline]
 <EOI>  [<ffffffff8297b14f>] ? avc_lookup security/selinux/avc.c:612 [inline]
 <EOI>  [<ffffffff8297b14f>] ? avc_has_perm_noaudit security/selinux/avc.c:1112 [inline]
 <EOI>  [<ffffffff8297b14f>] ? avc_has_perm+0x1bf/0x470 security/selinux/avc.c:1148
 [<ffffffff829899ef>] inode_has_perm.isra.47+0x13f/0x1c0 security/selinux/hooks.c:1689
 [<ffffffff8298ba7b>] dentry_has_perm security/selinux/hooks.c:1705 [inline]
 [<ffffffff8298ba7b>] selinux_inode_readlink+0xdb/0x120 security/selinux/hooks.c:2906
 [<ffffffff829721a1>] security_inode_readlink+0xb1/0xf0 security/security.c:584
 [<ffffffff817a7341>] SYSC_readlinkat fs/stat.c:333 [inline]
 [<ffffffff817a7341>] SyS_readlinkat fs/stat.c:315 [inline]
 [<ffffffff817a7341>] SYSC_readlink fs/stat.c:352 [inline]
 [<ffffffff817a7341>] SyS_readlink+0x141/0x290 fs/stat.c:349
 [<ffffffff85b6fe80>] entry_SYSCALL_64_fastpath+0x23/0xc1
Memory state around the buggy address:
 ffff8801a7fc7400: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8801a7fc7480: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
>ffff8801a7fc7500: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
                   ^
 ffff8801a7fc7580: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8801a7fc7600: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
==================================================================
==================================================================
BUG: KASAN: use-after-free in skb_release_data+0x3b6/0x470 net/core/skbuff.c:607 at addr ffff8801a7fc7508
Read of size 8 by task udevd/7315
page:ffffea00069ff1c0 count:0 mapcount:0 mapping:          (null) index:0x0
flags: 0x57ffe0000000000()
page dumped because: kasan: bad access detected
CPU: 0 PID: 7315 Comm: udevd Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0d9577e ffff88012c007330 ffffffff82c4dd46 ffff8800b5aeacc0
 ffff88012c0073c0 ffff8801a7fc7508 ffffed0034ff8ea0 ffff88012c0073b0
 ffffffff817405ba 0000000000000010 ffffffff00000000 0000000000000286
Call Trace:
 <IRQ>  [<ffffffff82c4dd46>] __dump_stack lib/dump_stack.c:15 [inline]
 <IRQ>  [<ffffffff82c4dd46>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff817405ba>] print_address_description mm/kasan/report.c:190 [inline]
 [<ffffffff817405ba>] kasan_report_error+0x59a/0x5c0 mm/kasan/report.c:275
 [<ffffffff817406de>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff817406de>] __asan_report_load8_noabort+0x3e/0x40 mm/kasan/report.c:318
 [<ffffffff848fffd6>] skb_release_data+0x3b6/0x470 net/core/skbuff.c:607
 [<ffffffff849000cd>] skb_release_all+0x3d/0x50 net/core/skbuff.c:669
 [<ffffffff849000ed>] __kfree_skb+0xd/0x20 net/core/skbuff.c:683
 [<ffffffff84900190>] kfree_skb+0x90/0x2f0 net/core/skbuff.c:704
 [<ffffffff8519bcd6>] br_flood+0x236/0x350 net/bridge/br_forward.c:234
 [<ffffffff8519d046>] br_flood_deliver+0x16/0x20 net/bridge/br_forward.c:241
 [<ffffffff85192c70>] br_dev_xmit+0x680/0xbc0 net/bridge/br_device.c:81
 [<ffffffff84951609>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff84951609>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff84951609>] xmit_one net/core/dev.c:2871 [inline]
 [<ffffffff84951609>] dev_hard_start_xmit+0x6b9/0x1140 net/core/dev.c:2887
 [<ffffffff84953fa5>] __dev_queue_xmit+0x1b85/0x1f40 net/core/dev.c:3358
 [<ffffffff8495436b>] dev_queue_xmit+0xb/0x10 net/core/dev.c:3392
 [<ffffffff849748c8>] neigh_resolve_output+0x488/0x7d0 net/core/neighbour.c:1311
 [<ffffffff84ffaefb>] dst_neigh_output include/net/dst.h:467 [inline]
 [<ffffffff84ffaefb>] ip6_finish_output2+0x98b/0x1b90 net/ipv6/ip6_output.c:113
 [<ffffffff85004813>] ip6_finish_output+0x353/0x700 net/ipv6/ip6_output.c:131
 [<ffffffff85004d27>] NF_HOOK_COND include/linux/netfilter.h:233 [inline]
 [<ffffffff85004d27>] ip6_output+0x167/0x530 net/ipv6/ip6_output.c:145
 [<ffffffff85082c89>] dst_output include/net/dst.h:504 [inline]
 [<ffffffff85082c89>] NF_HOOK_THRESH.constprop.38+0xc9/0x290 include/linux/netfilter.h:219
 [<ffffffff85084f98>] NF_HOOK include/linux/netfilter.h:242 [inline]
 [<ffffffff85084f98>] mld_sendpack+0x5f8/0xb80 net/ipv6/mcast.c:1646
 [<ffffffff85086900>] mld_send_cr net/ipv6/mcast.c:1927 [inline]
 [<ffffffff85086900>] mld_ifc_timer_expire+0x360/0x710 net/ipv6/mcast.c:2425
 [<ffffffff814a053e>] call_timer_fn+0x14e/0x620 kernel/time/timer.c:1178
 [<ffffffff814a1007>] __run_timers kernel/time/timer.c:1254 [inline]
 [<ffffffff814a1007>] run_timer_softirq+0x5f7/0x9c0 kernel/time/timer.c:1437
 [<ffffffff85b7302c>] __do_softirq+0x2cc/0xa06 kernel/softirq.c:273
 [<ffffffff81355107>] invoke_softirq kernel/softirq.c:350 [inline]
 [<ffffffff81355107>] irq_exit+0x157/0x190 kernel/softirq.c:391
 [<ffffffff85b727bb>] exiting_irq arch/x86/include/asm/apic.h:658 [inline]
 [<ffffffff85b727bb>] smp_apic_timer_interrupt+0x7b/0xa0 arch/x86/kernel/apic/apic.c:932
 [<ffffffff85b70afc>] apic_timer_interrupt+0x8c/0xa0 arch/x86/entry/entry_64.S:621
 <EOI>  [<ffffffff8297b14f>] ? __read_once_size include/linux/compiler.h:222 [inline]
 <EOI>  [<ffffffff8297b14f>] ? avc_search_node security/selinux/avc.c:583 [inline]
 <EOI>  [<ffffffff8297b14f>] ? avc_lookup security/selinux/avc.c:612 [inline]
 <EOI>  [<ffffffff8297b14f>] ? avc_has_perm_noaudit security/selinux/avc.c:1112 [inline]
 <EOI>  [<ffffffff8297b14f>] ? avc_has_perm+0x1bf/0x470 security/selinux/avc.c:1148
 [<ffffffff829899ef>] inode_has_perm.isra.47+0x13f/0x1c0 security/selinux/hooks.c:1689
 [<ffffffff8298ba7b>] dentry_has_perm security/selinux/hooks.c:1705 [inline]
 [<ffffffff8298ba7b>] selinux_inode_readlink+0xdb/0x120 security/selinux/hooks.c:2906
 [<ffffffff829721a1>] security_inode_readlink+0xb1/0xf0 security/security.c:584
 [<ffffffff817a7341>] SYSC_readlinkat fs/stat.c:333 [inline]
 [<ffffffff817a7341>] SyS_readlinkat fs/stat.c:315 [inline]
 [<ffffffff817a7341>] SYSC_readlink fs/stat.c:352 [inline]
 [<ffffffff817a7341>] SyS_readlink+0x141/0x290 fs/stat.c:349
 [<ffffffff85b6fe80>] entry_SYSCALL_64_fastpath+0x23/0xc1
Memory state around the buggy address:
 ffff8801a7fc7400: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8801a7fc7480: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
>ffff8801a7fc7500: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
                      ^
 ffff8801a7fc7580: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8801a7fc7600: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
==================================================================
netlink: 2 bytes leftover after parsing attributes in process `syz-executor.1'.
==================================================================
BUG: KASAN: use-after-free in memset+0x1a/0x30 mm/kasan/kasan.c:301 at addr ffff8801a785f180
Write of size 32 by task modprobe/7753
page:ffffea00069e17c0 count:0 mapcount:0 mapping:          (null) index:0x0
flags: 0x57ffe0000000000()
page dumped because: kasan: bad access detected
CPU: 0 PID: 7753 Comm: modprobe Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0d9577e ffff88012c0076d8 ffffffff82c4dd46 ffff8801a785f180
 ffff88012c007768 ffff8801a785f180 ffff88012c007850 ffff88012c007758
 ffffffff817405ba ffff8800aff43ba7
 1ffff10015fe8775 0000000000000286
Call Trace:
 <IRQ>  [<ffffffff82c4dd46>] __dump_stack lib/dump_stack.c:15 [inline]
 <IRQ>  [<ffffffff82c4dd46>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff817405ba>] print_address_description mm/kasan/report.c:190 [inline]
 [<ffffffff817405ba>] kasan_report_error+0x59a/0x5c0 mm/kasan/report.c:275
 [<ffffffff81740914>] kasan_report+0x34/0x40 mm/kasan/report.c:297
 [<ffffffff8173f34d>] check_memory_region mm/kasan/kasan.c:285 [inline]
 [<ffffffff8173f34d>] __asan_storeN+0x12d/0x180 mm/kasan/kasan.c:688
 [<ffffffff8173f81a>] memset+0x1a/0x30 mm/kasan/kasan.c:301
 [<ffffffff848fb78a>] __alloc_skb+0x31a/0x5b0 net/core/skbuff.c:259
 [<ffffffff8490099d>] alloc_skb include/linux/skbuff.h:895 [inline]
 [<ffffffff8490099d>] alloc_skb_with_frags+0x8d/0x4b0 net/core/skbuff.c:4557
 [<ffffffff848ec559>] sock_alloc_send_pskb+0x5c9/0x740 net/core/sock.c:1851
 [<ffffffff848ec6e3>] sock_alloc_send_skb+0x13/0x20 net/core/sock.c:1868
 [<ffffffff85080a8b>] mld_newpack+0x1bb/0x930 net/ipv6/mcast.c:1571
 [<ffffffff850814ba>] add_grhead.isra.29+0x2ba/0x3a0 net/ipv6/mcast.c:1678
 [<ffffffff85085d7c>] add_grec+0x85c/0xcb0 net/ipv6/mcast.c:1793
 [<ffffffff8508689b>] mld_send_cr net/ipv6/mcast.c:1919 [inline]
 [<ffffffff8508689b>] mld_ifc_timer_expire+0x2fb/0x710 net/ipv6/mcast.c:2425
 [<ffffffff814a053e>] call_timer_fn+0x14e/0x620 kernel/time/timer.c:1178
 [<ffffffff814a1007>] __run_timers kernel/time/timer.c:1254 [inline]
 [<ffffffff814a1007>] run_timer_softirq+0x5f7/0x9c0 kernel/time/timer.c:1437
 [<ffffffff85b7302c>] __do_softirq+0x2cc/0xa06 kernel/softirq.c:273
 [<ffffffff81355107>] invoke_softirq kernel/softirq.c:350 [inline]
 [<ffffffff81355107>] irq_exit+0x157/0x190 kernel/softirq.c:391
 [<ffffffff85b727bb>] exiting_irq arch/x86/include/asm/apic.h:658 [inline]
 [<ffffffff85b727bb>] smp_apic_timer_interrupt+0x7b/0xa0 arch/x86/kernel/apic/apic.c:932
 [<ffffffff85b70afc>] apic_timer_interrupt+0x8c/0xa0 arch/x86/entry/entry_64.S:621
 <EOI>  [<ffffffff81739f74>] ? arch_local_irq_restore arch/x86/include/asm/paravirt.h:791 [inline]
 <EOI>  [<ffffffff81739f74>] ? kfree+0x154/0x460 mm/slab.c:3641
 [<ffffffff817a8b6a>] free_bprm+0x17a/0x1e0 fs/exec.c:1299
 [<ffffffff817aeeee>] do_execveat_common.isra.42+0x138e/0x1d60 fs/exec.c:1695
 [<ffffffff817af8e7>] do_execve+0x27/0x30 fs/exec.c:1730
 [<ffffffff81384067>] call_usermodehelper_exec_async+0x287/0x420 kernel/kmod.c:252
 [<ffffffff85b700d2>] ret_from_fork+0x22/0x50 arch/x86/entry/entry_64.S:392
Memory state around the buggy address:
 ffff8801a785f080: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8801a785f100: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
>ffff8801a785f180: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
                   ^
 ffff8801a785f200: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8801a785f280: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
==================================================================
==================================================================
BUG: KASAN: use-after-free in __write_once_size include/linux/compiler.h:250 [inline] at addr ffff8801a785f1a0
BUG: KASAN: use-after-free in atomic_set arch/x86/include/asm/atomic.h:38 [inline] at addr ffff8801a785f1a0
BUG: KASAN: use-after-free in __alloc_skb+0x4bb/0x5b0 net/core/skbuff.c:260 at addr ffff8801a785f1a0
Write of size 4 by task modprobe/7753
page:ffffea00069e17c0 count:0 mapcount:0 mapping:          (null) index:0x0
flags: 0x57ffe0000000000()
page dumped because: kasan: bad access detected
CPU: 0 PID: 7753 Comm: modprobe Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0d9577e ffff88012c007710 ffffffff82c4dd46 0000000000000000
 ffff88012c0077a0 ffff8801a785f1a0 ffff88012c007850 ffff88012c007790
 ffffffff817405ba 3837613130383866 00203a3038326635 0000000000000286
Call Trace:
 <IRQ>  [<ffffffff82c4dd46>] __dump_stack lib/dump_stack.c:15 [inline]
 <IRQ>  [<ffffffff82c4dd46>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff817405ba>] print_address_description mm/kasan/report.c:190 [inline]
 [<ffffffff817405ba>] kasan_report_error+0x59a/0x5c0 mm/kasan/report.c:275
 [<ffffffff817407de>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff817407de>] __asan_report_store4_noabort+0x3e/0x40 mm/kasan/report.c:322
 [<ffffffff848fb92b>] __write_once_size include/linux/compiler.h:250 [inline]
 [<ffffffff848fb92b>] atomic_set arch/x86/include/asm/atomic.h:38 [inline]
 [<ffffffff848fb92b>] __alloc_skb+0x4bb/0x5b0 net/core/skbuff.c:260
 [<ffffffff8490099d>] alloc_skb include/linux/skbuff.h:895 [inline]
 [<ffffffff8490099d>] alloc_skb_with_frags+0x8d/0x4b0 net/core/skbuff.c:4557
 [<ffffffff848ec559>] sock_alloc_send_pskb+0x5c9/0x740 net/core/sock.c:1851
 [<ffffffff848ec6e3>] sock_alloc_send_skb+0x13/0x20 net/core/sock.c:1868
 [<ffffffff85080a8b>] mld_newpack+0x1bb/0x930 net/ipv6/mcast.c:1571
 [<ffffffff850814ba>] add_grhead.isra.29+0x2ba/0x3a0 net/ipv6/mcast.c:1678
 [<ffffffff85085d7c>] add_grec+0x85c/0xcb0 net/ipv6/mcast.c:1793
 [<ffffffff8508689b>] mld_send_cr net/ipv6/mcast.c:1919 [inline]
 [<ffffffff8508689b>] mld_ifc_timer_expire+0x2fb/0x710 net/ipv6/mcast.c:2425
 [<ffffffff814a053e>] call_timer_fn+0x14e/0x620 kernel/time/timer.c:1178
 [<ffffffff814a1007>] __run_timers kernel/time/timer.c:1254 [inline]
 [<ffffffff814a1007>] run_timer_softirq+0x5f7/0x9c0 kernel/time/timer.c:1437
 [<ffffffff85b7302c>] __do_softirq+0x2cc/0xa06 kernel/softirq.c:273
 [<ffffffff81355107>] invoke_softirq kernel/softirq.c:350 [inline]
 [<ffffffff81355107>] irq_exit+0x157/0x190 kernel/softirq.c:391
 [<ffffffff85b727bb>] exiting_irq arch/x86/include/asm/apic.h:658 [inline]
 [<ffffffff85b727bb>] smp_apic_timer_interrupt+0x7b/0xa0 arch/x86/kernel/apic/apic.c:932
 [<ffffffff85b70afc>] apic_timer_interrupt+0x8c/0xa0 arch/x86/entry/entry_64.S:621
 <EOI>  [<ffffffff81739f74>] ? arch_local_irq_restore arch/x86/include/asm/paravirt.h:791 [inline]
 <EOI>  [<ffffffff81739f74>] ? kfree+0x154/0x460 mm/slab.c:3641
 [<ffffffff817a8b6a>] free_bprm+0x17a/0x1e0 fs/exec.c:1299
 [<ffffffff817aeeee>] do_execveat_common.isra.42+0x138e/0x1d60 fs/exec.c:1695
 [<ffffffff817af8e7>] do_execve+0x27/0x30 fs/exec.c:1730
 [<ffffffff81384067>] call_usermodehelper_exec_async+0x287/0x420 kernel/kmod.c:252
 [<ffffffff85b700d2>] ret_from_fork+0x22/0x50 arch/x86/entry/entry_64.S:392
Memory state around the buggy address:
 ffff8801a785f080: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8801a785f100: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
>ffff8801a785f180: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
                               ^
 ffff8801a785f200: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8801a785f280: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
==================================================================
==================================================================
BUG: KASAN: use-after-free in __dev_queue_xmit+0x1828/0x1f40 net/core/dev.c:3282 at addr ffff8801a785f181
Read of size 1 by task modprobe/7753
page:ffffea00069e17c0 count:0 mapcount:0 mapping:          (null) index:0x0
flags: 0x57ffe0000000000()
page dumped because: kasan: bad access detected
CPU: 0 PID: 7753 Comm: modprobe Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0d9577e ffff88012c0075e8 ffffffff82c4dd46 ffff8800aff43b86
 ffff88012c007678 ffff8801a785f181 ffff8800aff43ae0 ffff88012c007668
 ffffffff817405ba ffffffff00000000 1ffff10025800ec2 0000000000000286
Call Trace:
 <IRQ>  [<ffffffff82c4dd46>] __dump_stack lib/dump_stack.c:15 [inline]
 <IRQ>  [<ffffffff82c4dd46>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff817405ba>] print_address_description mm/kasan/report.c:190 [inline]
 [<ffffffff817405ba>] kasan_report_error+0x59a/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174061e>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174061e>] __asan_report_load1_noabort+0x3e/0x40 mm/kasan/report.c:315
 [<ffffffff84953c48>] __dev_queue_xmit+0x1828/0x1f40 net/core/dev.c:3282
 [<ffffffff8495436b>] dev_queue_xmit+0xb/0x10 net/core/dev.c:3392
 [<ffffffff849748c8>] neigh_resolve_output+0x488/0x7d0 net/core/neighbour.c:1311
 [<ffffffff84ffaefb>] dst_neigh_output include/net/dst.h:467 [inline]
 [<ffffffff84ffaefb>] ip6_finish_output2+0x98b/0x1b90 net/ipv6/ip6_output.c:113
 [<ffffffff85004813>] ip6_finish_output+0x353/0x700 net/ipv6/ip6_output.c:131
 [<ffffffff85004d27>] NF_HOOK_COND include/linux/netfilter.h:233 [inline]
 [<ffffffff85004d27>] ip6_output+0x167/0x530 net/ipv6/ip6_output.c:145
 [<ffffffff85082c89>] dst_output include/net/dst.h:504 [inline]
 [<ffffffff85082c89>] NF_HOOK_THRESH.constprop.38+0xc9/0x290 include/linux/netfilter.h:219
 [<ffffffff85084f98>] NF_HOOK include/linux/netfilter.h:242 [inline]
 [<ffffffff85084f98>] mld_sendpack+0x5f8/0xb80 net/ipv6/mcast.c:1646
 [<ffffffff85086900>] mld_send_cr net/ipv6/mcast.c:1927 [inline]
 [<ffffffff85086900>] mld_ifc_timer_expire+0x360/0x710 net/ipv6/mcast.c:2425
 [<ffffffff814a053e>] call_timer_fn+0x14e/0x620 kernel/time/timer.c:1178
 [<ffffffff814a1007>] __run_timers kernel/time/timer.c:1254 [inline]
 [<ffffffff814a1007>] run_timer_softirq+0x5f7/0x9c0 kernel/time/timer.c:1437
 [<ffffffff85b7302c>] __do_softirq+0x2cc/0xa06 kernel/softirq.c:273
 [<ffffffff81355107>] invoke_softirq kernel/softirq.c:350 [inline]
 [<ffffffff81355107>] irq_exit+0x157/0x190 kernel/softirq.c:391
 [<ffffffff85b727bb>] exiting_irq arch/x86/include/asm/apic.h:658 [inline]
 [<ffffffff85b727bb>] smp_apic_timer_interrupt+0x7b/0xa0 arch/x86/kernel/apic/apic.c:932
 [<ffffffff85b70afc>] apic_timer_interrupt+0x8c/0xa0 arch/x86/entry/entry_64.S:621
 <EOI>  [<ffffffff81739f74>] ? arch_local_irq_restore arch/x86/include/asm/paravirt.h:791 [inline]
 <EOI>  [<ffffffff81739f74>] ? kfree+0x154/0x460 mm/slab.c:3641
 [<ffffffff817a8b6a>] free_bprm+0x17a/0x1e0 fs/exec.c:1299
 [<ffffffff817aeeee>] do_execveat_common.isra.42+0x138e/0x1d60 fs/exec.c:1695
 [<ffffffff817af8e7>] do_execve+0x27/0x30 fs/exec.c:1730
 [<ffffffff81384067>] call_usermodehelper_exec_async+0x287/0x420 kernel/kmod.c:252
 [<ffffffff85b700d2>] ret_from_fork+0x22/0x50 arch/x86/entry/entry_64.S:392
Memory state around the buggy address:
 ffff8801a785f080: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8801a785f100: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
>ffff8801a785f180: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
                   ^
 ffff8801a785f200: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8801a785f280: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
==================================================================
==================================================================
BUG: KASAN: use-after-free in qdisc_pkt_len_init net/core/dev.c:3002 [inline] at addr ffff8801a785f182
BUG: KASAN: use-after-free in __dev_queue_xmit+0x17db/0x1f40 net/core/dev.c:3292 at addr ffff8801a785f182
Read of size 2 by task modprobe/7753
page:ffffea00069e17c0 count:0 mapcount:0 mapping:          (null) index:0x0
flags: 0x57ffe0000000000()
page dumped because: kasan: bad access detected
CPU: 0 PID: 7753 Comm: modprobe Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0d9577e ffff88012c0075e8 ffffffff82c4dd46 ffff8800aff43b86
 ffff88012c007678 ffff8801a785f182 ffff8801a785f180 ffff88012c007668
 ffffffff817405ba 0000000000000010 ffff8800a740e480 0000000000000286
Call Trace:
 <IRQ>  [<ffffffff82c4dd46>] __dump_stack lib/dump_stack.c:15 [inline]
 <IRQ>  [<ffffffff82c4dd46>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff817405ba>] print_address_description mm/kasan/report.c:190 [inline]
 [<ffffffff817405ba>] kasan_report_error+0x59a/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174065e>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174065e>] __asan_report_load2_noabort+0x3e/0x40 mm/kasan/report.c:316
 [<ffffffff84953bfb>] qdisc_pkt_len_init net/core/dev.c:3002 [inline]
 [<ffffffff84953bfb>] __dev_queue_xmit+0x17db/0x1f40 net/core/dev.c:3292
 [<ffffffff8495436b>] dev_queue_xmit+0xb/0x10 net/core/dev.c:3392
 [<ffffffff849748c8>] neigh_resolve_output+0x488/0x7d0 net/core/neighbour.c:1311
 [<ffffffff84ffaefb>] dst_neigh_output include/net/dst.h:467 [inline]
 [<ffffffff84ffaefb>] ip6_finish_output2+0x98b/0x1b90 net/ipv6/ip6_output.c:113
 [<ffffffff85004813>] ip6_finish_output+0x353/0x700 net/ipv6/ip6_output.c:131
 [<ffffffff85004d27>] NF_HOOK_COND include/linux/netfilter.h:233 [inline]
 [<ffffffff85004d27>] ip6_output+0x167/0x530 net/ipv6/ip6_output.c:145
 [<ffffffff85082c89>] dst_output include/net/dst.h:504 [inline]
 [<ffffffff85082c89>] NF_HOOK_THRESH.constprop.38+0xc9/0x290 include/linux/netfilter.h:219
 [<ffffffff85084f98>] NF_HOOK include/linux/netfilter.h:242 [inline]
 [<ffffffff85084f98>] mld_sendpack+0x5f8/0xb80 net/ipv6/mcast.c:1646
 [<ffffffff85086900>] mld_send_cr net/ipv6/mcast.c:1927 [inline]
 [<ffffffff85086900>] mld_ifc_timer_expire+0x360/0x710 net/ipv6/mcast.c:2425
 [<ffffffff814a053e>] call_timer_fn+0x14e/0x620 kernel/time/timer.c:1178
 [<ffffffff814a1007>] __run_timers kernel/time/timer.c:1254 [inline]
 [<ffffffff814a1007>] run_timer_softirq+0x5f7/0x9c0 kernel/time/timer.c:1437
 [<ffffffff85b7302c>] __do_softirq+0x2cc/0xa06 kernel/softirq.c:273
 [<ffffffff81355107>] invoke_softirq kernel/softirq.c:350 [inline]
 [<ffffffff81355107>] irq_exit+0x157/0x190 kernel/softirq.c:391
 [<ffffffff85b727bb>] exiting_irq arch/x86/include/asm/apic.h:658 [inline]
 [<ffffffff85b727bb>] smp_apic_timer_interrupt+0x7b/0xa0 arch/x86/kernel/apic/apic.c:932
 [<ffffffff85b70afc>] apic_timer_interrupt+0x8c/0xa0 arch/x86/entry/entry_64.S:621
 <EOI>  [<ffffffff81739f74>] ? arch_local_irq_restore arch/x86/include/asm/paravirt.h:791 [inline]
 <EOI>  [<ffffffff81739f74>] ? kfree+0x154/0x460 mm/slab.c:3641
 [<ffffffff817a8b6a>] free_bprm+0x17a/0x1e0 fs/exec.c:1299
 [<ffffffff817aeeee>] do_execveat_common.isra.42+0x138e/0x1d60 fs/exec.c:1695
 [<ffffffff817af8e7>] do_execve+0x27/0x30 fs/exec.c:1730
 [<ffffffff81384067>] call_usermodehelper_exec_async+0x287/0x420 kernel/kmod.c:252
 [<ffffffff85b700d2>] ret_from_fork+0x22/0x50 arch/x86/entry/entry_64.S:392
Memory state around the buggy address:
 ffff8801a785f080: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8801a785f100: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
>ffff8801a785f180: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
                   ^
 ffff8801a785f200: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8801a785f280: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
==================================================================
==================================================================
BUG: KASAN: use-after-free in netif_skb_features+0x601/0x7d0 net/core/dev.c:2832 at addr ffff8801a785f184
Read of size 2 by task modprobe/7753
page:ffffea00069e17c0 count:0 mapcount:0 mapping:          (null) index:0x0
flags: 0x57ffe0000000000()
page dumped because: kasan: bad access detected
CPU: 0 PID: 7753 Comm: modprobe Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0d9577e ffff88012c0074e8 ffffffff82c4dd46 ffff8800aff43ac0
 ffff88012c007578 ffff8801a785f184 ffff8800aff43ae0 ffff88012c007568
 ffffffff817405ba 1ffffffff0eca2ec 0000000000000000 0000000000000286
Call Trace:
 <IRQ>  [<ffffffff82c4dd46>] __dump_stack lib/dump_stack.c:15 [inline]
 <IRQ>  [<ffffffff82c4dd46>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff817405ba>] print_address_description mm/kasan/report.c:190 [inline]
 [<ffffffff817405ba>] kasan_report_error+0x59a/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174065e>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174065e>] __asan_report_load2_noabort+0x3e/0x40 mm/kasan/report.c:316
 [<ffffffff84950361>] netif_skb_features+0x601/0x7d0 net/core/dev.c:2832
 [<ffffffff84950550>] validate_xmit_skb.isra.107.part.108+0x20/0xa20 net/core/dev.c:2921
 [<ffffffff8495407d>] validate_xmit_skb net/core/dev.c:3059 [inline]
 [<ffffffff8495407d>] __dev_queue_xmit+0x1c5d/0x1f40 net/core/dev.c:3350
 [<ffffffff8495436b>] dev_queue_xmit+0xb/0x10 net/core/dev.c:3392
 [<ffffffff849748c8>] neigh_resolve_output+0x488/0x7d0 net/core/neighbour.c:1311
 [<ffffffff84ffaefb>] dst_neigh_output include/net/dst.h:467 [inline]
 [<ffffffff84ffaefb>] ip6_finish_output2+0x98b/0x1b90 net/ipv6/ip6_output.c:113
 [<ffffffff85004813>] ip6_finish_output+0x353/0x700 net/ipv6/ip6_output.c:131
 [<ffffffff85004d27>] NF_HOOK_COND include/linux/netfilter.h:233 [inline]
 [<ffffffff85004d27>] ip6_output+0x167/0x530 net/ipv6/ip6_output.c:145
 [<ffffffff85082c89>] dst_output include/net/dst.h:504 [inline]
 [<ffffffff85082c89>] NF_HOOK_THRESH.constprop.38+0xc9/0x290 include/linux/netfilter.h:219
 [<ffffffff85084f98>] NF_HOOK include/linux/netfilter.h:242 [inline]
 [<ffffffff85084f98>] mld_sendpack+0x5f8/0xb80 net/ipv6/mcast.c:1646
 [<ffffffff85086900>] mld_send_cr net/ipv6/mcast.c:1927 [inline]
 [<ffffffff85086900>] mld_ifc_timer_expire+0x360/0x710 net/ipv6/mcast.c:2425
 [<ffffffff814a053e>] call_timer_fn+0x14e/0x620 kernel/time/timer.c:1178
 [<ffffffff814a1007>] __run_timers kernel/time/timer.c:1254 [inline]
 [<ffffffff814a1007>] run_timer_softirq+0x5f7/0x9c0 kernel/time/timer.c:1437
 [<ffffffff85b7302c>] __do_softirq+0x2cc/0xa06 kernel/softirq.c:273
 [<ffffffff81355107>] invoke_softirq kernel/softirq.c:350 [inline]
 [<ffffffff81355107>] irq_exit+0x157/0x190 kernel/softirq.c:391
 [<ffffffff85b727bb>] exiting_irq arch/x86/include/asm/apic.h:658 [inline]
 [<ffffffff85b727bb>] smp_apic_timer_interrupt+0x7b/0xa0 arch/x86/kernel/apic/apic.c:932
 [<ffffffff85b70afc>] apic_timer_interrupt+0x8c/0xa0 arch/x86/entry/entry_64.S:621
 <EOI>  [<ffffffff81739f74>] ? arch_local_irq_restore arch/x86/include/asm/paravirt.h:791 [inline]
 <EOI>  [<ffffffff81739f74>] ? kfree+0x154/0x460 mm/slab.c:3641
 [<ffffffff817a8b6a>] free_bprm+0x17a/0x1e0 fs/exec.c:1299
 [<ffffffff817aeeee>] do_execveat_common.isra.42+0x138e/0x1d60 fs/exec.c:1695
 [<ffffffff817af8e7>] do_execve+0x27/0x30 fs/exec.c:1730
 [<ffffffff81384067>] call_usermodehelper_exec_async+0x287/0x420 kernel/kmod.c:252
 [<ffffffff85b700d2>] ret_from_fork+0x22/0x50 arch/x86/entry/entry_64.S:392
Memory state around the buggy address:
 ffff8801a785f080: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8801a785f100: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
>ffff8801a785f180: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
                   ^
 ffff8801a785f200: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8801a785f280: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
==================================================================
==================================================================
BUG: KASAN: use-after-free in skb_is_gso include/linux/skbuff.h:3648 [inline] at addr ffff8801a785f182
BUG: KASAN: use-after-free in netif_needs_gso include/linux/netdevice.h:4039 [inline] at addr ffff8801a785f182
BUG: KASAN: use-after-free in validate_xmit_skb.isra.107.part.108+0x831/0xa20 net/core/dev.c:2926 at addr ffff8801a785f182
Read of size 2 by task modprobe/7753
page:ffffea00069e17c0 count:0 mapcount:0 mapping:          (null) index:0x0
flags: 0x57ffe0000000000()
page dumped because: kasan: bad access detected
CPU: 0 PID: 7753 Comm: modprobe Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0d9577e ffff88012c007590 ffffffff82c4dd46 ffff8800aff43ac0
 ffff88012c007620 ffff8801a785f182 0000000000000000 ffff88012c007610
 ffffffff817405ba ffff88012c007648 ffffffff8495006e 0000000000000286
Call Trace:
 <IRQ>  [<ffffffff82c4dd46>] __dump_stack lib/dump_stack.c:15 [inline]
 <IRQ>  [<ffffffff82c4dd46>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff817405ba>] print_address_description mm/kasan/report.c:190 [inline]
 [<ffffffff817405ba>] kasan_report_error+0x59a/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174065e>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174065e>] __asan_report_load2_noabort+0x3e/0x40 mm/kasan/report.c:316
 [<ffffffff84950d61>] skb_is_gso include/linux/skbuff.h:3648 [inline]
 [<ffffffff84950d61>] netif_needs_gso include/linux/netdevice.h:4039 [inline]
 [<ffffffff84950d61>] validate_xmit_skb.isra.107.part.108+0x831/0xa20 net/core/dev.c:2926
 [<ffffffff8495407d>] validate_xmit_skb net/core/dev.c:3059 [inline]
 [<ffffffff8495407d>] __dev_queue_xmit+0x1c5d/0x1f40 net/core/dev.c:3350
 [<ffffffff8495436b>] dev_queue_xmit+0xb/0x10 net/core/dev.c:3392
 [<ffffffff849748c8>] neigh_resolve_output+0x488/0x7d0 net/core/neighbour.c:1311
 [<ffffffff84ffaefb>] dst_neigh_output include/net/dst.h:467 [inline]
 [<ffffffff84ffaefb>] ip6_finish_output2+0x98b/0x1b90 net/ipv6/ip6_output.c:113
 [<ffffffff85004813>] ip6_finish_output+0x353/0x700 net/ipv6/ip6_output.c:131
 [<ffffffff85004d27>] NF_HOOK_COND include/linux/netfilter.h:233 [inline]
 [<ffffffff85004d27>] ip6_output+0x167/0x530 net/ipv6/ip6_output.c:145
 [<ffffffff85082c89>] dst_output include/net/dst.h:504 [inline]
 [<ffffffff85082c89>] NF_HOOK_THRESH.constprop.38+0xc9/0x290 include/linux/netfilter.h:219
 [<ffffffff85084f98>] NF_HOOK include/linux/netfilter.h:242 [inline]
 [<ffffffff85084f98>] mld_sendpack+0x5f8/0xb80 net/ipv6/mcast.c:1646
 [<ffffffff85086900>] mld_send_cr net/ipv6/mcast.c:1927 [inline]
 [<ffffffff85086900>] mld_ifc_timer_expire+0x360/0x710 net/ipv6/mcast.c:2425
 [<ffffffff814a053e>] call_timer_fn+0x14e/0x620 kernel/time/timer.c:1178
 [<ffffffff814a1007>] __run_timers kernel/time/timer.c:1254 [inline]
 [<ffffffff814a1007>] run_timer_softirq+0x5f7/0x9c0 kernel/time/timer.c:1437
 [<ffffffff85b7302c>] __do_softirq+0x2cc/0xa06 kernel/softirq.c:273
 [<ffffffff81355107>] invoke_softirq kernel/softirq.c:350 [inline]
 [<ffffffff81355107>] irq_exit+0x157/0x190 kernel/softirq.c:391
 [<ffffffff85b727bb>] exiting_irq arch/x86/include/asm/apic.h:658 [inline]
 [<ffffffff85b727bb>] smp_apic_timer_interrupt+0x7b/0xa0 arch/x86/kernel/apic/apic.c:932
 [<ffffffff85b70afc>] apic_timer_interrupt+0x8c/0xa0 arch/x86/entry/entry_64.S:621
 <EOI>  [<ffffffff81739f74>] ? arch_local_irq_restore arch/x86/include/asm/paravirt.h:791 [inline]
 <EOI>  [<ffffffff81739f74>] ? kfree+0x154/0x460 mm/slab.c:3641
 [<ffffffff817a8b6a>] free_bprm+0x17a/0x1e0 fs/exec.c:1299
 [<ffffffff817aeeee>] do_execveat_common.isra.42+0x138e/0x1d60 fs/exec.c:1695
 [<ffffffff817af8e7>] do_execve+0x27/0x30 fs/exec.c:1730
 [<ffffffff81384067>] call_usermodehelper_exec_async+0x287/0x420 kernel/kmod.c:252
 [<ffffffff85b700d2>] ret_from_fork+0x22/0x50 arch/x86/entry/entry_64.S:392
Memory state around the buggy address:
 ffff8801a785f080: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8801a785f100: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
>ffff8801a785f180: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
                   ^
 ffff8801a785f200: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8801a785f280: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
==================================================================
==================================================================
BUG: KASAN: use-after-free in skb_release_data+0x39f/0x470 net/core/skbuff.c:592 at addr ffff8801a785f180
Read of size 1 by task modprobe/7753
page:ffffea00069e17c0 count:0 mapcount:0 mapping:          (null) index:0x0
flags: 0x57ffe0000000000()
page dumped because: kasan: bad access detected
CPU: 0 PID: 7753 Comm: modprobe Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0d9577e ffff88012c007330 ffffffff82c4dd46 ffff8800aff43ac0
 ffff88012c0073c0 ffff8801a785f180 ffff8800b420e180 ffff88012c0073b0
 ffffffff817405ba 0000000000000000 ffffffff848f05c0 0000000000000286
Call Trace:
 <IRQ>  [<ffffffff82c4dd46>] __dump_stack lib/dump_stack.c:15 [inline]
 <IRQ>  [<ffffffff82c4dd46>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff817405ba>] print_address_description mm/kasan/report.c:190 [inline]
 [<ffffffff817405ba>] kasan_report_error+0x59a/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174061e>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174061e>] __asan_report_load1_noabort+0x3e/0x40 mm/kasan/report.c:315
 [<ffffffff848fffbf>] skb_release_data+0x39f/0x470 net/core/skbuff.c:592
 [<ffffffff849000cd>] skb_release_all+0x3d/0x50 net/core/skbuff.c:669
 [<ffffffff849000ed>] __kfree_skb+0xd/0x20 net/core/skbuff.c:683
 [<ffffffff84900190>] kfree_skb+0x90/0x2f0 net/core/skbuff.c:704
 [<ffffffff8519bcd6>] br_flood+0x236/0x350 net/bridge/br_forward.c:234
 [<ffffffff8519d046>] br_flood_deliver+0x16/0x20 net/bridge/br_forward.c:241
 [<ffffffff85192c70>] br_dev_xmit+0x680/0xbc0 net/bridge/br_device.c:81
 [<ffffffff84951609>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff84951609>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff84951609>] xmit_one net/core/dev.c:2871 [inline]
 [<ffffffff84951609>] dev_hard_start_xmit+0x6b9/0x1140 net/core/dev.c:2887
 [<ffffffff84953fa5>] __dev_queue_xmit+0x1b85/0x1f40 net/core/dev.c:3358
 [<ffffffff8495436b>] dev_queue_xmit+0xb/0x10 net/core/dev.c:3392
 [<ffffffff849748c8>] neigh_resolve_output+0x488/0x7d0 net/core/neighbour.c:1311
 [<ffffffff84ffaefb>] dst_neigh_output include/net/dst.h:467 [inline]
 [<ffffffff84ffaefb>] ip6_finish_output2+0x98b/0x1b90 net/ipv6/ip6_output.c:113
 [<ffffffff85004813>] ip6_finish_output+0x353/0x700 net/ipv6/ip6_output.c:131
 [<ffffffff85004d27>] NF_HOOK_COND include/linux/netfilter.h:233 [inline]
 [<ffffffff85004d27>] ip6_output+0x167/0x530 net/ipv6/ip6_output.c:145
 [<ffffffff85082c89>] dst_output include/net/dst.h:504 [inline]
 [<ffffffff85082c89>] NF_HOOK_THRESH.constprop.38+0xc9/0x290 include/linux/netfilter.h:219
 [<ffffffff85084f98>] NF_HOOK include/linux/netfilter.h:242 [inline]
 [<ffffffff85084f98>] mld_sendpack+0x5f8/0xb80 net/ipv6/mcast.c:1646
 [<ffffffff85086900>] mld_send_cr net/ipv6/mcast.c:1927 [inline]
 [<ffffffff85086900>] mld_ifc_timer_expire+0x360/0x710 net/ipv6/mcast.c:2425
 [<ffffffff814a053e>] call_timer_fn+0x14e/0x620 kernel/time/timer.c:1178
 [<ffffffff814a1007>] __run_timers kernel/time/timer.c:1254 [inline]
 [<ffffffff814a1007>] run_timer_softirq+0x5f7/0x9c0 kernel/time/timer.c:1437
 [<ffffffff85b7302c>] __do_softirq+0x2cc/0xa06 kernel/softirq.c:273
 [<ffffffff81355107>] invoke_softirq kernel/softirq.c:350 [inline]
 [<ffffffff81355107>] irq_exit+0x157/0x190 kernel/softirq.c:391
 [<ffffffff85b727bb>] exiting_irq arch/x86/include/asm/apic.h:658 [inline]
 [<ffffffff85b727bb>] smp_apic_timer_interrupt+0x7b/0xa0 arch/x86/kernel/apic/apic.c:932
 [<ffffffff85b70afc>] apic_timer_interrupt+0x8c/0xa0 arch/x86/entry/entry_64.S:621
 <EOI>  [<ffffffff81739f74>] ? arch_local_irq_restore arch/x86/include/asm/paravirt.h:791 [inline]
 <EOI>  [<ffffffff81739f74>] ? kfree+0x154/0x460 mm/slab.c:3641
 [<ffffffff817a8b6a>] free_bprm+0x17a/0x1e0 fs/exec.c:1299
 [<ffffffff817aeeee>] do_execveat_common.isra.42+0x138e/0x1d60 fs/exec.c:1695
 [<ffffffff817af8e7>] do_execve+0x27/0x30 fs/exec.c:1730
 [<ffffffff81384067>] call_usermodehelper_exec_async+0x287/0x420 kernel/kmod.c:252
 [<ffffffff85b700d2>] ret_from_fork+0x22/0x50 arch/x86/entry/entry_64.S:392
Memory state around the buggy address:
 ffff8801a785f080: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8801a785f100: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
>ffff8801a785f180: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
                   ^
 ffff8801a785f200: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8801a785f280: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
==================================================================
==================================================================
BUG: KASAN: use-after-free in skb_release_data+0x3f0/0x470 net/core/skbuff.c:599 at addr ffff8801a785f181
Read of size 1 by task modprobe/7753
page:ffffea00069e17c0 count:0 mapcount:0 mapping:          (null) index:0x0
flags: 0x57ffe0000000000()
page dumped because: kasan: bad access detected
CPU: 0 PID: 7753 Comm: modprobe Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0d9577e ffff88012c007330 ffffffff82c4dd46 ffff8800aff43ac0
 ffff88012c0073c0 ffff8801a785f181 ffffed0034f0be30 ffff88012c0073b0
 ffffffff817405ba 0000000000000010 ffffffff00000000 0000000000000286
Call Trace:
 <IRQ>  [<ffffffff82c4dd46>] __dump_stack lib/dump_stack.c:15 [inline]
 <IRQ>  [<ffffffff82c4dd46>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff817405ba>] print_address_description mm/kasan/report.c:190 [inline]
 [<ffffffff817405ba>] kasan_report_error+0x59a/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174061e>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174061e>] __asan_report_load1_noabort+0x3e/0x40 mm/kasan/report.c:315
 [<ffffffff84900010>] skb_release_data+0x3f0/0x470 net/core/skbuff.c:599
 [<ffffffff849000cd>] skb_release_all+0x3d/0x50 net/core/skbuff.c:669
 [<ffffffff849000ed>] __kfree_skb+0xd/0x20 net/core/skbuff.c:683
 [<ffffffff84900190>] kfree_skb+0x90/0x2f0 net/core/skbuff.c:704
 [<ffffffff8519bcd6>] br_flood+0x236/0x350 net/bridge/br_forward.c:234
 [<ffffffff8519d046>] br_flood_deliver+0x16/0x20 net/bridge/br_forward.c:241
 [<ffffffff85192c70>] br_dev_xmit+0x680/0xbc0 net/bridge/br_device.c:81
 [<ffffffff84951609>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff84951609>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff84951609>] xmit_one net/core/dev.c:2871 [inline]
 [<ffffffff84951609>] dev_hard_start_xmit+0x6b9/0x1140 net/core/dev.c:2887
 [<ffffffff84953fa5>] __dev_queue_xmit+0x1b85/0x1f40 net/core/dev.c:3358
 [<ffffffff8495436b>] dev_queue_xmit+0xb/0x10 net/core/dev.c:3392
 [<ffffffff849748c8>] neigh_resolve_output+0x488/0x7d0 net/core/neighbour.c:1311
 [<ffffffff84ffaefb>] dst_neigh_output include/net/dst.h:467 [inline]
 [<ffffffff84ffaefb>] ip6_finish_output2+0x98b/0x1b90 net/ipv6/ip6_output.c:113
 [<ffffffff85004813>] ip6_finish_output+0x353/0x700 net/ipv6/ip6_output.c:131
 [<ffffffff85004d27>] NF_HOOK_COND include/linux/netfilter.h:233 [inline]
 [<ffffffff85004d27>] ip6_output+0x167/0x530 net/ipv6/ip6_output.c:145
 [<ffffffff85082c89>] dst_output include/net/dst.h:504 [inline]
 [<ffffffff85082c89>] NF_HOOK_THRESH.constprop.38+0xc9/0x290 include/linux/netfilter.h:219
 [<ffffffff85084f98>] NF_HOOK include/linux/netfilter.h:242 [inline]
 [<ffffffff85084f98>] mld_sendpack+0x5f8/0xb80 net/ipv6/mcast.c:1646
 [<ffffffff85086900>] mld_send_cr net/ipv6/mcast.c:1927 [inline]
 [<ffffffff85086900>] mld_ifc_timer_expire+0x360/0x710 net/ipv6/mcast.c:2425
 [<ffffffff814a053e>] call_timer_fn+0x14e/0x620 kernel/time/timer.c:1178
 [<ffffffff814a1007>] __run_timers kernel/time/timer.c:1254 [inline]
 [<ffffffff814a1007>] run_timer_softirq+0x5f7/0x9c0 kernel/time/timer.c:1437
 [<ffffffff85b7302c>] __do_softirq+0x2cc/0xa06 kernel/softirq.c:273
 [<ffffffff81355107>] invoke_softirq kernel/softirq.c:350 [inline]
 [<ffffffff81355107>] irq_exit+0x157/0x190 kernel/softirq.c:391
 [<ffffffff85b727bb>] exiting_irq arch/x86/include/asm/apic.h:658 [inline]
 [<ffffffff85b727bb>] smp_apic_timer_interrupt+0x7b/0xa0 arch/x86/kernel/apic/apic.c:932
 [<ffffffff85b70afc>] apic_timer_interrupt+0x8c/0xa0 arch/x86/entry/entry_64.S:621
 <EOI>  [<ffffffff81739f74>] ? arch_local_irq_restore arch/x86/include/asm/paravirt.h:791 [inline]
 <EOI>  [<ffffffff81739f74>] ? kfree+0x154/0x460 mm/slab.c:3641
 [<ffffffff817a8b6a>] free_bprm+0x17a/0x1e0 fs/exec.c:1299
 [<ffffffff817aeeee>] do_execveat_common.isra.42+0x138e/0x1d60 fs/exec.c:1695
 [<ffffffff817af8e7>] do_execve+0x27/0x30 fs/exec.c:1730
 [<ffffffff81384067>] call_usermodehelper_exec_async+0x287/0x420 kernel/kmod.c:252
 [<ffffffff85b700d2>] ret_from_fork+0x22/0x50 arch/x86/entry/entry_64.S:392
Memory state around the buggy address:
 ffff8801a785f080: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8801a785f100: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
>ffff8801a785f180: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
                   ^
 ffff8801a785f200: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8801a785f280: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
==================================================================
==================================================================
BUG: KASAN: use-after-free in skb_release_data+0x3b6/0x470 net/core/skbuff.c:607 at addr ffff8801a785f188
Read of size 8 by task modprobe/7753
page:ffffea00069e17c0 count:0 mapcount:0 mapping:          (null) index:0x0
flags: 0x57ffe0000000000()
page dumped because: kasan: bad access detected
CPU: 0 PID: 7753 Comm: modprobe Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0d9577e ffff88012c007330 ffffffff82c4dd46 ffff8800aff43ac0
 ffff88012c0073c0 ffff8801a785f188 ffffed0034f0be30 ffff88012c0073b0
 ffffffff817405ba 0000000000000010 ffffffff00000000 0000000000000286
Call Trace:
 <IRQ>  [<ffffffff82c4dd46>] __dump_stack lib/dump_stack.c:15 [inline]
 <IRQ>  [<ffffffff82c4dd46>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff817405ba>] print_address_description mm/kasan/report.c:190 [inline]
 [<ffffffff817405ba>] kasan_report_error+0x59a/0x5c0 mm/kasan/report.c:275
 [<ffffffff817406de>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff817406de>] __asan_report_load8_noabort+0x3e/0x40 mm/kasan/report.c:318
 [<ffffffff848fffd6>] skb_release_data+0x3b6/0x470 net/core/skbuff.c:607
 [<ffffffff849000cd>] skb_release_all+0x3d/0x50 net/core/skbuff.c:669
 [<ffffffff849000ed>] __kfree_skb+0xd/0x20 net/core/skbuff.c:683
 [<ffffffff84900190>] kfree_skb+0x90/0x2f0 net/core/skbuff.c:704
 [<ffffffff8519bcd6>] br_flood+0x236/0x350 net/bridge/br_forward.c:234
 [<ffffffff8519d046>] br_flood_deliver+0x16/0x20 net/bridge/br_forward.c:241
 [<ffffffff85192c70>] br_dev_xmit+0x680/0xbc0 net/bridge/br_device.c:81
 [<ffffffff84951609>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff84951609>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff84951609>] xmit_one net/core/dev.c:2871 [inline]
 [<ffffffff84951609>] dev_hard_start_xmit+0x6b9/0x1140 net/core/dev.c:2887
 [<ffffffff84953fa5>] __dev_queue_xmit+0x1b85/0x1f40 net/core/dev.c:3358
 [<ffffffff8495436b>] dev_queue_xmit+0xb/0x10 net/core/dev.c:3392
 [<ffffffff849748c8>] neigh_resolve_output+0x488/0x7d0 net/core/neighbour.c:1311
 [<ffffffff84ffaefb>] dst_neigh_output include/net/dst.h:467 [inline]
 [<ffffffff84ffaefb>] ip6_finish_output2+0x98b/0x1b90 net/ipv6/ip6_output.c:113
 [<ffffffff85004813>] ip6_finish_output+0x353/0x700 net/ipv6/ip6_output.c:131
 [<ffffffff85004d27>] NF_HOOK_COND include/linux/netfilter.h:233 [inline]
 [<ffffffff85004d27>] ip6_output+0x167/0x530 net/ipv6/ip6_output.c:145
 [<ffffffff85082c89>] dst_output include/net/dst.h:504 [inline]
 [<ffffffff85082c89>] NF_HOOK_THRESH.constprop.38+0xc9/0x290 include/linux/netfilter.h:219
 [<ffffffff85084f98>] NF_HOOK include/linux/netfilter.h:242 [inline]
 [<ffffffff85084f98>] mld_sendpack+0x5f8/0xb80 net/ipv6/mcast.c:1646
 [<ffffffff85086900>] mld_send_cr net/ipv6/mcast.c:1927 [inline]
 [<ffffffff85086900>] mld_ifc_timer_expire+0x360/0x710 net/ipv6/mcast.c:2425
 [<ffffffff814a053e>] call_timer_fn+0x14e/0x620 kernel/time/timer.c:1178
 [<ffffffff814a1007>] __run_timers kernel/time/timer.c:1254 [inline]
 [<ffffffff814a1007>] run_timer_softirq+0x5f7/0x9c0 kernel/time/timer.c:1437
 [<ffffffff85b7302c>] __do_softirq+0x2cc/0xa06 kernel/softirq.c:273
 [<ffffffff81355107>] invoke_softirq kernel/softirq.c:350 [inline]
 [<ffffffff81355107>] irq_exit+0x157/0x190 kernel/softirq.c:391
 [<ffffffff85b727bb>] exiting_irq arch/x86/include/asm/apic.h:658 [inline]
 [<ffffffff85b727bb>] smp_apic_timer_interrupt+0x7b/0xa0 arch/x86/kernel/apic/apic.c:932
 [<ffffffff85b70afc>] apic_timer_interrupt+0x8c/0xa0 arch/x86/entry/entry_64.S:621

