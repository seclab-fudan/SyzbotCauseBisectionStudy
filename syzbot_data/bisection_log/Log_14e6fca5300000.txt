bisecting cause commit starting from f1583cb1be35c23df60b1c39e3e7e6704d749d0b
building syzkaller on d236a457274375e5273ac4e958722659929c469f
testing commit f1583cb1be35c23df60b1c39e3e7e6704d749d0b
compiler: gcc (GCC) 10.2.1 20210217, GNU ld (GNU Binutils for Debian) 2.35.1
kernel signature: 85c1de74cbac4680cd9e3bad94af94bcf0be69d02e48b478b47c2393347d556b
all runs: crashed: WARNING: kmalloc bug in memslot_rmap_alloc
testing release v5.14
testing commit 7d2a07b769330c34b4deabeed939325c77a7ec2f
compiler: gcc (GCC) 10.2.1 20210217, GNU ld (GNU Binutils for Debian) 2.35.1
kernel signature: 1bc25c310b773f41f60536ec01fad7eee81fbd08982b6b34e2bd4f1aafdef1ea
run #0: crashed: BUG: spinlock bad magic in synchronize_srcu
run #1: OK
run #2: OK
run #3: OK
run #4: OK
run #5: OK
run #6: OK
run #7: OK
run #8: OK
run #9: OK
reproducer seems to be flaky
testing release v5.13
testing commit 62fb9874f5da54fdb243003b386128037319b219
compiler: gcc (GCC) 10.2.1 20210217, GNU ld (GNU Binutils for Debian) 2.35.1
kernel signature: 79cc2141d6961d1d111273529554accf3406ed45786744614f70cb503fcf44bf
run #0: crashed: BUG: spinlock bad magic in synchronize_srcu
run #1: crashed: BUG: spinlock bad magic in synchronize_srcu
run #2: OK
run #3: OK
run #4: OK
run #5: OK
run #6: OK
run #7: OK
run #8: OK
run #9: OK
run #10: OK
run #11: OK
run #12: OK
run #13: OK
run #14: OK
run #15: OK
run #16: OK
run #17: OK
run #18: OK
run #19: OK
testing release v5.12
testing commit 9f4ad9e425a1d3b6a34617b8ea226d56a119a717
compiler: gcc (GCC) 10.2.1 20210217, GNU ld (GNU Binutils for Debian) 2.35.1
kernel signature: 03446a4bb624836456d5cb3f366f36bb63398997b55dbd1843ea584e688cadcd
run #0: crashed: BUG: spinlock bad magic in synchronize_srcu
run #1: crashed: BUG: spinlock bad magic in synchronize_srcu
run #2: OK
run #3: OK
run #4: OK
run #5: OK
run #6: OK
run #7: OK
run #8: OK
run #9: OK
run #10: OK
run #11: OK
run #12: OK
run #13: OK
run #14: OK
run #15: OK
run #16: OK
run #17: OK
run #18: OK
run #19: crashed: general protection fault in rcu_segcblist_enqueue
testing release v5.11
testing commit f40ddce88593482919761f74910f42f4b84c004b
compiler: gcc (GCC) 10.2.1 20210217, GNU ld (GNU Binutils for Debian) 2.35.1
kernel signature: f1e7de5acc53e30c83d20cbc5b548485391bef48b416bcc252bad00b586d304a
run #0: crashed: BUG: spinlock bad magic in synchronize_srcu
run #1: crashed: BUG: spinlock bad magic in synchronize_srcu
run #2: OK
run #3: OK
run #4: OK
run #5: OK
run #6: OK
run #7: OK
run #8: OK
run #9: OK
run #10: OK
run #11: OK
run #12: OK
run #13: OK
run #14: OK
run #15: OK
run #16: OK
run #17: OK
run #18: OK
run #19: OK
testing release v5.10
testing commit 2c85ebc57b3e1817b6ce1a6b703928e113a90442
compiler: gcc (GCC) 10.2.1 20210217, GNU ld (GNU Binutils for Debian) 2.35.1
kernel signature: 9234860d4d98c2242226297a473408f6e66001791ea0c941ee9d7c74aed71ac3
all runs: OK
# git bisect start f40ddce88593482919761f74910f42f4b84c004b 2c85ebc57b3e1817b6ce1a6b703928e113a90442
Bisecting: 7761 revisions left to test after this (roughly 13 steps)
[538fcf57aaee6ad78a05f52b69a99baa22b33418] Merge branches 'acpi-scan', 'acpi-pnp' and 'acpi-sleep'

testing commit 538fcf57aaee6ad78a05f52b69a99baa22b33418
compiler: gcc (GCC) 10.2.1 20210217, GNU ld (GNU Binutils for Debian) 2.35.1
kernel signature: 9c999d797b9715f8cf736f5d5299d1a255967cbcaa9fb952f1bf72b4f8691034
run #0: crashed: BUG: spinlock bad magic in synchronize_srcu
run #1: OK
run #2: OK
run #3: OK
run #4: OK
run #5: OK
run #6: OK
run #7: OK
run #8: OK
run #9: OK
run #10: OK
run #11: OK
run #12: OK
run #13: OK
run #14: OK
run #15: OK
run #16: OK
run #17: OK
run #18: OK
run #19: OK
# git bisect bad 538fcf57aaee6ad78a05f52b69a99baa22b33418
Bisecting: 4308 revisions left to test after this (roughly 12 steps)
[15b447361794271f4d03c04d82276a841fe06328] mm/lru: revise the comments of lru_lock

testing commit 15b447361794271f4d03c04d82276a841fe06328
compiler: gcc (GCC) 10.2.1 20210217, GNU ld (GNU Binutils for Debian) 2.35.1
kernel signature: f969315cffa8dbfdbbc2866102d97466a88e198def51d0a0b6f351c3f82f67ec
run #0: OK
run #1: OK
run #2: OK
run #3: OK
run #4: OK
run #5: OK
run #6: OK
run #7: OK
run #8: OK
run #9: OK
run #10: OK
run #11: OK
run #12: OK
run #13: crashed: general protection fault in rcu_segcblist_enqueue
run #14: OK
run #15: OK
run #16: OK
run #17: OK
run #18: OK
run #19: OK
# git bisect bad 15b447361794271f4d03c04d82276a841fe06328
Bisecting: 1631 revisions left to test after this (roughly 11 steps)
[b10733527bfd864605c33ab2e9a886eec317ec39] Merge tag 'amd-drm-next-5.11-2020-12-09' of git://people.freedesktop.org/~agd5f/linux into drm-next

testing commit b10733527bfd864605c33ab2e9a886eec317ec39
compiler: gcc (GCC) 10.2.1 20210217, GNU ld (GNU Binutils for Debian) 2.35.1
kernel signature: 3192d161cb2e2d8d1a68fe0ba805de27bda9c377a77f73c02bbc8b44ced53821
run #0: basic kernel testing failed: BUG: sleeping function called from invalid context in sta_info_move_state
run #1: crashed: BUG: sleeping function called from invalid context in sta_info_move_state
run #2: crashed: BUG: sleeping function called from invalid context in sta_info_move_state
run #3: crashed: BUG: sleeping function called from invalid context in sta_info_move_state
run #4: crashed: BUG: sleeping function called from invalid context in sta_info_move_state
run #5: crashed: BUG: sleeping function called from invalid context in sta_info_move_state
run #6: crashed: BUG: sleeping function called from invalid context in sta_info_move_state
run #7: crashed: BUG: sleeping function called from invalid context in sta_info_move_state
run #8: OK
run #9: OK
run #10: OK
run #11: OK
run #12: OK
run #13: OK
run #14: OK
run #15: OK
run #16: OK
run #17: OK
run #18: OK
run #19: OK
# git bisect bad b10733527bfd864605c33ab2e9a886eec317ec39
Bisecting: 886 revisions left to test after this (roughly 10 steps)
[9713158cb2a918c3f6f5522eed23cdeb61f22e75] drm/amdgpu: Add and use seperate reg headers for dcn302

testing commit 9713158cb2a918c3f6f5522eed23cdeb61f22e75
compiler: gcc (GCC) 10.2.1 20210217, GNU ld (GNU Binutils for Debian) 2.35.1
kernel signature: a44b7c5cb6788c58a14813f928623e933750a386876d5f6700b3ad80c4d2af41
run #0: basic kernel testing failed: BUG: sleeping function called from invalid context in sta_info_move_state
run #1: basic kernel testing failed: BUG: sleeping function called from invalid context in sta_info_move_state
run #2: basic kernel testing failed: BUG: sleeping function called from invalid context in sta_info_move_state
run #3: crashed: BUG: sleeping function called from invalid context in sta_info_move_state
run #4: crashed: BUG: sleeping function called from invalid context in sta_info_move_state
run #5: OK
run #6: OK
run #7: OK
run #8: OK
run #9: OK
run #10: OK
run #11: OK
run #12: OK
run #13: OK
run #14: OK
run #15: OK
run #16: OK
run #17: OK
run #18: OK
run #19: OK
# git bisect bad 9713158cb2a918c3f6f5522eed23cdeb61f22e75
Bisecting: 438 revisions left to test after this (roughly 9 steps)
[c0f98d2f8b076bf3e3183aa547395f919c943a14] Merge tag 'drm-misc-next-2020-11-05' of git://anongit.freedesktop.org/drm/drm-misc into drm-next

testing commit c0f98d2f8b076bf3e3183aa547395f919c943a14
compiler: gcc (GCC) 10.2.1 20210217, GNU ld (GNU Binutils for Debian) 2.35.1
kernel signature: 672f8c174cebced8200e9ebc4981711eedcbe42c552b7772c2f4742c0cf9274d
all runs: OK
# git bisect good c0f98d2f8b076bf3e3183aa547395f919c943a14
Bisecting: 219 revisions left to test after this (roughly 8 steps)
[4d154b85f30e66939bbdf038ef78da5bd30a9916] drm/amdgpu_dm: fix a typo

testing commit 4d154b85f30e66939bbdf038ef78da5bd30a9916
compiler: gcc (GCC) 8.4.1 20210217, GNU ld (GNU Binutils for Debian) 2.35.1
kernel signature: 8083e85d04d913414899e4e935c572578d1a152eda3394795b6ec42aaee7a556
all runs: OK
# git bisect good 4d154b85f30e66939bbdf038ef78da5bd30a9916
Bisecting: 109 revisions left to test after this (roughly 7 steps)
[ac70c6c62a35fe394ce44cadecdaf1d0d967422e] drm/amd/pm: add one new function to get 32 bit feature mask for vangogh

testing commit ac70c6c62a35fe394ce44cadecdaf1d0d967422e
compiler: gcc (GCC) 8.4.1 20210217, GNU ld (GNU Binutils for Debian) 2.35.1
kernel signature: 8083e85d04d913414899e4e935c572578d1a152eda3394795b6ec42aaee7a556
all runs: OK
# git bisect good ac70c6c62a35fe394ce44cadecdaf1d0d967422e
Bisecting: 54 revisions left to test after this (roughly 6 steps)
[dbf5256bbf1949f0bffb37134660db03be14fd78] drm/amd/display: Blank HUBP during pixel data blank for DCN30 v2

testing commit dbf5256bbf1949f0bffb37134660db03be14fd78
compiler: gcc (GCC) 8.4.1 20210217, GNU ld (GNU Binutils for Debian) 2.35.1
kernel signature: 8083e85d04d913414899e4e935c572578d1a152eda3394795b6ec42aaee7a556
all runs: OK
# git bisect good dbf5256bbf1949f0bffb37134660db03be14fd78
Bisecting: 27 revisions left to test after this (roughly 5 steps)
[e6cd859dc65f19567fdc5e2653cbd543ada2f53c] drm/amdgpu/display: fix warnings when CONFIG_DRM_AMD_DC_DCN is not set

testing commit e6cd859dc65f19567fdc5e2653cbd543ada2f53c
compiler: gcc (GCC) 8.4.1 20210217, GNU ld (GNU Binutils for Debian) 2.35.1
kernel signature: 8083e85d04d913414899e4e935c572578d1a152eda3394795b6ec42aaee7a556
all runs: OK
# git bisect good e6cd859dc65f19567fdc5e2653cbd543ada2f53c
Bisecting: 13 revisions left to test after this (roughly 4 steps)
[4b60bb0dde1baf347540253f856c54bc908e525c] drm/amdgpu: set LDS_CONFIG=0x20 on Navy Flounder to fix a GPU hang (v2)

testing commit 4b60bb0dde1baf347540253f856c54bc908e525c
compiler: gcc (GCC) 8.4.1 20210217, GNU ld (GNU Binutils for Debian) 2.35.1
kernel signature: 8083e85d04d913414899e4e935c572578d1a152eda3394795b6ec42aaee7a556
all runs: OK
# git bisect good 4b60bb0dde1baf347540253f856c54bc908e525c
Bisecting: 6 revisions left to test after this (roughly 3 steps)
[20f2ffe504728612d7b0c34e4f8280e34251e704] drm/amdgpu: fold CONFIG_DRM_AMD_DC_DCN3* into CONFIG_DRM_AMD_DC_DCN (v3)

testing commit 20f2ffe504728612d7b0c34e4f8280e34251e704
compiler: gcc (GCC) 8.4.1 20210217, GNU ld (GNU Binutils for Debian) 2.35.1
kernel signature: 8083e85d04d913414899e4e935c572578d1a152eda3394795b6ec42aaee7a556
all runs: OK
# git bisect good 20f2ffe504728612d7b0c34e4f8280e34251e704
Bisecting: 3 revisions left to test after this (roughly 2 steps)
[514ad1b6bb6e2fa205b5511bd3d50e33457f6180] drm/amdgpu: Fix Arcturus fan speed reporting

testing commit 514ad1b6bb6e2fa205b5511bd3d50e33457f6180
compiler: gcc (GCC) 8.4.1 20210217, GNU ld (GNU Binutils for Debian) 2.35.1
kernel signature: 8083e85d04d913414899e4e935c572578d1a152eda3394795b6ec42aaee7a556
all runs: OK
# git bisect good 514ad1b6bb6e2fa205b5511bd3d50e33457f6180
Bisecting: 1 revision left to test after this (roughly 1 step)
[512bce50a41c528fa15c4c014293e7bebf018658] Merge v5.10-rc3 into drm-next

testing commit 512bce50a41c528fa15c4c014293e7bebf018658
compiler: gcc (GCC) 10.2.1 20210217, GNU ld (GNU Binutils for Debian) 2.35.1
kernel signature: a44b7c5cb6788c58a14813f928623e933750a386876d5f6700b3ad80c4d2af41
run #0: crashed: BUG: sleeping function called from invalid context in sta_info_move_state
run #1: crashed: BUG: sleeping function called from invalid context in sta_info_move_state
run #2: crashed: BUG: sleeping function called from invalid context in sta_info_move_state
run #3: crashed: BUG: sleeping function called from invalid context in sta_info_move_state
run #4: crashed: BUG: sleeping function called from invalid context in sta_info_move_state
run #5: OK
run #6: OK
run #7: OK
run #8: OK
run #9: OK
run #10: OK
run #11: OK
run #12: OK
run #13: OK
run #14: OK
run #15: OK
run #16: OK
run #17: OK
run #18: OK
run #19: OK
# git bisect bad 512bce50a41c528fa15c4c014293e7bebf018658
Bisecting: 0 revisions left to test after this (roughly 0 steps)
[5b8c596976d4338942dd889b66cd06dc766424e1] Merge tag 'amd-drm-next-5.11-2020-11-05' of git://people.freedesktop.org/~agd5f/linux into drm-next

testing commit 5b8c596976d4338942dd889b66cd06dc766424e1
compiler: gcc (GCC) 10.2.1 20210217, GNU ld (GNU Binutils for Debian) 2.35.1
kernel signature: 672f8c174cebced8200e9ebc4981711eedcbe42c552b7772c2f4742c0cf9274d
all runs: OK
# git bisect good 5b8c596976d4338942dd889b66cd06dc766424e1
512bce50a41c528fa15c4c014293e7bebf018658 is the first bad commit
commit 512bce50a41c528fa15c4c014293e7bebf018658
Merge: 5b8c596976d4 f8394f232b1e
Author: Daniel Vetter <daniel.vetter@ffwll.ch>
Date:   Tue Nov 10 13:58:05 2020 +0100

    Merge v5.10-rc3 into drm-next
    
    We need commit f8f6ae5d077a ("mm: always have io_remap_pfn_range() set
    pgprot_decrypted()") to be able to merge Jason's cleanup patch.
    
    Signed-off-by: Daniel Vetter <daniel.vetter@ffwll.ch>

 Documentation/ABI/stable/sysfs-driver-dma-ioatdma  |  10 +-
 Documentation/ABI/testing/sysfs-class-net          |   2 +-
 Documentation/Makefile                             |   4 +
 Documentation/admin-guide/LSM/SafeSetID.rst        |   2 +-
 Documentation/admin-guide/pm/cpuidle.rst           |   4 +-
 Documentation/admin-guide/sysctl/net.rst           |   1 +
 Documentation/arm/sunxi.rst                        |  10 +
 Documentation/conf.py                              |   2 +-
 Documentation/dev-tools/kasan.rst                  |   2 +
 Documentation/dev-tools/kunit/start.rst            |   2 +-
 Documentation/dev-tools/kunit/usage.rst            |   5 +
 .../devicetree/bindings/clock/hi6220-clock.txt     |   2 +-
 .../bindings/interrupt-controller/ti,sci-inta.yaml |  10 +
 .../bindings/net/can/can-controller.yaml           |  18 ++
 .../devicetree/bindings/net/can/fsl,flexcan.yaml   | 135 ++++++++++++++
 .../devicetree/bindings/net/can/fsl-flexcan.txt    |  57 ------
 Documentation/filesystems/api-summary.rst          |   3 -
 Documentation/gpu/amdgpu.rst                       |   7 -
 Documentation/hwmon/adm1266.rst                    |   2 +-
 Documentation/hwmon/index.rst                      |   1 +
 Documentation/hwmon/mp2975.rst                     |  14 +-
 Documentation/leds/index.rst                       |   1 +
 Documentation/locking/lockdep-design.rst           |  51 ++++--
 Documentation/misc-devices/index.rst               |   1 -
 Documentation/networking/devlink/ice.rst           |   1 +
 Documentation/networking/j1939.rst                 | 120 ++++++------
 Documentation/networking/statistics.rst            |   3 +-
 Documentation/sphinx/automarkup.py                 |  20 +-
 Documentation/userspace-api/index.rst              |   1 +
 MAINTAINERS                                        |  19 +-
 Makefile                                           |   2 +-
 arch/arc/kernel/head.S                             |  17 +-
 arch/arc/kernel/stacktrace.c                       |   7 +-
 arch/arc/plat-hsdk/platform.c                      |  17 --
 arch/arm/mm/init.c                                 |   4 +-
 arch/arm64/Kconfig                                 |   2 +-
 arch/arm64/include/asm/brk-imm.h                   |   2 +
 arch/arm64/include/asm/debug-monitors.h            |   1 +
 arch/arm64/include/asm/kprobes.h                   |   2 +-
 arch/arm64/kernel/kexec_image.c                    |  41 ++++-
 arch/arm64/kernel/machine_kexec_file.c             |   9 +-
 arch/arm64/kernel/probes/kprobes.c                 |  69 +++----
 arch/powerpc/include/asm/nohash/32/kup-8xx.h       |   2 +-
 arch/powerpc/include/asm/nohash/32/mmu-8xx.h       |  47 ++---
 arch/powerpc/include/asm/nohash/32/pte-8xx.h       |   9 +-
 arch/powerpc/include/asm/topology.h                |  12 +-
 arch/powerpc/include/asm/uaccess.h                 |   4 +-
 arch/powerpc/kernel/eeh_cache.c                    |   5 +-
 arch/powerpc/kernel/head_40x.S                     |   8 -
 arch/powerpc/kernel/head_8xx.S                     |  46 +----
 arch/powerpc/kernel/head_book3s_32.S               |  12 --
 arch/powerpc/kernel/smp.c                          |   3 +-
 arch/riscv/include/asm/uaccess.h                   |   2 +-
 arch/riscv/kernel/ftrace.c                         |   2 +-
 arch/riscv/kernel/head.S                           |   5 +
 arch/riscv/kernel/vdso/.gitignore                  |   1 +
 arch/riscv/kernel/vdso/Makefile                    |  18 +-
 arch/riscv/kernel/vdso/so2s.sh                     |   6 +
 arch/riscv/mm/fault.c                              |   4 +-
 arch/riscv/mm/init.c                               |  32 ++--
 arch/s390/configs/debug_defconfig                  |  10 +-
 arch/s390/configs/defconfig                        |   9 +-
 arch/s390/configs/zfcpdump_defconfig               |   2 +-
 arch/s390/include/asm/pgtable.h                    |  52 +++---
 arch/s390/include/asm/vdso/vdso.h                  |   0
 arch/s390/kernel/asm-offsets.c                     |   8 -
 arch/s390/kernel/smp.c                             |   3 +-
 arch/s390/pci/pci_event.c                          |   4 +
 arch/x86/boot/compressed/ident_map_64.c            |   1 +
 arch/x86/boot/compressed/mem_encrypt.S             |  20 +-
 arch/x86/boot/compressed/misc.h                    |   2 +
 arch/x86/hyperv/hv_apic.c                          |  14 +-
 arch/x86/kernel/apic/x2apic_uv_x.c                 |  23 ++-
 arch/x86/kernel/cpu/bugs.c                         |  51 ++++--
 arch/x86/kernel/head_64.S                          |  16 ++
 arch/x86/kernel/sev-es-shared.c                    |  26 +++
 arch/x86/kernel/sev-es.c                           |  20 +-
 arch/x86/kernel/sev_verify_cbit.S                  |  89 +++++++++
 arch/x86/lib/memcpy_64.S                           |   4 +-
 arch/x86/lib/memmove_64.S                          |   4 +-
 arch/x86/lib/memset_64.S                           |   4 +-
 arch/x86/mm/mem_encrypt.c                          |   1 +
 arch/xtensa/mm/init.c                              |   4 +-
 drivers/base/core.c                                |   6 +-
 drivers/base/dd.c                                  |   9 +-
 drivers/base/power/runtime.c                       |  57 ++----
 drivers/block/null_blk.h                           |   2 +-
 drivers/block/null_blk_zoned.c                     |  47 +++--
 drivers/char/tpm/eventlog/efi.c                    |   5 +
 drivers/char/tpm/tpm_tis.c                         |  29 ++-
 drivers/crypto/allwinner/sun8i-ce/sun8i-ce-hash.c  |   2 +-
 drivers/crypto/allwinner/sun8i-ce/sun8i-ce-prng.c  |   2 +-
 drivers/crypto/allwinner/sun8i-ce/sun8i-ce-trng.c  |   2 +-
 drivers/gpu/drm/amd/display/include/dal_asic_id.h  |   4 +
 drivers/gpu/drm/i915/gem/i915_gem_domain.c         |  28 ++-
 drivers/gpu/drm/i915/gt/intel_engine.h             |  55 ++++--
 drivers/gpu/drm/i915/gt/intel_lrc.c                |  31 +++-
 drivers/gpu/drm/i915/gt/intel_timeline.c           |  18 +-
 drivers/gpu/drm/i915/gt/intel_timeline_types.h     |   2 +
 drivers/gpu/drm/i915/gvt/handlers.c                |  47 ++++-
 drivers/gpu/drm/i915/gvt/scheduler.c               |  15 +-
 drivers/gpu/drm/i915/i915_vma.c                    |   6 +-
 drivers/gpu/drm/imx/dw_hdmi-imx.c                  |  17 +-
 drivers/gpu/drm/imx/imx-drm-core.c                 |  10 +-
 drivers/gpu/drm/imx/imx-ldb.c                      |  10 +-
 drivers/gpu/drm/imx/imx-tve.c                      |  40 +---
 drivers/gpu/drm/imx/parallel-display.c             |  20 +-
 drivers/gpu/drm/panfrost/panfrost_drv.c            |   5 +-
 drivers/gpu/drm/panfrost/panfrost_gem.c            |   4 +-
 drivers/gpu/drm/panfrost/panfrost_gem.h            |   2 +-
 drivers/gpu/drm/panfrost/panfrost_gem_shrinker.c   |  14 +-
 drivers/gpu/drm/vc4/vc4_bo.c                       |   9 +-
 drivers/gpu/drm/vc4/vc4_drv.c                      |  41 ++---
 drivers/gpu/drm/vc4/vc4_drv.h                      |   9 +-
 drivers/gpu/drm/vc4/vc4_gem.c                      |  19 +-
 drivers/gpu/drm/vc4/vc4_hvs.c                      |   4 +-
 drivers/gpu/drm/vc4/vc4_kms.c                      |  80 +++++---
 drivers/gpu/drm/vc4/vc4_v3d.c                      |  12 +-
 drivers/gpu/ipu-v3/ipu-common.c                    |  67 -------
 drivers/hv/hv_balloon.c                            |   2 +-
 drivers/i2c/busses/Kconfig                         |   2 +-
 drivers/i2c/busses/i2c-designware-slave.c          |  52 ++----
 drivers/i2c/busses/i2c-mlxbf.c                     | 204 +++++++++------------
 drivers/i2c/busses/i2c-mt65xx.c                    |   8 +-
 drivers/i2c/busses/i2c-sh_mobile.c                 |  86 +++++++--
 drivers/infiniband/hw/vmw_pvrdma/pvrdma_verbs.h    |   2 +-
 drivers/infiniband/sw/rdmavt/vt.c                  |   7 +-
 drivers/infiniband/sw/rxe/rxe_verbs.c              |   6 +-
 drivers/infiniband/sw/siw/siw_main.c               |   7 +-
 drivers/infiniband/ulp/srpt/ib_srpt.c              |  13 +-
 drivers/infiniband/ulp/srpt/ib_srpt.h              |   1 +
 drivers/iommu/amd/amd_iommu_types.h                |   6 +-
 drivers/iommu/intel/iommu.c                        |   3 +
 drivers/iommu/intel/svm.c                          |   8 +-
 drivers/iommu/iommu.c                              |   2 +-
 drivers/irqchip/Kconfig                            |   3 +-
 drivers/irqchip/irq-bcm2836.c                      |   2 +-
 drivers/irqchip/irq-mst-intc.c                     |   4 +-
 drivers/irqchip/irq-renesas-intc-irqpin.c          |   8 +-
 drivers/irqchip/irq-sifive-plic.c                  |  10 +-
 drivers/irqchip/irq-stm32-exti.c                   |   4 +
 drivers/irqchip/irq-ti-sci-inta.c                  |  83 ++++++++-
 drivers/mtd/nand/raw/fsl_ifc_nand.c                |  43 +++--
 drivers/mtd/nand/raw/mxc_nand.c                    |  17 +-
 drivers/mtd/nand/raw/stm32_fmc2_nand.c             |  15 +-
 drivers/mtd/spi-nor/core.c                         |  13 +-
 drivers/net/can/dev.c                              |  14 +-
 drivers/net/can/flexcan.c                          |  12 +-
 drivers/net/can/peak_canfd/peak_canfd.c            |  11 +-
 drivers/net/can/rx-offload.c                       |   4 +-
 drivers/net/can/spi/mcp251xfd/mcp251xfd-core.c     |  22 +--
 drivers/net/can/spi/mcp251xfd/mcp251xfd-regmap.c   |  18 +-
 drivers/net/can/ti_hecc.c                          |   8 +-
 drivers/net/can/usb/peak_usb/pcan_usb_core.c       |  51 +++++-
 drivers/net/can/usb/peak_usb/pcan_usb_fd.c         |  48 +++--
 drivers/net/can/xilinx_can.c                       |   6 +-
 drivers/net/dsa/qca8k.c                            |   4 +-
 drivers/net/ethernet/cadence/macb_main.c           |   3 +-
 .../chelsio/inline_crypto/chtls/chtls_cm.c         |   2 +-
 .../chelsio/inline_crypto/chtls/chtls_hw.c         |   3 +
 drivers/net/ethernet/freescale/dpaa/dpaa_eth.c     |  28 ++-
 drivers/net/ethernet/freescale/fec.h               |   6 +
 drivers/net/ethernet/freescale/fec_main.c          |  29 +--
 drivers/net/ethernet/freescale/gianfar.c           |  14 +-
 drivers/net/ethernet/ibm/ibmvnic.c                 |  36 +++-
 .../net/ethernet/pensando/ionic/ionic_ethtool.c    |   5 +
 drivers/net/ethernet/realtek/r8169_main.c          |  14 +-
 drivers/net/ethernet/stmicro/stmmac/dwmac-intel.c  |  14 +-
 drivers/net/ethernet/stmicro/stmmac/stmmac_main.c  |   1 +
 drivers/net/ethernet/ti/cpsw_ethtool.c             |   1 -
 drivers/net/ethernet/ti/cpsw_priv.c                |   5 +-
 drivers/net/phy/sfp.c                              |   3 +-
 drivers/net/usb/qmi_wwan.c                         |   1 +
 drivers/nvme/host/core.c                           |   8 +-
 drivers/nvme/host/nvme.h                           |   1 +
 drivers/nvme/host/pci.c                            |  23 ++-
 drivers/nvme/host/rdma.c                           |  14 +-
 drivers/nvme/host/tcp.c                            |  16 +-
 drivers/of/device.c                                |   2 +-
 drivers/opp/core.c                                 |   9 +-
 drivers/opp/of.c                                   |   2 +
 drivers/pci/controller/dwc/pcie-designware-host.c  |   8 +-
 drivers/pci/controller/pci-mvebu.c                 |  23 +--
 drivers/pci/pci.c                                  |   9 +-
 drivers/powercap/intel_rapl_common.c               |   2 +-
 drivers/regulator/core.c                           |   2 +
 drivers/s390/crypto/ap_bus.c                       |  14 +-
 drivers/s390/crypto/pkey_api.c                     |  30 +--
 drivers/s390/crypto/zcrypt_card.c                  |  13 +-
 drivers/s390/crypto/zcrypt_queue.c                 |   6 +-
 drivers/scsi/device_handler/scsi_dh_alua.c         |   9 +-
 drivers/scsi/hpsa.c                                |   4 +-
 drivers/scsi/mpt3sas/mpt3sas_base.c                |   7 +
 drivers/spi/spi-bcm2835.c                          |  15 +-
 drivers/spi/spi-fsl-dspi.c                         |  10 +-
 drivers/spi/spi-imx.c                              |  23 ++-
 .../bindings/net/wireless/silabs,wfx.yaml          |   2 +-
 drivers/tty/serial/8250/8250_mtk.c                 |   2 +-
 drivers/tty/serial/Kconfig                         |   1 +
 drivers/tty/serial/serial_txx9.c                   |   3 +
 drivers/tty/tty_io.c                               |   6 +-
 drivers/tty/vt/vt.c                                |  24 +--
 drivers/tty/vt/vt_ioctl.c                          |  36 ++--
 drivers/usb/core/quirks.c                          |   3 +
 drivers/usb/dwc2/platform.c                        |   3 +
 drivers/usb/dwc3/dwc3-pci.c                        |   4 +
 drivers/usb/dwc3/ep0.c                             |   3 +-
 drivers/usb/gadget/legacy/raw_gadget.c             |   5 +-
 drivers/usb/gadget/udc/fsl_udc_core.c              |   2 +-
 drivers/usb/gadget/udc/goku_udc.c                  |   2 +-
 drivers/usb/misc/apple-mfi-fastcharge.c            |   4 +-
 drivers/usb/mtu3/mtu3_gadget.c                     |   1 +
 drivers/usb/serial/cyberjack.c                     |   7 +-
 drivers/usb/serial/option.c                        |  10 +
 drivers/vfio/fsl-mc/vfio_fsl_mc.c                  |  10 +-
 drivers/vfio/fsl-mc/vfio_fsl_mc_intr.c             |   2 +-
 drivers/vfio/pci/vfio_pci.c                        |   2 +-
 drivers/vfio/pci/vfio_pci_rdwr.c                   |  43 ++++-
 drivers/vfio/platform/vfio_platform_common.c       |   3 +-
 drivers/vfio/vfio_iommu_type1.c                    |  17 +-
 fs/afs/xattr.c                                     |   7 +-
 fs/afs/yfsclient.c                                 |   1 +
 fs/ceph/caps.c                                     |   2 +-
 fs/ceph/mds_client.c                               |  50 +++--
 fs/ceph/mds_client.h                               |   1 +
 fs/ceph/quota.c                                    |   2 +-
 fs/ceph/snap.c                                     |   2 +-
 fs/gfs2/glock.c                                    |   3 +-
 fs/gfs2/glops.c                                    |  56 ++++--
 fs/gfs2/glops.h                                    |   1 +
 fs/gfs2/inode.c                                    |   3 +-
 fs/gfs2/lops.c                                     |  31 +---
 fs/gfs2/lops.h                                     |   2 -
 fs/gfs2/ops_fstype.c                               |  14 +-
 fs/gfs2/recovery.c                                 |   2 +-
 fs/gfs2/rgrp.c                                     |   5 +-
 fs/gfs2/super.c                                    |   1 +
 fs/io-wq.c                                         |   4 +
 fs/io_uring.c                                      | 183 +++++++++++++-----
 fs/iomap/buffered-io.c                             |  30 +--
 fs/proc/base.c                                     |   2 +
 fs/proc/cpuinfo.c                                  |   2 +-
 fs/proc/generic.c                                  |   4 +-
 fs/proc/inode.c                                    |   2 +
 fs/proc/stat.c                                     |   2 +-
 fs/seq_file.c                                      |  45 +++--
 fs/xfs/libxfs/xfs_alloc.c                          |   1 +
 fs/xfs/libxfs/xfs_bmap.h                           |   2 +-
 fs/xfs/scrub/inode.c                               |   3 +-
 fs/xfs/xfs_aops.c                                  |  20 +-
 fs/xfs/xfs_iops.c                                  |  10 +
 fs/xfs/xfs_reflink.c                               |   3 +-
 include/kunit/test.h                               |  16 +-
 include/linux/blk-mq.h                             |   2 +
 include/linux/can/skb.h                            |  20 +-
 include/linux/io_uring.h                           |   3 +-
 include/linux/iomap.h                              |   2 +-
 include/linux/mm.h                                 |   9 +
 include/linux/netfilter/nfnetlink.h                |   9 +-
 include/linux/netfilter_ipv4.h                     |   2 +-
 include/linux/netfilter_ipv6.h                     |  10 +-
 include/linux/pagemap.h                            |   8 +-
 include/linux/pgtable.h                            |   4 -
 include/linux/phy.h                                |  40 +---
 include/linux/pm_runtime.h                         |   6 +-
 include/linux/refcount.h                           | 130 ++++++-------
 include/linux/seq_file.h                           |   1 +
 include/net/cfg80211.h                             |   9 +-
 include/net/mac80211.h                             |   7 +-
 include/sound/control.h                            |   2 +-
 include/sound/core.h                               |   3 +-
 include/sound/pcm.h                                |   4 +-
 include/uapi/linux/icmpv6.h                        |   1 +
 include/uapi/sound/compress_offload.h              |   2 +-
 include/video/imx-ipu-v3.h                         |   3 -
 kernel/entry/common.c                              |   4 +-
 kernel/events/core.c                               |  12 +-
 kernel/fork.c                                      |  10 +-
 kernel/futex.c                                     |  16 +-
 kernel/hung_task.c                                 |   3 +-
 kernel/irq/Kconfig                                 |   1 +
 kernel/kprobes.c                                   |  25 ++-
 kernel/kthread.c                                   |   3 +-
 kernel/sched/cpufreq_schedutil.c                   |  22 +--
 kernel/signal.c                                    |  19 +-
 kernel/trace/ring_buffer.c                         |  58 ++++--
 kernel/trace/trace.c                               |   6 +-
 kernel/trace/trace.h                               |  26 ++-
 kernel/trace/trace_events_synth.c                  |  17 +-
 kernel/trace/trace_selftest.c                      |   9 +-
 lib/crc32test.c                                    |   4 -
 lib/fonts/font_10x18.c                             |   2 +-
 lib/fonts/font_6x10.c                              |   2 +-
 lib/fonts/font_6x11.c                              |   2 +-
 lib/fonts/font_6x8.c                               |   2 +-
 lib/fonts/font_7x14.c                              |   2 +-
 lib/fonts/font_8x16.c                              |   2 +-
 lib/fonts/font_8x8.c                               |   2 +-
 lib/fonts/font_acorn_8x8.c                         |   2 +-
 lib/fonts/font_mini_4x6.c                          |   2 +-
 lib/fonts/font_pearl_8x8.c                         |   2 +-
 lib/fonts/font_sun12x22.c                          |   2 +-
 lib/fonts/font_sun8x16.c                           |   2 +-
 lib/fonts/font_ter16x32.c                          |   2 +-
 lib/test_kasan.c                                   | 149 ++++++++++-----
 mm/hugetlb.c                                       |  20 +-
 mm/memcontrol.c                                    |  25 ++-
 mm/mempolicy.c                                     |   6 +-
 mm/memremap.c                                      |  39 ++--
 mm/truncate.c                                      |   2 +-
 net/atm/lec.c                                      |   5 +-
 net/can/Kconfig                                    |   5 +-
 net/can/isotp.c                                    |  26 +--
 net/can/j1939/socket.c                             |   6 +
 net/can/proc.c                                     |   6 +-
 net/ipv4/ip_tunnel.c                               |   3 -
 net/ipv4/netfilter.c                               |   8 +-
 net/ipv4/netfilter/iptable_mangle.c                |   2 +-
 net/ipv4/netfilter/nf_reject_ipv4.c                |   2 +-
 net/ipv4/xfrm4_tunnel.c                            |   4 +-
 net/ipv6/icmp.c                                    |   8 +-
 net/ipv6/ip6_tunnel.c                              |   4 +-
 net/ipv6/netfilter.c                               |   6 +-
 net/ipv6/netfilter/ip6table_mangle.c               |   2 +-
 net/ipv6/reassembly.c                              |  33 +++-
 net/ipv6/xfrm6_tunnel.c                            |   4 +-
 net/mac80211/mlme.c                                |   3 +-
 net/mac80211/sta_info.c                            |  18 ++
 net/mac80211/sta_info.h                            |   9 +-
 net/mac80211/tx.c                                  |  44 +++--
 net/mptcp/token.c                                  |   2 +-
 net/netfilter/ipset/ip_set_core.c                  |   3 +-
 net/netfilter/ipvs/ip_vs_core.c                    |   4 +-
 net/netfilter/nf_nat_proto.c                       |   4 +-
 net/netfilter/nf_synproxy_core.c                   |   2 +-
 net/netfilter/nf_tables_api.c                      |  19 +-
 net/netfilter/nfnetlink.c                          |  22 ++-
 net/netfilter/nft_chain_route.c                    |   4 +-
 net/netfilter/utils.c                              |   4 +-
 net/openvswitch/datapath.c                         |  14 +-
 net/openvswitch/flow_table.c                       |   2 +-
 net/sctp/sm_sideeffect.c                           |   4 +-
 net/wireless/core.c                                |  57 +++---
 net/wireless/core.h                                |   5 +-
 net/wireless/nl80211.c                             |   3 +-
 net/wireless/reg.c                                 |   2 +-
 net/xfrm/xfrm_interface.c                          |   8 +-
 net/xfrm/xfrm_state.c                              |   8 +-
 scripts/get_abi.pl                                 |  23 +++
 scripts/kernel-doc                                 |  21 ++-
 sound/core/control.c                               |   4 +-
 sound/core/pcm_dmaengine.c                         |   3 +-
 sound/core/pcm_lib.c                               |   2 +-
 sound/core/pcm_native.c                            |   4 +-
 sound/hda/ext/hdac_ext_controller.c                |   2 +
 sound/pci/hda/hda_codec.c                          |  45 +++--
 sound/pci/hda/hda_controller.h                     |   3 +-
 sound/pci/hda/hda_intel.c                          |  63 ++++---
 sound/pci/hda/patch_realtek.c                      |  67 +++++--
 sound/soc/atmel/mchp-spdiftx.c                     |   1 -
 sound/soc/codecs/cs42l51.c                         |  22 ++-
 sound/soc/codecs/wcd9335.c                         |   2 +-
 sound/soc/codecs/wcd934x.c                         |   2 +-
 sound/soc/codecs/wsa881x.c                         |   2 +
 sound/soc/intel/Kconfig                            |  18 --
 sound/soc/intel/atom/Makefile                      |   2 +-
 sound/soc/intel/atom/sst/Makefile                  |   6 +-
 sound/soc/intel/boards/kbl_rt5663_max98927.c       |  39 +++-
 sound/soc/intel/catpt/dsp.c                        |   9 +-
 sound/soc/intel/catpt/pcm.c                        |  10 +
 sound/soc/mediatek/mt8183/mt8183-da7219-max98357.c |  31 +++-
 sound/soc/qcom/lpass-cpu.c                         |  14 +-
 sound/soc/qcom/lpass-sc7180.c                      |   2 +-
 sound/soc/qcom/sdm845.c                            |   2 +
 sound/soc/soc-core.c                               |   2 +-
 sound/soc/soc-dapm.c                               |   2 +-
 sound/soc/sof/loader.c                             |   5 +
 sound/usb/pcm.c                                    |   6 +
 sound/usb/quirks.c                                 |   1 +
 tools/arch/arm64/include/uapi/asm/kvm.h            |  25 +++
 tools/arch/s390/include/uapi/asm/sie.h             |   2 +-
 tools/arch/x86/include/asm/cpufeatures.h           |   6 +-
 tools/arch/x86/include/asm/disabled-features.h     |   9 +-
 tools/arch/x86/include/asm/msr-index.h             |  10 +
 tools/arch/x86/include/asm/required-features.h     |   2 +-
 tools/arch/x86/include/uapi/asm/kvm.h              |  20 ++
 tools/arch/x86/include/uapi/asm/svm.h              |  13 ++
 tools/build/feature/test-all.c                     |   1 -
 tools/include/linux/compiler-gcc.h                 |  12 --
 tools/include/linux/compiler.h                     |   3 -
 tools/include/uapi/asm-generic/unistd.h            |   4 +-
 tools/include/uapi/drm/i915_drm.h                  |  59 +++++-
 tools/include/uapi/linux/fscrypt.h                 |   6 +-
 tools/include/uapi/linux/kvm.h                     |  19 ++
 tools/include/uapi/linux/mman.h                    |   1 +
 tools/include/uapi/linux/mount.h                   |   1 +
 tools/include/uapi/linux/perf_event.h              |   2 +-
 tools/include/uapi/linux/prctl.h                   |   9 +
 tools/include/uapi/linux/vhost.h                   |   4 +
 tools/perf/Makefile.config                         |   1 +
 tools/perf/arch/x86/entry/syscalls/syscall_64.tbl  |  11 +-
 tools/perf/builtin-trace.c                         |  15 +-
 .../arch/x86/cascadelakex/clx-metrics.json         |   2 +-
 .../pmu-events/arch/x86/skylakex/skx-metrics.json  |   2 +-
 tools/perf/tests/dwarf-unwind.c                    |  10 +-
 tools/perf/ui/browsers/hists.c                     |   2 +-
 tools/perf/util/build-id.c                         |   2 +
 tools/perf/util/hashmap.c                          |   3 +
 tools/perf/util/hashmap.h                          |  12 ++
 tools/perf/util/machine.c                          |  11 +-
 .../util/scripting-engines/trace-event-python.c    |   7 +-
 tools/perf/util/session.c                          |  14 ++
 tools/perf/util/symbol.c                           |   7 +
 tools/perf/util/symbol.h                           |   2 +
 tools/testing/kunit/kunit_parser.py                |   3 +-
 tools/testing/kunit/kunit_tool_test.py             |  32 +++-
 .../kunit/test_data/test_config_printk_time.log    | Bin 1584 -> 1605 bytes
 .../test_data/test_interrupted_tap_output.log      | Bin 1982 -> 2003 bytes
 .../test_data/test_kernel_panic_interrupt.log      | Bin 1321 -> 1342 bytes
 .../kunit/test_data/test_multiple_prefixes.log     | Bin 1832 -> 1861 bytes
 .../kunit/test_data/test_pound_no_prefix.log       | Bin 1193 -> 1200 bytes
 tools/testing/kunit/test_data/test_pound_sign.log  | Bin 1656 -> 1676 bytes
 .../clone3/clone3_cap_checkpoint_restore.c         |   2 +-
 tools/testing/selftests/core/close_range_test.c    |   8 +-
 .../selftests/filesystems/binderfs/binderfs_test.c |   8 +-
 .../filesystems/epoll/epoll_wakeup_test.c          |  95 ++++++++++
 .../ftrace/test.d/dynevent/add_remove_kprobe.tc    |   2 +-
 .../ftrace/test.d/dynevent/clear_select_events.tc  |   2 +-
 .../ftrace/test.d/dynevent/generic_clear_event.tc  |   2 +-
 .../test.d/ftrace/func-filter-notrace-pid.tc       |   2 +-
 .../ftrace/test.d/ftrace/func-filter-pid.tc        |   2 +-
 .../ftrace/test.d/ftrace/func-filter-stacktrace.tc |   4 +-
 tools/testing/selftests/ftrace/test.d/functions    |   7 +
 .../ftrace/test.d/kprobe/add_and_remove.tc         |   2 +-
 .../selftests/ftrace/test.d/kprobe/busy_check.tc   |   2 +-
 .../selftests/ftrace/test.d/kprobe/kprobe_args.tc  |   4 +-
 .../ftrace/test.d/kprobe/kprobe_args_comm.tc       |   2 +-
 .../ftrace/test.d/kprobe/kprobe_args_string.tc     |   4 +-
 .../ftrace/test.d/kprobe/kprobe_args_symbol.tc     |  10 +-
 .../ftrace/test.d/kprobe/kprobe_args_type.tc       |   2 +-
 .../ftrace/test.d/kprobe/kprobe_args_user.tc       |   4 +
 .../ftrace/test.d/kprobe/kprobe_ftrace.tc          |  14 +-
 .../ftrace/test.d/kprobe/kprobe_multiprobe.tc      |   2 +-
 .../ftrace/test.d/kprobe/kprobe_syntax_errors.tc   |  12 +-
 .../ftrace/test.d/kprobe/kretprobe_args.tc         |   4 +-
 .../selftests/ftrace/test.d/kprobe/profile.tc      |   2 +-
 tools/testing/selftests/kselftest_harness.h        |  46 ++---
 tools/testing/selftests/lib.mk                     |   2 +-
 tools/testing/selftests/pidfd/config               |   1 +
 tools/testing/selftests/pidfd/pidfd_getfd_test.c   |   5 +-
 tools/testing/selftests/pidfd/pidfd_open_test.c    |   1 -
 tools/testing/selftests/pidfd/pidfd_poll_test.c    |   1 -
 tools/testing/selftests/pidfd/pidfd_setns_test.c   |   1 -
 tools/testing/selftests/pidfd/pidfd_test.c         |   2 +-
 tools/testing/selftests/proc/proc-loadavg-001.c    |   1 -
 tools/testing/selftests/proc/proc-self-syscall.c   |   1 -
 tools/testing/selftests/proc/proc-uptime-002.c     |   1 -
 tools/testing/selftests/wireguard/netns.sh         |   8 +
 .../testing/selftests/wireguard/qemu/kernel.config |   2 +
 459 files changed, 3837 insertions(+), 2265 deletions(-)
 create mode 100644 Documentation/devicetree/bindings/net/can/can-controller.yaml
 create mode 100644 Documentation/devicetree/bindings/net/can/fsl,flexcan.yaml
 delete mode 100644 Documentation/devicetree/bindings/net/can/fsl-flexcan.txt
 create mode 100755 arch/riscv/kernel/vdso/so2s.sh
 delete mode 100644 arch/s390/include/asm/vdso/vdso.h
 create mode 100644 arch/x86/kernel/sev_verify_cbit.S

Reproducer flagged being flaky
revisions tested: 20, total time: 5h21m23.524789866s (build: 2h15m16.919405727s, test: 3h3m5.081212167s)
first bad commit: 512bce50a41c528fa15c4c014293e7bebf018658 Merge v5.10-rc3 into drm-next
recipients (to): ["airlied@linux.ie" "alexander.deucher@amd.com" "amd-gfx@lists.freedesktop.org" "christian.koenig@amd.com" "daniel.vetter@ffwll.ch" "daniel@ffwll.ch" "dri-devel@lists.freedesktop.org" "harry.wentland@amd.com" "sunpeng.li@amd.com"]
recipients (cc): ["Roman.Li@amd.com" "hersenxs.wu@amd.com" "linux-kernel@vger.kernel.org" "luben.tuikov@amd.com"]
crash: BUG: sleeping function called from invalid context in sta_info_move_state
wlan1: Created IBSS using preconfigured BSSID 50:50:50:50:50:50
wlan1: Creating new IBSS network, BSSID 50:50:50:50:50:50
BUG: sleeping function called from invalid context at net/mac80211/sta_info.c:1962
in_atomic(): 0, irqs_disabled(): 0, non_block: 0, pid: 1027, name: kworker/u4:7
4 locks held by kworker/u4:7/1027:
 #0: ffff888033332938 ((wq_completion)phy16){+.+.}-{0:0}, at: arch_atomic64_set arch/x86/include/asm/atomic64_64.h:34 [inline]
 #0: ffff888033332938 ((wq_completion)phy16){+.+.}-{0:0}, at: atomic64_set include/asm-generic/atomic-instrumented.h:856 [inline]
 #0: ffff888033332938 ((wq_completion)phy16){+.+.}-{0:0}, at: atomic_long_set include/asm-generic/atomic-long.h:41 [inline]
 #0: ffff888033332938 ((wq_completion)phy16){+.+.}-{0:0}, at: set_work_data kernel/workqueue.c:616 [inline]
 #0: ffff888033332938 ((wq_completion)phy16){+.+.}-{0:0}, at: set_work_pool_and_clear_pending kernel/workqueue.c:643 [inline]
 #0: ffff888033332938 ((wq_completion)phy16){+.+.}-{0:0}, at: process_one_work+0x680/0x1230 kernel/workqueue.c:2243
 #1: ffffc9000476fdb0 ((work_completion)(&sdata->work)){+.+.}-{0:0}, at: process_one_work+0x6ad/0x1230 kernel/workqueue.c:2247
 #2: ffff888041b68d00 (&wdev->mtx){+.+.}-{3:3}, at: sdata_lock net/mac80211/ieee80211_i.h:1021 [inline]
 #2: ffff888041b68d00 (&wdev->mtx){+.+.}-{3:3}, at: ieee80211_ibss_work+0x8d/0xcc0 net/mac80211/ibss.c:1683
 #3: ffffffff8aa0d940 (rcu_read_lock){....}-{1:2}, at: sta_info_insert_finish net/mac80211/sta_info.c:644 [inline]
 #3: ffffffff8aa0d940 (rcu_read_lock){....}-{1:2}, at: sta_info_insert_rcu+0x5a1/0x2700 net/mac80211/sta_info.c:732
Preemption disabled at:
[<ffffffff8855e73f>] __mutex_lock_common kernel/locking/mutex.c:955 [inline]
[<ffffffff8855e73f>] __mutex_lock+0x10f/0x1210 kernel/locking/mutex.c:1103
CPU: 0 PID: 1027 Comm: kworker/u4:7 Not tainted 5.10.0-rc3-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
Workqueue: phy16 ieee80211_iface_work
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x9a/0xcc lib/dump_stack.c:118
 ___might_sleep.cold+0x65/0x79 kernel/sched/core.c:7298
 sta_info_move_state+0x2b/0x9d0 net/mac80211/sta_info.c:1962
 sta_info_free+0x5c/0x340 net/mac80211/sta_info.c:274
 sta_info_insert_rcu+0x2a5/0x2700 net/mac80211/sta_info.c:738
 ieee80211_ibss_finish_sta+0x1af/0x2d0 net/mac80211/ibss.c:592
 ieee80211_ibss_work+0x265/0xcc0 net/mac80211/ibss.c:1700
 process_one_work+0x75b/0x1230 kernel/workqueue.c:2272
 worker_thread+0x598/0xf80 kernel/workqueue.c:2418
 kthread+0x36d/0x450 kernel/kthread.c:292
 ret_from_fork+0x1f/0x30 arch/x86/entry/entry_64.S:296

=============================
[ BUG: Invalid wait context ]
5.10.0-rc3-syzkaller #0 Tainted: G        W        
-----------------------------
kworker/u4:7/1027 is trying to lock:
ffff888041b429d0 (&local->chanctx_mtx){+.+.}-{3:3}, at: ieee80211_recalc_min_chandef+0x43/0x100 net/mac80211/util.c:2740
other info that might help us debug this:
context-{4:4}
4 locks held by kworker/u4:7/1027:
 #0: ffff888033332938 ((wq_completion)phy16){+.+.}-{0:0}, at: arch_atomic64_set arch/x86/include/asm/atomic64_64.h:34 [inline]
 #0: ffff888033332938 ((wq_completion)phy16){+.+.}-{0:0}, at: atomic64_set include/asm-generic/atomic-instrumented.h:856 [inline]
 #0: ffff888033332938 ((wq_completion)phy16){+.+.}-{0:0}, at: atomic_long_set include/asm-generic/atomic-long.h:41 [inline]
 #0: ffff888033332938 ((wq_completion)phy16){+.+.}-{0:0}, at: set_work_data kernel/workqueue.c:616 [inline]
 #0: ffff888033332938 ((wq_completion)phy16){+.+.}-{0:0}, at: set_work_pool_and_clear_pending kernel/workqueue.c:643 [inline]
 #0: ffff888033332938 ((wq_completion)phy16){+.+.}-{0:0}, at: process_one_work+0x680/0x1230 kernel/workqueue.c:2243
 #1: ffffc9000476fdb0 ((work_completion)(&sdata->work)){+.+.}-{0:0}, at: process_one_work+0x6ad/0x1230 kernel/workqueue.c:2247
 #2: ffff888041b68d00 (&wdev->mtx){+.+.}-{3:3}, at: sdata_lock net/mac80211/ieee80211_i.h:1021 [inline]
 #2: ffff888041b68d00 (&wdev->mtx){+.+.}-{3:3}, at: ieee80211_ibss_work+0x8d/0xcc0 net/mac80211/ibss.c:1683
 #3: ffffffff8aa0d940 (rcu_read_lock){....}-{1:2}, at: sta_info_insert_finish net/mac80211/sta_info.c:644 [inline]
 #3: ffffffff8aa0d940 (rcu_read_lock){....}-{1:2}, at: sta_info_insert_rcu+0x5a1/0x2700 net/mac80211/sta_info.c:732
stack backtrace:
CPU: 1 PID: 1027 Comm: kworker/u4:7 Tainted: G        W         5.10.0-rc3-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
Workqueue: phy16 ieee80211_iface_work
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x9a/0xcc lib/dump_stack.c:118
 print_lock_invalid_wait_context kernel/locking/lockdep.c:4483 [inline]
 check_wait_context kernel/locking/lockdep.c:4544 [inline]
 __lock_acquire.cold+0x333/0x3cc kernel/locking/lockdep.c:4781
 lock_acquire kernel/locking/lockdep.c:5436 [inline]
 lock_acquire+0x2a3/0x910 kernel/locking/lockdep.c:5401
 __mutex_lock_common kernel/locking/mutex.c:956 [inline]
 __mutex_lock+0x134/0x1210 kernel/locking/mutex.c:1103
 ieee80211_recalc_min_chandef+0x43/0x100 net/mac80211/util.c:2740
 sta_info_move_state+0x140/0x9d0 net/mac80211/sta_info.c:2019
 sta_info_free+0x5c/0x340 net/mac80211/sta_info.c:274
 sta_info_insert_rcu+0x2a5/0x2700 net/mac80211/sta_info.c:738
 ieee80211_ibss_finish_sta+0x1af/0x2d0 net/mac80211/ibss.c:592
 ieee80211_ibss_work+0x265/0xcc0 net/mac80211/ibss.c:1700
 process_one_work+0x75b/0x1230 kernel/workqueue.c:2272
 worker_thread+0x598/0xf80 kernel/workqueue.c:2418
 kthread+0x36d/0x450 kernel/kthread.c:292
 ret_from_fork+0x1f/0x30 arch/x86/entry/entry_64.S:296
BUG: sleeping function called from invalid context at net/mac80211/sta_info.c:1962
in_atomic(): 0, irqs_disabled(): 0, non_block: 0, pid: 1027, name: kworker/u4:7
INFO: lockdep is turned off.
Preemption disabled at:
[<ffffffff8100467d>] preempt_schedule_thunk+0x16/0x18 arch/x86/entry/thunk_64.S:40
CPU: 1 PID: 1027 Comm: kworker/u4:7 Tainted: G        W         5.10.0-rc3-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
Workqueue: phy16 ieee80211_iface_work
Call Trace:
 __dump_stack lib/dump_stack.c:77 [inline]
 dump_stack+0x9a/0xcc lib/dump_stack.c:118
 ___might_sleep.cold+0x65/0x79 kernel/sched/core.c:7298
 sta_info_move_state+0x2b/0x9d0 net/mac80211/sta_info.c:1962
 sta_info_free+0x5c/0x340 net/mac80211/sta_info.c:274
 sta_info_insert_rcu+0x2a5/0x2700 net/mac80211/sta_info.c:738
 ieee80211_ibss_finish_sta+0x1af/0x2d0 net/mac80211/ibss.c:592
 ieee80211_ibss_work+0x265/0xcc0 net/mac80211/ibss.c:1700
 process_one_work+0x75b/0x1230 kernel/workqueue.c:2272
 worker_thread+0x598/0xf80 kernel/workqueue.c:2418
 kthread+0x36d/0x450 kernel/kthread.c:292
 ret_from_fork+0x1f/0x30 arch/x86/entry/entry_64.S:296

