bisecting cause commit starting from d89091a4930ee0d80bee3e259a98513f3a2543ec
building syzkaller on 438e1227121e9d4bbca7b12b6e1b715524d512c2
testing commit d89091a4930ee0d80bee3e259a98513f3a2543ec with gcc (GCC) 8.1.0
kernel signature: 6cf71b7dc0aff6150445596a3c443c89e6e6b371
run #0: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #1: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #2: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #3: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #4: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #5: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #6: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #7: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #8: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #9: crashed: KASAN: use-after-free Read in macvlan_broadcast
testing release v5.4
testing commit 219d54332a09e8d8741c1e1982f5eae56099de85 with gcc (GCC) 8.1.0
kernel signature: 598ca84b352fabe3b64a40842c81ce3d853a9cf9
run #0: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #1: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #2: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #3: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #4: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #5: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #6: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #7: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #8: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #9: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
testing release v5.3
testing commit 4d856f72c10ecb060868ed10ff1b1453943fc6c8 with gcc (GCC) 8.1.0
kernel signature: 7f1965a6e37df6c082ff90e0109a7762fcfe1341
run #0: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #1: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #2: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #3: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #4: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #5: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #6: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #7: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #8: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #9: crashed: KASAN: use-after-free Read in macvlan_broadcast
testing release v5.2
testing commit 0ecfebd2b52404ae0c54a878c872bb93363ada36 with gcc (GCC) 8.1.0
kernel signature: e6b18e33bdad3d7fa6cf547b404fd4f3925733b4
run #0: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #1: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #2: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #3: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #4: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #5: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #6: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #7: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #8: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #9: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
testing release v5.1
testing commit e93c9c99a629c61837d5a7fc2120cd2b6c70dbdd with gcc (GCC) 8.1.0
kernel signature: 450d351a414d36bcee38ecad665dfa8ca3d43755
run #0: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #1: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #2: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #3: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #4: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #5: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #6: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #7: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #8: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #9: crashed: KASAN: use-after-free Read in macvlan_broadcast
testing release v5.0
testing commit 1c163f4c7b3f621efff9b28a47abb36f7378d783 with gcc (GCC) 8.1.0
kernel signature: 0e43acd93d04d5553f15080f03e5fcadcd024d03
run #0: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #1: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #2: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #3: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #4: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #5: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #6: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #7: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #8: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #9: crashed: KASAN: use-after-free Read in macvlan_broadcast
testing release v4.20
testing commit 8fe28cb58bcb235034b64cbbb7550a8a43fd88be with gcc (GCC) 8.1.0
kernel signature: 30a51014b37c5711fc7759561ed9dd91e6489353
run #0: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #1: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #2: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #3: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #4: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #5: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #6: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #7: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #8: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #9: crashed: KASAN: use-after-free Read in macvlan_broadcast
testing release v4.19
testing commit 84df9525b0c27f3ebc2ebb1864fa62a97fdedb7d with gcc (GCC) 8.1.0
kernel signature: 79f4733cd9b8076ec8b150b446336774d802e67b
run #0: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #1: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #2: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #3: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #4: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #5: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #6: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #7: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #8: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #9: crashed: KASAN: use-after-free Read in macvlan_broadcast
testing release v4.18
testing commit 94710cac0ef4ee177a63b5227664b38c95bbf703 with gcc (GCC) 8.1.0
kernel signature: ea0a39d19fc48b11278d848c7dd0c47bfb11341a
run #0: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #1: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #2: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #3: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #4: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #5: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #6: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #7: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #8: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #9: crashed: KASAN: use-after-free Read in macvlan_broadcast
testing release v4.17
testing commit 29dcea88779c856c7dc92040a0c01233263101d4 with gcc (GCC) 8.1.0
kernel signature: 77b987b6686a38d71f42eaa0060ee2b104e1720f
run #0: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #1: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #2: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #3: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #4: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #5: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #6: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #7: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #8: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #9: crashed: KASAN: use-after-free Read in macvlan_broadcast
testing release v4.16
testing commit 0adb32858b0bddf4ada5f364a84ed60b196dbcda with gcc (GCC) 8.1.0
kernel signature: 47fe113cae937a60bbf891e8f47d1f6eef7bca9e
run #0: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #1: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #2: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #3: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #4: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #5: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #6: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #7: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #8: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #9: crashed: KASAN: use-after-free Read in macvlan_broadcast
testing release v4.15
testing commit d8a5b80568a9cb66810e75b182018e9edb68e8ff with gcc (GCC) 8.1.0
kernel signature: 6834f586a433d81aa20e49b9415f55f99e832c7d
run #0: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #1: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #2: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #3: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #4: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #5: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #6: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #7: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #8: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #9: crashed: KASAN: use-after-free Read in macvlan_broadcast
testing release v4.14
testing commit bebc6082da0a9f5d47a1ea2edc099bf671058bd4 with gcc (GCC) 8.1.0
kernel signature: 9015c9aa50ddf0a8e173c4ef25df6fb3d0e2de96
run #0: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #1: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #2: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #3: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #4: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #5: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #6: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #7: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #8: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #9: crashed: KASAN: use-after-free Read in macvlan_broadcast
testing release v4.13
testing commit 569dbb88e80deb68974ef6fdd6a13edb9d686261 with gcc (GCC) 8.1.0
kernel signature: e31df8e0a9a54602f2d4c6d95fe4eb1e508c2f03
run #0: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #1: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #2: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #3: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #4: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #5: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #6: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #7: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #8: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #9: crashed: KASAN: use-after-free Read in macvlan_broadcast
testing release v4.12
testing commit 6f7da290413ba713f0cdd9ff1a2a9bb129ef4f6c with gcc (GCC) 8.1.0
kernel signature: 3d11c34113acd8dba0a56644f88cb08fa4f0884a
run #0: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #1: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #2: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #3: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #4: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #5: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #6: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #7: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #8: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #9: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
testing release v4.11
testing commit a351e9b9fc24e982ec2f0e76379a49826036da12 with gcc (GCC) 7.3.0
kernel signature: ac6ba635f35b3c062591ab381c76d07c2759b386
run #0: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #1: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #2: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #3: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #4: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #5: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #6: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #7: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #8: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #9: crashed: KASAN: use-after-free Read in macvlan_broadcast
testing release v4.10
testing commit c470abd4fde40ea6a0846a2beab642a578c0b8cd with gcc (GCC) 5.5.0
kernel signature: f56d560574113d1490ea93ba64c13f56daf49a73
run #0: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #1: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #2: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #3: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #4: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #5: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #6: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #7: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #8: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #9: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
testing release v4.9
testing commit 69973b830859bc6529a7a0468ba0d80ee5117826 with gcc (GCC) 5.5.0
kernel signature: 39efe5c751a76f38e1f3e49a5e945d5914887a98
run #0: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #1: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #2: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #3: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #4: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #5: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #6: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #7: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #8: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #9: crashed: KASAN: use-after-free Read in macvlan_broadcast
testing release v4.8
testing commit c8d2bc9bc39ebea8437fd974fdbc21847bb897a3 with gcc (GCC) 5.5.0
kernel signature: 808e3ee4a99dcccadd885f5c7d22588d3bf2e307
run #0: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #1: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #2: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #3: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #4: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #5: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #6: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #7: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #8: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #9: crashed: KASAN: use-after-free Read in macvlan_broadcast
testing release v4.7
testing commit 523d939ef98fd712632d93a5a2b588e477a7565e with gcc (GCC) 5.5.0
kernel signature: d07573f9c5e09c2eefe3421de7be96b1a3c22359
run #0: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #1: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #2: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #3: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #4: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #5: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #6: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #7: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #8: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #9: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
testing release v4.6
testing commit 2dcd0af568b0cf583645c8a317dd12e344b1c72a with gcc (GCC) 5.5.0
kernel signature: 1cd43d75cfd0b96bb5ad1821ce219e988f3814e9
run #0: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #1: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #2: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #3: crashed: KASAN: stack-out-of-bounds Read in macvlan_broadcast
run #4: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #5: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #6: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #7: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #8: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #9: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
revisions tested: 21, total time: 2h58m9.862225703s (build: 1h46m15.848093317s, test: 1h9m54.626114157s)
the crash already happened on the oldest tested release
commit msg: Linux 4.6
crash: KASAN: slab-out-of-bounds Read in macvlan_broadcast
IPv6: ADDRCONF(NETDEV_UP): veth1_to_team: link is not ready
IPv6: ADDRCONF(NETDEV_CHANGE): hsr_slave_0: link becomes ready
IPv6: ADDRCONF(NETDEV_CHANGE): hsr_slave_1: link becomes ready
==================================================================
IPv6: ADDRCONF(NETDEV_UP): veth0_virt_wifi: link is not ready
BUG: KASAN: slab-out-of-bounds in __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline] at addr ffff8800ae6c4d01
BUG: KASAN: slab-out-of-bounds in mc_hash drivers/net/macvlan.c:225 [inline] at addr ffff8800ae6c4d01
BUG: KASAN: slab-out-of-bounds in macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251 at addr ffff8800ae6c4d01
Read of size 4 by task syz-executor.2/7685
CPU: 0 PID: 7685 Comm: syz-executor.2 Not tainted 4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0dd577e ffff8800ae7e7878 ffffffff82c7f386 ffff8800ae6c4cff
 ffff8800ae7e7908 ffff8800ae6c4940 ffff88012bc00700 ffff8800ae7e78f8

 ffffffff81740207 ffff8800ae720900 0000000000000286 0000000000000286
Call Trace:
 [<ffffffff82c7f386>] __dump_stack lib/dump_stack.c:15 [inline]
 [<ffffffff82c7f386>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff81740207>] object_err mm/kasan/report.c:139 [inline]
 [<ffffffff81740207>] print_address_description mm/kasan/report.c:179 [inline]
 [<ffffffff81740207>] kasan_report_error+0x1e7/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174089a>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174089a>] __asan_report_load_n_noabort+0x3a/0x40 mm/kasan/report.c:328
 [<ffffffff838f393f>] __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline]
 [<ffffffff838f393f>] mc_hash drivers/net/macvlan.c:225 [inline]
 [<ffffffff838f393f>] macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251
IPv6: ADDRCONF(NETDEV_UP): veth0_vlan: link is not ready
device veth0_vlan entered promiscuous mode
IPv6: ADDRCONF(NETDEV_UP): vlan0: link is not ready
IPv6: ADDRCONF(NETDEV_UP): vlan1: link is not ready
 [<ffffffff838f5206>] macvlan_queue_xmit drivers/net/macvlan.c:482 [inline]
 [<ffffffff838f5206>] macvlan_start_xmit+0x316/0x610 drivers/net/macvlan.c:525
 [<ffffffff8518c379>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff8518c379>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff8518c379>] packet_direct_xmit+0x429/0x610 net/packet/af_packet.c:271
 [<ffffffff851977b4>] packet_snd net/packet/af_packet.c:2938 [inline]
 [<ffffffff851977b4>] packet_sendmsg+0x1f94/0x4eb0 net/packet/af_packet.c:2963
device veth1_vlan entered promiscuous mode
 [<ffffffff8490e2a5>] sock_sendmsg_nosec net/socket.c:612 [inline]
 [<ffffffff8490e2a5>] sock_sendmsg+0xb5/0xf0 net/socket.c:622
 [<ffffffff8490f279>] SYSC_sendto+0x1c9/0x300 net/socket.c:1648
 [<ffffffff84911569>] SyS_sendto+0x9/0x10 net/socket.c:1616
 [<ffffffff85bb80c0>] entry_SYSCALL_64_fastpath+0x23/0xc1
Object at ffff8800ae6c4940, in cache kmalloc-1024
Object allocated with size 704 bytes.
Allocation:
PID = 7371
 [<ffffffff81205056>] save_stack_trace+0x26/0x50 arch/x86/kernel/stacktrace.c:67
 [<ffffffff8173f3e6>] save_stack+0x46/0xd0 mm/kasan/kasan.c:450
 [<ffffffff8173f7a9>] set_track mm/kasan/kasan.c:462 [inline]
 [<ffffffff8173f7a9>] kasan_kmalloc+0xc9/0xe0 mm/kasan/kasan.c:532
 [<ffffffff8173bb09>] __do_kmalloc mm/slab.c:3545 [inline]
 [<ffffffff8173bb09>] __kmalloc+0x169/0x6d0 mm/slab.c:3554
 [<ffffffff849a4aea>] kmalloc include/linux/slab.h:483 [inline]
 [<ffffffff849a4aea>] kzalloc include/linux/slab.h:622 [inline]
 [<ffffffff849a4aea>] neigh_alloc net/core/neighbour.c:285 [inline]
 [<ffffffff849a4aea>] __neigh_create+0x1ea/0x19f0 net/core/neighbour.c:457
 [<ffffffff8502ccc1>] ip6_finish_output2+0x841/0x1b90 net/ipv6/ip6_output.c:111
 [<ffffffff85036723>] ip6_finish_output+0x353/0x700 net/ipv6/ip6_output.c:131
 [<ffffffff85036c37>] NF_HOOK_COND include/linux/netfilter.h:233 [inline]
 [<ffffffff85036c37>] ip6_output+0x167/0x530 net/ipv6/ip6_output.c:145
 [<ffffffff8508ac79>] dst_output include/net/dst.h:504 [inline]
 [<ffffffff8508ac79>] NF_HOOK_THRESH.constprop.24+0xc9/0x290 include/linux/netfilter.h:219
 [<ffffffff8508b7c4>] NF_HOOK include/linux/netfilter.h:242 [inline]
 [<ffffffff8508b7c4>] ndisc_send_skb+0x7a4/0x1010 net/ipv6/ndisc.c:471
 [<ffffffff85090046>] ndisc_send_rs+0x116/0x3d0 net/ipv6/ndisc.c:646
 [<ffffffff85055709>] addrconf_dad_completed+0x419/0x760 net/ipv6/addrconf.c:3877
 [<ffffffff8505621b>] addrconf_dad_work+0x7cb/0x980 net/ipv6/addrconf.c:3800
 [<ffffffff8139210b>] process_one_work+0x69b/0x1570 kernel/workqueue.c:2122
 [<ffffffff813930b7>] worker_thread+0xd7/0xf10 kernel/workqueue.c:2256
 [<ffffffff813a3a09>] kthread+0x209/0x2d0 kernel/kthread.c:209
 [<ffffffff85bb8312>] ret_from_fork+0x22/0x50 arch/x86/entry/entry_64.S:392
Memory state around the buggy address:
 ffff8800ae6c4c00: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
 ffff8800ae6c4c80: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
>ffff8800ae6c4d00: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
                   ^
 ffff8800ae6c4d80: fc fc fc fc fc fc fc fc 00 00 00 00 00 00 00 00
 ffff8800ae6c4e00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
==================================================================
IPv6: ADDRCONF(NETDEV_CHANGE): veth0_virt_wifi: link becomes ready
IPv6: ADDRCONF(NETDEV_CHANGE): veth0_vlan: link becomes ready
==================================================================
BUG: KASAN: slab-out-of-bounds in __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline] at addr ffff8800ae6c5ac1
BUG: KASAN: slab-out-of-bounds in mc_hash drivers/net/macvlan.c:225 [inline] at addr ffff8800ae6c5ac1
BUG: KASAN: slab-out-of-bounds in macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251 at addr ffff8800ae6c5ac1
Read of size 4 by task syz-executor.2/7728
CPU: 1 PID: 7728 Comm: syz-executor.2 Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0dd577e ffff8800ae7a7878 ffffffff82c7f386 ffff8800ae6c5abf
 ffff8800ae7a7908 ffff8800ae6c56c0 ffff88012bc00700 ffff8800ae7a78f8
 ffffffff81740207 ffffffff816afd26 0000000000000286 0000000000000286
Call Trace:
 [<ffffffff82c7f386>] __dump_stack lib/dump_stack.c:15 [inline]
 [<ffffffff82c7f386>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff81740207>] object_err mm/kasan/report.c:139 [inline]
 [<ffffffff81740207>] print_address_description mm/kasan/report.c:179 [inline]
 [<ffffffff81740207>] kasan_report_error+0x1e7/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174089a>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174089a>] __asan_report_load_n_noabort+0x3a/0x40 mm/kasan/report.c:328
 [<ffffffff838f393f>] __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline]
 [<ffffffff838f393f>] mc_hash drivers/net/macvlan.c:225 [inline]
 [<ffffffff838f393f>] macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251
 [<ffffffff838f5206>] macvlan_queue_xmit drivers/net/macvlan.c:482 [inline]
 [<ffffffff838f5206>] macvlan_start_xmit+0x316/0x610 drivers/net/macvlan.c:525
 [<ffffffff8518c379>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff8518c379>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff8518c379>] packet_direct_xmit+0x429/0x610 net/packet/af_packet.c:271
 [<ffffffff851977b4>] packet_snd net/packet/af_packet.c:2938 [inline]
 [<ffffffff851977b4>] packet_sendmsg+0x1f94/0x4eb0 net/packet/af_packet.c:2963
 [<ffffffff8490e2a5>] sock_sendmsg_nosec net/socket.c:612 [inline]
 [<ffffffff8490e2a5>] sock_sendmsg+0xb5/0xf0 net/socket.c:622
 [<ffffffff8490f279>] SYSC_sendto+0x1c9/0x300 net/socket.c:1648
 [<ffffffff84911569>] SyS_sendto+0x9/0x10 net/socket.c:1616
 [<ffffffff85bb80c0>] entry_SYSCALL_64_fastpath+0x23/0xc1
Object at ffff8800ae6c56c0, in cache kmalloc-1024
Object allocated with size 704 bytes.
Allocation:
PID = 7371
 [<ffffffff81205056>] save_stack_trace+0x26/0x50 arch/x86/kernel/stacktrace.c:67
 [<ffffffff8173f3e6>] save_stack+0x46/0xd0 mm/kasan/kasan.c:450
 [<ffffffff8173f7a9>] set_track mm/kasan/kasan.c:462 [inline]
 [<ffffffff8173f7a9>] kasan_kmalloc+0xc9/0xe0 mm/kasan/kasan.c:532
 [<ffffffff8173bb09>] __do_kmalloc mm/slab.c:3545 [inline]
 [<ffffffff8173bb09>] __kmalloc+0x169/0x6d0 mm/slab.c:3554
 [<ffffffff849a4aea>] kmalloc include/linux/slab.h:483 [inline]
 [<ffffffff849a4aea>] kzalloc include/linux/slab.h:622 [inline]
 [<ffffffff849a4aea>] neigh_alloc net/core/neighbour.c:285 [inline]
 [<ffffffff849a4aea>] __neigh_create+0x1ea/0x19f0 net/core/neighbour.c:457
 [<ffffffff8502ccc1>] ip6_finish_output2+0x841/0x1b90 net/ipv6/ip6_output.c:111
 [<ffffffff85036723>] ip6_finish_output+0x353/0x700 net/ipv6/ip6_output.c:131
 [<ffffffff85036c37>] NF_HOOK_COND include/linux/netfilter.h:233 [inline]
 [<ffffffff85036c37>] ip6_output+0x167/0x530 net/ipv6/ip6_output.c:145
 [<ffffffff8508ac79>] dst_output include/net/dst.h:504 [inline]
 [<ffffffff8508ac79>] NF_HOOK_THRESH.constprop.24+0xc9/0x290 include/linux/netfilter.h:219
 [<ffffffff8508b7c4>] NF_HOOK include/linux/netfilter.h:242 [inline]
 [<ffffffff8508b7c4>] ndisc_send_skb+0x7a4/0x1010 net/ipv6/ndisc.c:471
 [<ffffffff85090046>] ndisc_send_rs+0x116/0x3d0 net/ipv6/ndisc.c:646
 [<ffffffff85055709>] addrconf_dad_completed+0x419/0x760 net/ipv6/addrconf.c:3877
 [<ffffffff85055d5b>] addrconf_dad_begin net/ipv6/addrconf.c:3687 [inline]
 [<ffffffff85055d5b>] addrconf_dad_work+0x30b/0x980 net/ipv6/addrconf.c:3768
 [<ffffffff8139210b>] process_one_work+0x69b/0x1570 kernel/workqueue.c:2122
 [<ffffffff813930b7>] worker_thread+0xd7/0xf10 kernel/workqueue.c:2256
 [<ffffffff813a3a09>] kthread+0x209/0x2d0 kernel/kthread.c:209
 [<ffffffff85bb8312>] ret_from_fork+0x22/0x50 arch/x86/entry/entry_64.S:392
Memory state around the buggy address:
 ffff8800ae6c5980: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
 ffff8800ae6c5a00: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
>ffff8800ae6c5a80: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
                                           ^
 ffff8800ae6c5b00: fc fc fc fc fc fc fc fc 00 00 00 00 00 00 00 00
 ffff8800ae6c5b80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
==================================================================
==================================================================
BUG: KASAN: use-after-free in __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline] at addr ffff880127aaa581
BUG: KASAN: use-after-free in mc_hash drivers/net/macvlan.c:225 [inline] at addr ffff880127aaa581
BUG: KASAN: use-after-free in macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251 at addr ffff880127aaa581
Read of size 4 by task syz-executor.1/7760
page:ffffea00049eaa80 count:0 mapcount:0 mapping:          (null) index:0x0
flags: 0x17ffe0000000000()
page dumped because: kasan: bad access detected
CPU: 0 PID: 7760 Comm: syz-executor.1 Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0dd577e ffff8800ae1a7878 ffffffff82c7f386 ffff880127aaa57f
 ffff8800ae1a7908 ffff880127aaa581 ffff8800b224a600 ffff8800ae1a78f8
 ffffffff817405ba ffffffff816afd26 0000000000000286 0000000000000286
Call Trace:
 [<ffffffff82c7f386>] __dump_stack lib/dump_stack.c:15 [inline]
 [<ffffffff82c7f386>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff817405ba>] print_address_description mm/kasan/report.c:190 [inline]
 [<ffffffff817405ba>] kasan_report_error+0x59a/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174089a>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174089a>] __asan_report_load_n_noabort+0x3a/0x40 mm/kasan/report.c:328
 [<ffffffff838f393f>] __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline]
 [<ffffffff838f393f>] mc_hash drivers/net/macvlan.c:225 [inline]
 [<ffffffff838f393f>] macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251
 [<ffffffff838f5206>] macvlan_queue_xmit drivers/net/macvlan.c:482 [inline]
 [<ffffffff838f5206>] macvlan_start_xmit+0x316/0x610 drivers/net/macvlan.c:525
 [<ffffffff8518c379>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff8518c379>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff8518c379>] packet_direct_xmit+0x429/0x610 net/packet/af_packet.c:271
 [<ffffffff851977b4>] packet_snd net/packet/af_packet.c:2938 [inline]
 [<ffffffff851977b4>] packet_sendmsg+0x1f94/0x4eb0 net/packet/af_packet.c:2963
 [<ffffffff8490e2a5>] sock_sendmsg_nosec net/socket.c:612 [inline]
 [<ffffffff8490e2a5>] sock_sendmsg+0xb5/0xf0 net/socket.c:622
 [<ffffffff8490f279>] SYSC_sendto+0x1c9/0x300 net/socket.c:1648
 [<ffffffff84911569>] SyS_sendto+0x9/0x10 net/socket.c:1616
 [<ffffffff85bb80c0>] entry_SYSCALL_64_fastpath+0x23/0xc1
Memory state around the buggy address:
 ffff880127aaa480: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff880127aaa500: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
>ffff880127aaa580: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
                   ^
 ffff880127aaa600: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff880127aaa680: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
==================================================================
==================================================================
BUG: KASAN: use-after-free in __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline] at addr ffff880127aaaa81
BUG: KASAN: use-after-free in mc_hash drivers/net/macvlan.c:225 [inline] at addr ffff880127aaaa81
BUG: KASAN: use-after-free in macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251 at addr ffff880127aaaa81
Read of size 4 by task syz-executor.4/7761
page:ffffea00049eaa80 count:0 mapcount:0 mapping:          (null) index:0x0
flags: 0x17ffe0000000000()
page dumped because: kasan: bad access detected
CPU: 0 PID: 7761 Comm: syz-executor.4 Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0dd577e ffff8800ae00f878 ffffffff82c7f386 ffff880127aaaa7f
 ffff8800ae00f908 ffff880127aaaa81 ffff880127882440 ffff8800ae00f8f8
 ffffffff817405ba ffffffff816afd26 0000000000000286 0000000000000286
Call Trace:
 [<ffffffff82c7f386>] __dump_stack lib/dump_stack.c:15 [inline]
 [<ffffffff82c7f386>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff817405ba>] print_address_description mm/kasan/report.c:190 [inline]
 [<ffffffff817405ba>] kasan_report_error+0x59a/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174089a>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174089a>] __asan_report_load_n_noabort+0x3a/0x40 mm/kasan/report.c:328
 [<ffffffff838f393f>] __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline]
 [<ffffffff838f393f>] mc_hash drivers/net/macvlan.c:225 [inline]
 [<ffffffff838f393f>] macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251
 [<ffffffff838f5206>] macvlan_queue_xmit drivers/net/macvlan.c:482 [inline]
 [<ffffffff838f5206>] macvlan_start_xmit+0x316/0x610 drivers/net/macvlan.c:525
 [<ffffffff8518c379>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff8518c379>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff8518c379>] packet_direct_xmit+0x429/0x610 net/packet/af_packet.c:271
 [<ffffffff851977b4>] packet_snd net/packet/af_packet.c:2938 [inline]
 [<ffffffff851977b4>] packet_sendmsg+0x1f94/0x4eb0 net/packet/af_packet.c:2963
 [<ffffffff8490e2a5>] sock_sendmsg_nosec net/socket.c:612 [inline]
 [<ffffffff8490e2a5>] sock_sendmsg+0xb5/0xf0 net/socket.c:622
 [<ffffffff8490f279>] SYSC_sendto+0x1c9/0x300 net/socket.c:1648
 [<ffffffff84911569>] SyS_sendto+0x9/0x10 net/socket.c:1616
 [<ffffffff85bb80c0>] entry_SYSCALL_64_fastpath+0x23/0xc1
Memory state around the buggy address:
 ffff880127aaa980: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff880127aaaa00: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
>ffff880127aaaa80: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
                   ^
 ffff880127aaab00: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff880127aaab80: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
==================================================================
IPv6: ADDRCONF(NETDEV_CHANGE): vlan0: link becomes ready
IPv6: ADDRCONF(NETDEV_CHANGE): vlan1: link becomes ready
IPv6: ADDRCONF(NETDEV_UP): veth0_virt_wifi: link is not ready
IPv6: ADDRCONF(NETDEV_CHANGE): veth0_virt_wifi: link becomes ready
IPv6: ADDRCONF(NETDEV_UP): veth0_virt_wifi: link is not ready
IPv6: ADDRCONF(NETDEV_CHANGE): veth0_virt_wifi: link becomes ready
IPv6: ADDRCONF(NETDEV_UP): veth0_vlan: link is not ready
device veth0_vlan entered promiscuous mode
IPv6: ADDRCONF(NETDEV_UP): vlan0: link is not ready
IPv6: ADDRCONF(NETDEV_UP): vlan1: link is not ready
IPv6: ADDRCONF(NETDEV_UP): veth0_virt_wifi: link is not ready
IPv6: ADDRCONF(NETDEV_UP): veth0_vlan: link is not ready
device veth0_vlan entered promiscuous mode
IPv6: ADDRCONF(NETDEV_UP): vlan0: link is not ready
IPv6: ADDRCONF(NETDEV_UP): vlan1: link is not ready
IPv6: ADDRCONF(NETDEV_CHANGE): veth0_vlan: link becomes ready
IPv6: ADDRCONF(NETDEV_CHANGE): vlan0: link becomes ready
IPv6: ADDRCONF(NETDEV_CHANGE): vlan1: link becomes ready
device veth1_vlan entered promiscuous mode
IPv6: ADDRCONF(NETDEV_CHANGE): veth0_virt_wifi: link becomes ready
IPv6: ADDRCONF(NETDEV_CHANGE): veth0_vlan: link becomes ready
IPv6: ADDRCONF(NETDEV_CHANGE): vlan0: link becomes ready
IPv6: ADDRCONF(NETDEV_CHANGE): vlan1: link becomes ready
device veth1_vlan entered promiscuous mode
IPv6: ADDRCONF(NETDEV_UP): veth0_vlan: link is not ready
device veth0_vlan entered promiscuous mode
IPv6: ADDRCONF(NETDEV_UP): vlan0: link is not ready
IPv6: ADDRCONF(NETDEV_UP): vlan1: link is not ready
IPv6: ADDRCONF(NETDEV_CHANGE): veth0_vlan: link becomes ready
IPv6: ADDRCONF(NETDEV_CHANGE): vlan0: link becomes ready
IPv6: ADDRCONF(NETDEV_CHANGE): vlan1: link becomes ready
device veth1_vlan entered promiscuous mode
==================================================================
BUG: KASAN: use-after-free in __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline] at addr ffff8800ae0bdcc1
BUG: KASAN: use-after-free in mc_hash drivers/net/macvlan.c:225 [inline] at addr ffff8800ae0bdcc1
BUG: KASAN: use-after-free in macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251 at addr ffff8800ae0bdcc1
Read of size 4 by task syz-executor.0/7840
page:ffffea0002b82f40 count:0 mapcount:0 mapping:          (null) index:0x0
flags: 0xfffe0000000000()
page dumped because: kasan: bad access detected
CPU: 0 PID: 7840 Comm: syz-executor.0 Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0dd577e ffff8800ae10f878 ffffffff82c7f386 ffff8800ae0bdcbf
 ffff8800ae10f908 ffff8800ae0bdcc1 ffff8800ae526740 ffff8800ae10f8f8
 ffffffff817405ba ffffffff816afd26 0000000000000286 0000000000000286
Call Trace:
 [<ffffffff82c7f386>] __dump_stack lib/dump_stack.c:15 [inline]
 [<ffffffff82c7f386>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff817405ba>] print_address_description mm/kasan/report.c:190 [inline]
 [<ffffffff817405ba>] kasan_report_error+0x59a/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174089a>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174089a>] __asan_report_load_n_noabort+0x3a/0x40 mm/kasan/report.c:328
 [<ffffffff838f393f>] __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline]
 [<ffffffff838f393f>] mc_hash drivers/net/macvlan.c:225 [inline]
 [<ffffffff838f393f>] macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251
 [<ffffffff838f5206>] macvlan_queue_xmit drivers/net/macvlan.c:482 [inline]
 [<ffffffff838f5206>] macvlan_start_xmit+0x316/0x610 drivers/net/macvlan.c:525
 [<ffffffff8518c379>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff8518c379>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff8518c379>] packet_direct_xmit+0x429/0x610 net/packet/af_packet.c:271
 [<ffffffff851977b4>] packet_snd net/packet/af_packet.c:2938 [inline]
 [<ffffffff851977b4>] packet_sendmsg+0x1f94/0x4eb0 net/packet/af_packet.c:2963
 [<ffffffff8490e2a5>] sock_sendmsg_nosec net/socket.c:612 [inline]
 [<ffffffff8490e2a5>] sock_sendmsg+0xb5/0xf0 net/socket.c:622
 [<ffffffff8490f279>] SYSC_sendto+0x1c9/0x300 net/socket.c:1648
 [<ffffffff84911569>] SyS_sendto+0x9/0x10 net/socket.c:1616
 [<ffffffff85bb80c0>] entry_SYSCALL_64_fastpath+0x23/0xc1
Memory state around the buggy address:
 ffff8800ae0bdb80: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8800ae0bdc00: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
>ffff8800ae0bdc80: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
                                           ^
 ffff8800ae0bdd00: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8800ae0bdd80: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
==================================================================
==================================================================
BUG: KASAN: use-after-free in __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline] at addr ffff8800ae6c4581
BUG: KASAN: use-after-free in mc_hash drivers/net/macvlan.c:225 [inline] at addr ffff8800ae6c4581
BUG: KASAN: use-after-free in macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251 at addr ffff8800ae6c4581
Read of size 4 by task syz-executor.4/7858
page:ffffea0002b9b100 count:0 mapcount:0 mapping:          (null) index:0x0
flags: 0xfffe0000000000()
page dumped because: kasan: bad access detected
CPU: 0 PID: 7858 Comm: syz-executor.4 Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0dd577e ffff8800ae10f878 ffffffff82c7f386 ffff8800ae6c457f
 ffff8800ae10f908 ffff8800ae6c4581 ffff880127882440 ffff8800ae10f8f8
 ffffffff817405ba ffffffff816afd26 0000000000000286 0000000000000286
Call Trace:
 [<ffffffff82c7f386>] __dump_stack lib/dump_stack.c:15 [inline]
 [<ffffffff82c7f386>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff817405ba>] print_address_description mm/kasan/report.c:190 [inline]
 [<ffffffff817405ba>] kasan_report_error+0x59a/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174089a>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174089a>] __asan_report_load_n_noabort+0x3a/0x40 mm/kasan/report.c:328
 [<ffffffff838f393f>] __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline]
 [<ffffffff838f393f>] mc_hash drivers/net/macvlan.c:225 [inline]
 [<ffffffff838f393f>] macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251
 [<ffffffff838f5206>] macvlan_queue_xmit drivers/net/macvlan.c:482 [inline]
 [<ffffffff838f5206>] macvlan_start_xmit+0x316/0x610 drivers/net/macvlan.c:525
 [<ffffffff8518c379>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff8518c379>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff8518c379>] packet_direct_xmit+0x429/0x610 net/packet/af_packet.c:271
 [<ffffffff851977b4>] packet_snd net/packet/af_packet.c:2938 [inline]
 [<ffffffff851977b4>] packet_sendmsg+0x1f94/0x4eb0 net/packet/af_packet.c:2963
 [<ffffffff8490e2a5>] sock_sendmsg_nosec net/socket.c:612 [inline]
 [<ffffffff8490e2a5>] sock_sendmsg+0xb5/0xf0 net/socket.c:622
 [<ffffffff8490f279>] SYSC_sendto+0x1c9/0x300 net/socket.c:1648
 [<ffffffff84911569>] SyS_sendto+0x9/0x10 net/socket.c:1616
 [<ffffffff85bb80c0>] entry_SYSCALL_64_fastpath+0x23/0xc1
Memory state around the buggy address:
 ffff8800ae6c4480: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8800ae6c4500: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
>ffff8800ae6c4580: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
                   ^
 ffff8800ae6c4600: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8800ae6c4680: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
==================================================================
==================================================================
BUG: KASAN: use-after-free in __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline] at addr ffff8800ae6c4a81
BUG: KASAN: use-after-free in mc_hash drivers/net/macvlan.c:225 [inline] at addr ffff8800ae6c4a81
BUG: KASAN: use-after-free in macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251 at addr ffff8800ae6c4a81
Read of size 4 by task syz-executor.5/7885
page:ffffea0002b9b100 count:0 mapcount:0 mapping:          (null) index:0x0
flags: 0xfffe0000000000()
page dumped because: kasan: bad access detected
CPU: 1 PID: 7885 Comm: syz-executor.5 Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0dd577e ffff8800ae0c7878 ffffffff82c7f386 ffff8800ae6c4a7f
 ffff8800ae0c7908 ffff8800ae6c4a81 ffff8800ae4326c0 ffff8800ae0c78f8
 ffffffff817405ba ffffffff816afd26 0000000000000286 0000000000000286
Call Trace:
 [<ffffffff82c7f386>] __dump_stack lib/dump_stack.c:15 [inline]
 [<ffffffff82c7f386>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff817405ba>] print_address_description mm/kasan/report.c:190 [inline]
 [<ffffffff817405ba>] kasan_report_error+0x59a/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174089a>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174089a>] __asan_report_load_n_noabort+0x3a/0x40 mm/kasan/report.c:328
 [<ffffffff838f393f>] __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline]
 [<ffffffff838f393f>] mc_hash drivers/net/macvlan.c:225 [inline]
 [<ffffffff838f393f>] macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251
 [<ffffffff838f5206>] macvlan_queue_xmit drivers/net/macvlan.c:482 [inline]
 [<ffffffff838f5206>] macvlan_start_xmit+0x316/0x610 drivers/net/macvlan.c:525
 [<ffffffff8518c379>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff8518c379>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff8518c379>] packet_direct_xmit+0x429/0x610 net/packet/af_packet.c:271
 [<ffffffff851977b4>] packet_snd net/packet/af_packet.c:2938 [inline]
 [<ffffffff851977b4>] packet_sendmsg+0x1f94/0x4eb0 net/packet/af_packet.c:2963
 [<ffffffff8490e2a5>] sock_sendmsg_nosec net/socket.c:612 [inline]
 [<ffffffff8490e2a5>] sock_sendmsg+0xb5/0xf0 net/socket.c:622
 [<ffffffff8490f279>] SYSC_sendto+0x1c9/0x300 net/socket.c:1648
 [<ffffffff84911569>] SyS_sendto+0x9/0x10 net/socket.c:1616
 [<ffffffff85bb80c0>] entry_SYSCALL_64_fastpath+0x23/0xc1
Memory state around the buggy address:
 ffff8800ae6c4980: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8800ae6c4a00: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
>ffff8800ae6c4a80: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
                   ^
 ffff8800ae6c4b00: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8800ae6c4b80: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
==================================================================
==================================================================
BUG: KASAN: use-after-free in __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline] at addr ffff880127a5e041
BUG: KASAN: use-after-free in mc_hash drivers/net/macvlan.c:225 [inline] at addr ffff880127a5e041
BUG: KASAN: use-after-free in macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251 at addr ffff880127a5e041
Read of size 4 by task syz-executor.4/7893
page:ffffea00049e9780 count:0 mapcount:0 mapping:          (null) index:0x0
flags: 0x17ffe0000000000()
page dumped because: kasan: bad access detected
CPU: 0 PID: 7893 Comm: syz-executor.4 Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0dd577e ffff880127b6f878 ffffffff82c7f386 ffff880127a5e03f
 ffff880127b6f908 ffff880127a5e041 ffff880127882440 ffff880127b6f8f8
 ffffffff817405ba ffffffff816afd26 0000000000000286 0000000000000286
Call Trace:
 [<ffffffff82c7f386>] __dump_stack lib/dump_stack.c:15 [inline]
 [<ffffffff82c7f386>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff817405ba>] print_address_description mm/kasan/report.c:190 [inline]
 [<ffffffff817405ba>] kasan_report_error+0x59a/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174089a>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174089a>] __asan_report_load_n_noabort+0x3a/0x40 mm/kasan/report.c:328
 [<ffffffff838f393f>] __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline]
 [<ffffffff838f393f>] mc_hash drivers/net/macvlan.c:225 [inline]
 [<ffffffff838f393f>] macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251
 [<ffffffff838f5206>] macvlan_queue_xmit drivers/net/macvlan.c:482 [inline]
 [<ffffffff838f5206>] macvlan_start_xmit+0x316/0x610 drivers/net/macvlan.c:525
 [<ffffffff8518c379>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff8518c379>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff8518c379>] packet_direct_xmit+0x429/0x610 net/packet/af_packet.c:271
 [<ffffffff851977b4>] packet_snd net/packet/af_packet.c:2938 [inline]
 [<ffffffff851977b4>] packet_sendmsg+0x1f94/0x4eb0 net/packet/af_packet.c:2963
 [<ffffffff8490e2a5>] sock_sendmsg_nosec net/socket.c:612 [inline]
 [<ffffffff8490e2a5>] sock_sendmsg+0xb5/0xf0 net/socket.c:622
 [<ffffffff8490f279>] SYSC_sendto+0x1c9/0x300 net/socket.c:1648
 [<ffffffff84911569>] SyS_sendto+0x9/0x10 net/socket.c:1616
 [<ffffffff85bb80c0>] entry_SYSCALL_64_fastpath+0x23/0xc1
Memory state around the buggy address:
 ffff880127a5df00: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff880127a5df80: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
>ffff880127a5e000: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
                                           ^
 ffff880127a5e080: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff880127a5e100: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
==================================================================
==================================================================
BUG: KASAN: use-after-free in __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline] at addr ffff880127a5e541
BUG: KASAN: use-after-free in mc_hash drivers/net/macvlan.c:225 [inline] at addr ffff880127a5e541
BUG: KASAN: use-after-free in macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251 at addr ffff880127a5e541
Read of size 4 by task syz-executor.5/7908
page:ffffea00049e9780 count:0 mapcount:0 mapping:          (null) index:0x0
flags: 0x17ffe0000000000()
page dumped because: kasan: bad access detected
CPU: 0 PID: 7908 Comm: syz-executor.5 Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0dd577e ffff8800ae07f878 ffffffff82c7f386 ffff880127a5e53f
 ffff8800ae07f908 ffff880127a5e541 ffff8800ae4326c0 ffff8800ae07f8f8
 ffffffff817405ba ffffffff816afd26 0000000000000286 0000000000000286
Call Trace:
 [<ffffffff82c7f386>] __dump_stack lib/dump_stack.c:15 [inline]
 [<ffffffff82c7f386>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff817405ba>] print_address_description mm/kasan/report.c:190 [inline]
 [<ffffffff817405ba>] kasan_report_error+0x59a/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174089a>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174089a>] __asan_report_load_n_noabort+0x3a/0x40 mm/kasan/report.c:328
 [<ffffffff838f393f>] __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline]
 [<ffffffff838f393f>] mc_hash drivers/net/macvlan.c:225 [inline]
 [<ffffffff838f393f>] macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251
 [<ffffffff838f5206>] macvlan_queue_xmit drivers/net/macvlan.c:482 [inline]
 [<ffffffff838f5206>] macvlan_start_xmit+0x316/0x610 drivers/net/macvlan.c:525
 [<ffffffff8518c379>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff8518c379>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff8518c379>] packet_direct_xmit+0x429/0x610 net/packet/af_packet.c:271
 [<ffffffff851977b4>] packet_snd net/packet/af_packet.c:2938 [inline]
 [<ffffffff851977b4>] packet_sendmsg+0x1f94/0x4eb0 net/packet/af_packet.c:2963
 [<ffffffff8490e2a5>] sock_sendmsg_nosec net/socket.c:612 [inline]
 [<ffffffff8490e2a5>] sock_sendmsg+0xb5/0xf0 net/socket.c:622
 [<ffffffff8490f279>] SYSC_sendto+0x1c9/0x300 net/socket.c:1648
 [<ffffffff84911569>] SyS_sendto+0x9/0x10 net/socket.c:1616
 [<ffffffff85bb80c0>] entry_SYSCALL_64_fastpath+0x23/0xc1
Memory state around the buggy address:
 ffff880127a5e400: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff880127a5e480: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
>ffff880127a5e500: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
                                           ^
 ffff880127a5e580: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff880127a5e600: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
==================================================================
==================================================================
BUG: KASAN: use-after-free in __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline] at addr ffff880127a5e541
BUG: KASAN: use-after-free in mc_hash drivers/net/macvlan.c:225 [inline] at addr ffff880127a5e541
BUG: KASAN: use-after-free in macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251 at addr ffff880127a5e541
Read of size 4 by task syz-executor.1/7926
page:ffffea00049e9780 count:0 mapcount:0 mapping:          (null) index:0x0
flags: 0x17ffe0000000000()
page dumped because: kasan: bad access detected
CPU: 1 PID: 7926 Comm: syz-executor.1 Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0dd577e ffff880127ac7878 ffffffff82c7f386 ffff880127a5e53f
 ffff880127ac7908 ffff880127a5e541 ffff8800b224a600 ffff880127ac78f8
 ffffffff817405ba ffffffff816afd26 0000000000000286 0000000000000286
Call Trace:
 [<ffffffff82c7f386>] __dump_stack lib/dump_stack.c:15 [inline]
 [<ffffffff82c7f386>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff817405ba>] print_address_description mm/kasan/report.c:190 [inline]
 [<ffffffff817405ba>] kasan_report_error+0x59a/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174089a>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174089a>] __asan_report_load_n_noabort+0x3a/0x40 mm/kasan/report.c:328
 [<ffffffff838f393f>] __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline]
 [<ffffffff838f393f>] mc_hash drivers/net/macvlan.c:225 [inline]
 [<ffffffff838f393f>] macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251
 [<ffffffff838f5206>] macvlan_queue_xmit drivers/net/macvlan.c:482 [inline]
 [<ffffffff838f5206>] macvlan_start_xmit+0x316/0x610 drivers/net/macvlan.c:525
 [<ffffffff8518c379>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff8518c379>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff8518c379>] packet_direct_xmit+0x429/0x610 net/packet/af_packet.c:271
 [<ffffffff851977b4>] packet_snd net/packet/af_packet.c:2938 [inline]
 [<ffffffff851977b4>] packet_sendmsg+0x1f94/0x4eb0 net/packet/af_packet.c:2963
 [<ffffffff8490e2a5>] sock_sendmsg_nosec net/socket.c:612 [inline]
 [<ffffffff8490e2a5>] sock_sendmsg+0xb5/0xf0 net/socket.c:622
 [<ffffffff8490f279>] SYSC_sendto+0x1c9/0x300 net/socket.c:1648
 [<ffffffff84911569>] SyS_sendto+0x9/0x10 net/socket.c:1616
 [<ffffffff85bb80c0>] entry_SYSCALL_64_fastpath+0x23/0xc1
Memory state around the buggy address:
 ffff880127a5e400: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff880127a5e480: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
>ffff880127a5e500: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
                                           ^
 ffff880127a5e580: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff880127a5e600: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
==================================================================
==================================================================
BUG: KASAN: use-after-free in __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline] at addr ffff880127a5e541
BUG: KASAN: use-after-free in mc_hash drivers/net/macvlan.c:225 [inline] at addr ffff880127a5e541
BUG: KASAN: use-after-free in macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251 at addr ffff880127a5e541
Read of size 4 by task syz-executor.5/7937
page:ffffea00049e9780 count:0 mapcount:0 mapping:          (null) index:0x0
flags: 0x17ffe0000000000()
page dumped because: kasan: bad access detected
CPU: 0 PID: 7937 Comm: syz-executor.5 Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0dd577e ffff8800ae157878 ffffffff82c7f386 ffff880127a5e53f
 ffff8800ae157908 ffff880127a5e541 ffff8800ae4326c0 ffff8800ae1578f8
 ffffffff817405ba ffffffff816afd26 0000000000000286 0000000000000286
Call Trace:
 [<ffffffff82c7f386>] __dump_stack lib/dump_stack.c:15 [inline]
 [<ffffffff82c7f386>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff817405ba>] print_address_description mm/kasan/report.c:190 [inline]
 [<ffffffff817405ba>] kasan_report_error+0x59a/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174089a>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174089a>] __asan_report_load_n_noabort+0x3a/0x40 mm/kasan/report.c:328
 [<ffffffff838f393f>] __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline]
 [<ffffffff838f393f>] mc_hash drivers/net/macvlan.c:225 [inline]
 [<ffffffff838f393f>] macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251
 [<ffffffff838f5206>] macvlan_queue_xmit drivers/net/macvlan.c:482 [inline]
 [<ffffffff838f5206>] macvlan_start_xmit+0x316/0x610 drivers/net/macvlan.c:525
 [<ffffffff8518c379>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff8518c379>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff8518c379>] packet_direct_xmit+0x429/0x610 net/packet/af_packet.c:271
 [<ffffffff851977b4>] packet_snd net/packet/af_packet.c:2938 [inline]
 [<ffffffff851977b4>] packet_sendmsg+0x1f94/0x4eb0 net/packet/af_packet.c:2963
 [<ffffffff8490e2a5>] sock_sendmsg_nosec net/socket.c:612 [inline]
 [<ffffffff8490e2a5>] sock_sendmsg+0xb5/0xf0 net/socket.c:622
 [<ffffffff8490f279>] SYSC_sendto+0x1c9/0x300 net/socket.c:1648
 [<ffffffff84911569>] SyS_sendto+0x9/0x10 net/socket.c:1616
 [<ffffffff85bb80c0>] entry_SYSCALL_64_fastpath+0x23/0xc1
Memory state around the buggy address:
 ffff880127a5e400: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff880127a5e480: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
>ffff880127a5e500: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
                                           ^
 ffff880127a5e580: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff880127a5e600: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
==================================================================
==================================================================
BUG: KASAN: use-after-free in __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline] at addr ffff880127a08001
BUG: KASAN: use-after-free in mc_hash drivers/net/macvlan.c:225 [inline] at addr ffff880127a08001
BUG: KASAN: use-after-free in macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251 at addr ffff880127a08001
Read of size 4 by task syz-executor.2/7948
page:ffffea00049e8200 count:0 mapcount:-127 mapping:          (null) index:0x0
flags: 0x17ffe0000000000()
page dumped because: kasan: bad access detected
CPU: 0 PID: 7948 Comm: syz-executor.2 Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0dd577e ffff880127a6f878 ffffffff82c7f386 ffff880127a07fff
 ffff880127a6f908 ffff880127a08001 ffff8800b36f2140 ffff880127a6f8f8
 ffffffff817405ba ffffffff816afd26 0000000000000286 0000000000000286
Call Trace:
 [<ffffffff82c7f386>] __dump_stack lib/dump_stack.c:15 [inline]
 [<ffffffff82c7f386>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff817405ba>] print_address_description mm/kasan/report.c:190 [inline]
 [<ffffffff817405ba>] kasan_report_error+0x59a/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174089a>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174089a>] __asan_report_load_n_noabort+0x3a/0x40 mm/kasan/report.c:328
 [<ffffffff838f393f>] __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline]
 [<ffffffff838f393f>] mc_hash drivers/net/macvlan.c:225 [inline]
 [<ffffffff838f393f>] macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251
 [<ffffffff838f5206>] macvlan_queue_xmit drivers/net/macvlan.c:482 [inline]
 [<ffffffff838f5206>] macvlan_start_xmit+0x316/0x610 drivers/net/macvlan.c:525
 [<ffffffff8518c379>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff8518c379>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff8518c379>] packet_direct_xmit+0x429/0x610 net/packet/af_packet.c:271
 [<ffffffff851977b4>] packet_snd net/packet/af_packet.c:2938 [inline]
 [<ffffffff851977b4>] packet_sendmsg+0x1f94/0x4eb0 net/packet/af_packet.c:2963
 [<ffffffff8490e2a5>] sock_sendmsg_nosec net/socket.c:612 [inline]
 [<ffffffff8490e2a5>] sock_sendmsg+0xb5/0xf0 net/socket.c:622
 [<ffffffff8490f279>] SYSC_sendto+0x1c9/0x300 net/socket.c:1648
 [<ffffffff84911569>] SyS_sendto+0x9/0x10 net/socket.c:1616
 [<ffffffff85bb80c0>] entry_SYSCALL_64_fastpath+0x23/0xc1
Memory state around the buggy address:
 ffff880127a07f00: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
 ffff880127a07f80: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
>ffff880127a08000: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
                   ^
 ffff880127a08080: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff880127a08100: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
==================================================================
==================================================================
BUG: KASAN: use-after-free in __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline] at addr ffff8800ae6c4301
BUG: KASAN: use-after-free in mc_hash drivers/net/macvlan.c:225 [inline] at addr ffff8800ae6c4301
BUG: KASAN: use-after-free in macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251 at addr ffff8800ae6c4301
Read of size 4 by task syz-executor.3/7946
page:ffffea0002b9b100 count:0 mapcount:0 mapping:          (null) index:0x0
flags: 0xfffe0000000000()
page dumped because: kasan: bad access detected
CPU: 1 PID: 7946 Comm: syz-executor.3 Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0dd577e ffff8800ae117878 ffffffff82c7f386 ffff8800ae6c42ff
 ffff8800ae117908 ffff8800ae6c4301 ffff8800ae65a800 ffff8800ae1178f8
 ffffffff817405ba ffffffff816afd26 0000000000000286 0000000000000286
Call Trace:
 [<ffffffff82c7f386>] __dump_stack lib/dump_stack.c:15 [inline]
 [<ffffffff82c7f386>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff817405ba>] print_address_description mm/kasan/report.c:190 [inline]
 [<ffffffff817405ba>] kasan_report_error+0x59a/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174089a>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174089a>] __asan_report_load_n_noabort+0x3a/0x40 mm/kasan/report.c:328
 [<ffffffff838f393f>] __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline]
 [<ffffffff838f393f>] mc_hash drivers/net/macvlan.c:225 [inline]
 [<ffffffff838f393f>] macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251
 [<ffffffff838f5206>] macvlan_queue_xmit drivers/net/macvlan.c:482 [inline]
 [<ffffffff838f5206>] macvlan_start_xmit+0x316/0x610 drivers/net/macvlan.c:525
 [<ffffffff8518c379>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff8518c379>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff8518c379>] packet_direct_xmit+0x429/0x610 net/packet/af_packet.c:271
 [<ffffffff851977b4>] packet_snd net/packet/af_packet.c:2938 [inline]
 [<ffffffff851977b4>] packet_sendmsg+0x1f94/0x4eb0 net/packet/af_packet.c:2963
 [<ffffffff8490e2a5>] sock_sendmsg_nosec net/socket.c:612 [inline]
 [<ffffffff8490e2a5>] sock_sendmsg+0xb5/0xf0 net/socket.c:622
 [<ffffffff8490f279>] SYSC_sendto+0x1c9/0x300 net/socket.c:1648
 [<ffffffff84911569>] SyS_sendto+0x9/0x10 net/socket.c:1616
 [<ffffffff85bb80c0>] entry_SYSCALL_64_fastpath+0x23/0xc1
Memory state around the buggy address:
 ffff8800ae6c4200: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8800ae6c4280: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
>ffff8800ae6c4300: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
                   ^
 ffff8800ae6c4380: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8800ae6c4400: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
==================================================================
==================================================================
BUG: KASAN: use-after-free in __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline] at addr ffff8800ae12e041
BUG: KASAN: use-after-free in mc_hash drivers/net/macvlan.c:225 [inline] at addr ffff8800ae12e041
BUG: KASAN: use-after-free in macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251 at addr ffff8800ae12e041
Read of size 4 by task syz-executor.5/7967
page:ffffea0002b84b80 count:0 mapcount:0 mapping:          (null) index:0x0
flags: 0xfffe0000000000()
page dumped because: kasan: bad access detected
CPU: 0 PID: 7967 Comm: syz-executor.5 Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0dd577e ffff8800ae1ef878 ffffffff82c7f386 ffff8800ae12e03f
 ffff8800ae1ef908 ffff8800ae12e041 ffff8800ae4326c0 ffff8800ae1ef8f8
 ffffffff817405ba ffffffff816afd26 0000000000000286 0000000000000286
Call Trace:
 [<ffffffff82c7f386>] __dump_stack lib/dump_stack.c:15 [inline]
 [<ffffffff82c7f386>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff817405ba>] print_address_description mm/kasan/report.c:190 [inline]
 [<ffffffff817405ba>] kasan_report_error+0x59a/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174089a>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174089a>] __asan_report_load_n_noabort+0x3a/0x40 mm/kasan/report.c:328
 [<ffffffff838f393f>] __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline]
 [<ffffffff838f393f>] mc_hash drivers/net/macvlan.c:225 [inline]
 [<ffffffff838f393f>] macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251
 [<ffffffff838f5206>] macvlan_queue_xmit drivers/net/macvlan.c:482 [inline]
 [<ffffffff838f5206>] macvlan_start_xmit+0x316/0x610 drivers/net/macvlan.c:525
 [<ffffffff8518c379>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff8518c379>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff8518c379>] packet_direct_xmit+0x429/0x610 net/packet/af_packet.c:271
 [<ffffffff851977b4>] packet_snd net/packet/af_packet.c:2938 [inline]
 [<ffffffff851977b4>] packet_sendmsg+0x1f94/0x4eb0 net/packet/af_packet.c:2963
 [<ffffffff8490e2a5>] sock_sendmsg_nosec net/socket.c:612 [inline]
 [<ffffffff8490e2a5>] sock_sendmsg+0xb5/0xf0 net/socket.c:622
 [<ffffffff8490f279>] SYSC_sendto+0x1c9/0x300 net/socket.c:1648
 [<ffffffff84911569>] SyS_sendto+0x9/0x10 net/socket.c:1616
 [<ffffffff85bb80c0>] entry_SYSCALL_64_fastpath+0x23/0xc1
Memory state around the buggy address:
 ffff8800ae12df00: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8800ae12df80: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
>ffff8800ae12e000: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
                                           ^
 ffff8800ae12e080: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8800ae12e100: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
==================================================================
==================================================================
BUG: KASAN: use-after-free in __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline] at addr ffff8800ae03f301
BUG: KASAN: use-after-free in mc_hash drivers/net/macvlan.c:225 [inline] at addr ffff8800ae03f301
BUG: KASAN: use-after-free in macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251 at addr ffff8800ae03f301
Read of size 4 by task syz-executor.1/7977
page:ffffea0002b80fc0 count:0 mapcount:0 mapping:          (null) index:0x0
flags: 0xfffe0000000000()
page dumped because: kasan: bad access detected
CPU: 0 PID: 7977 Comm: syz-executor.1 Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0dd577e ffff880127a6f878 ffffffff82c7f386 ffff8800ae03f2ff
 ffff880127a6f908 ffff8800ae03f301 ffff8800b224a600 ffff880127a6f8f8
 ffffffff817405ba ffffffff816afd26 0000000000000286 0000000000000286
Call Trace:
 [<ffffffff82c7f386>] __dump_stack lib/dump_stack.c:15 [inline]
 [<ffffffff82c7f386>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff817405ba>] print_address_description mm/kasan/report.c:190 [inline]
 [<ffffffff817405ba>] kasan_report_error+0x59a/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174089a>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174089a>] __asan_report_load_n_noabort+0x3a/0x40 mm/kasan/report.c:328
 [<ffffffff838f393f>] __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline]
 [<ffffffff838f393f>] mc_hash drivers/net/macvlan.c:225 [inline]
 [<ffffffff838f393f>] macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251
 [<ffffffff838f5206>] macvlan_queue_xmit drivers/net/macvlan.c:482 [inline]
 [<ffffffff838f5206>] macvlan_start_xmit+0x316/0x610 drivers/net/macvlan.c:525
 [<ffffffff8518c379>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff8518c379>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff8518c379>] packet_direct_xmit+0x429/0x610 net/packet/af_packet.c:271
 [<ffffffff851977b4>] packet_snd net/packet/af_packet.c:2938 [inline]
 [<ffffffff851977b4>] packet_sendmsg+0x1f94/0x4eb0 net/packet/af_packet.c:2963
 [<ffffffff8490e2a5>] sock_sendmsg_nosec net/socket.c:612 [inline]
 [<ffffffff8490e2a5>] sock_sendmsg+0xb5/0xf0 net/socket.c:622
 [<ffffffff8490f279>] SYSC_sendto+0x1c9/0x300 net/socket.c:1648
 [<ffffffff84911569>] SyS_sendto+0x9/0x10 net/socket.c:1616
 [<ffffffff85bb80c0>] entry_SYSCALL_64_fastpath+0x23/0xc1
Memory state around the buggy address:
 ffff8800ae03f200: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8800ae03f280: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
>ffff8800ae03f300: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
                   ^
 ffff8800ae03f380: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8800ae03f400: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
==================================================================
==================================================================
BUG: KASAN: use-after-free in __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline] at addr ffff8800ae12e2c1
BUG: KASAN: use-after-free in mc_hash drivers/net/macvlan.c:225 [inline] at addr ffff8800ae12e2c1
BUG: KASAN: use-after-free in macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251 at addr ffff8800ae12e2c1
Read of size 4 by task syz-executor.3/7979
page:ffffea0002b84b80 count:0 mapcount:0 mapping:          (null) index:0x0
flags: 0xfffe0000000000()
page dumped because: kasan: bad access detected
CPU: 1 PID: 7979 Comm: syz-executor.3 Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0dd577e ffff8800ae13f878 ffffffff82c7f386 ffff8800ae12e2bf
 ffff8800ae13f908 ffff8800ae12e2c1 ffff8800ae65a800 ffff8800ae13f8f8
 ffffffff817405ba ffffffff816afd26 0000000000000286 0000000000000286
Call Trace:
 [<ffffffff82c7f386>] __dump_stack lib/dump_stack.c:15 [inline]
 [<ffffffff82c7f386>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff817405ba>] print_address_description mm/kasan/report.c:190 [inline]
 [<ffffffff817405ba>] kasan_report_error+0x59a/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174089a>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174089a>] __asan_report_load_n_noabort+0x3a/0x40 mm/kasan/report.c:328
 [<ffffffff838f393f>] __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline]
 [<ffffffff838f393f>] mc_hash drivers/net/macvlan.c:225 [inline]
 [<ffffffff838f393f>] macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251
 [<ffffffff838f5206>] macvlan_queue_xmit drivers/net/macvlan.c:482 [inline]
 [<ffffffff838f5206>] macvlan_start_xmit+0x316/0x610 drivers/net/macvlan.c:525
 [<ffffffff8518c379>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff8518c379>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff8518c379>] packet_direct_xmit+0x429/0x610 net/packet/af_packet.c:271
 [<ffffffff851977b4>] packet_snd net/packet/af_packet.c:2938 [inline]
 [<ffffffff851977b4>] packet_sendmsg+0x1f94/0x4eb0 net/packet/af_packet.c:2963
 [<ffffffff8490e2a5>] sock_sendmsg_nosec net/socket.c:612 [inline]
 [<ffffffff8490e2a5>] sock_sendmsg+0xb5/0xf0 net/socket.c:622
 [<ffffffff8490f279>] SYSC_sendto+0x1c9/0x300 net/socket.c:1648
 [<ffffffff84911569>] SyS_sendto+0x9/0x10 net/socket.c:1616
 [<ffffffff85bb80c0>] entry_SYSCALL_64_fastpath+0x23/0xc1
Memory state around the buggy address:
 ffff8800ae12e180: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8800ae12e200: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
>ffff8800ae12e280: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
                                           ^
 ffff8800ae12e300: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8800ae12e380: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
==================================================================
==================================================================
BUG: KASAN: use-after-free in __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline] at addr ffff8800ae12e7c1
BUG: KASAN: use-after-free in mc_hash drivers/net/macvlan.c:225 [inline] at addr ffff8800ae12e7c1
BUG: KASAN: use-after-free in macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251 at addr ffff8800ae12e7c1
Read of size 4 by task syz-executor.5/7996
page:ffffea0002b84b80 count:0 mapcount:0 mapping:          (null) index:0x0
flags: 0xfffe0000000000()
page dumped because: kasan: bad access detected
CPU: 0 PID: 7996 Comm: syz-executor.5 Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0dd577e ffff8800ae15f878 ffffffff82c7f386 ffff8800ae12e7bf
 ffff8800ae15f908 ffff8800ae12e7c1 ffff8800ae4326c0 ffff8800ae15f8f8
 ffffffff817405ba ffffffff816afd26 0000000000000286 0000000000000286
Call Trace:
 [<ffffffff82c7f386>] __dump_stack lib/dump_stack.c:15 [inline]
 [<ffffffff82c7f386>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff817405ba>] print_address_description mm/kasan/report.c:190 [inline]
 [<ffffffff817405ba>] kasan_report_error+0x59a/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174089a>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174089a>] __asan_report_load_n_noabort+0x3a/0x40 mm/kasan/report.c:328
 [<ffffffff838f393f>] __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline]
 [<ffffffff838f393f>] mc_hash drivers/net/macvlan.c:225 [inline]
 [<ffffffff838f393f>] macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251
 [<ffffffff838f5206>] macvlan_queue_xmit drivers/net/macvlan.c:482 [inline]
 [<ffffffff838f5206>] macvlan_start_xmit+0x316/0x610 drivers/net/macvlan.c:525
 [<ffffffff8518c379>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff8518c379>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff8518c379>] packet_direct_xmit+0x429/0x610 net/packet/af_packet.c:271
 [<ffffffff851977b4>] packet_snd net/packet/af_packet.c:2938 [inline]
 [<ffffffff851977b4>] packet_sendmsg+0x1f94/0x4eb0 net/packet/af_packet.c:2963
 [<ffffffff8490e2a5>] sock_sendmsg_nosec net/socket.c:612 [inline]
 [<ffffffff8490e2a5>] sock_sendmsg+0xb5/0xf0 net/socket.c:622
 [<ffffffff8490f279>] SYSC_sendto+0x1c9/0x300 net/socket.c:1648
 [<ffffffff84911569>] SyS_sendto+0x9/0x10 net/socket.c:1616
 [<ffffffff85bb80c0>] entry_SYSCALL_64_fastpath+0x23/0xc1
Memory state around the buggy address:
 ffff8800ae12e680: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8800ae12e700: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
>ffff8800ae12e780: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
                                           ^
 ffff8800ae12e800: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8800ae12e880: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
==================================================================
==================================================================
BUG: KASAN: slab-out-of-bounds in __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline] at addr ffff8800ae74f5c1
BUG: KASAN: slab-out-of-bounds in mc_hash drivers/net/macvlan.c:225 [inline] at addr ffff8800ae74f5c1
BUG: KASAN: slab-out-of-bounds in macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251 at addr ffff8800ae74f5c1
Read of size 4 by task syz-executor.2/8009
CPU: 1 PID: 8009 Comm: syz-executor.2 Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0dd577e ffff8800ae157878 ffffffff82c7f386 ffff8800ae74f5bf
 ffff8800ae157908 ffff8800ae74f200 ffff88012bc00700 ffff8800ae1578f8
 ffffffff81740207 ffffffff816afd26 0000000000000286 0000000000000286
Call Trace:
 [<ffffffff82c7f386>] __dump_stack lib/dump_stack.c:15 [inline]
 [<ffffffff82c7f386>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff81740207>] object_err mm/kasan/report.c:139 [inline]
 [<ffffffff81740207>] print_address_description mm/kasan/report.c:179 [inline]
 [<ffffffff81740207>] kasan_report_error+0x1e7/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174089a>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174089a>] __asan_report_load_n_noabort+0x3a/0x40 mm/kasan/report.c:328
 [<ffffffff838f393f>] __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline]
 [<ffffffff838f393f>] mc_hash drivers/net/macvlan.c:225 [inline]
 [<ffffffff838f393f>] macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251
 [<ffffffff838f5206>] macvlan_queue_xmit drivers/net/macvlan.c:482 [inline]
 [<ffffffff838f5206>] macvlan_start_xmit+0x316/0x610 drivers/net/macvlan.c:525
 [<ffffffff8518c379>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff8518c379>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff8518c379>] packet_direct_xmit+0x429/0x610 net/packet/af_packet.c:271
 [<ffffffff851977b4>] packet_snd net/packet/af_packet.c:2938 [inline]
 [<ffffffff851977b4>] packet_sendmsg+0x1f94/0x4eb0 net/packet/af_packet.c:2963
 [<ffffffff8490e2a5>] sock_sendmsg_nosec net/socket.c:612 [inline]
 [<ffffffff8490e2a5>] sock_sendmsg+0xb5/0xf0 net/socket.c:622
 [<ffffffff8490f279>] SYSC_sendto+0x1c9/0x300 net/socket.c:1648
 [<ffffffff84911569>] SyS_sendto+0x9/0x10 net/socket.c:1616
 [<ffffffff85bb80c0>] entry_SYSCALL_64_fastpath+0x23/0xc1
Object at ffff8800ae74f200, in cache kmalloc-1024
Object allocated with size 704 bytes.
Allocation:
PID = 7937
 [<ffffffff81205056>] save_stack_trace+0x26/0x50 arch/x86/kernel/stacktrace.c:67
 [<ffffffff8173f3e6>] save_stack+0x46/0xd0 mm/kasan/kasan.c:450
 [<ffffffff8173f7a9>] set_track mm/kasan/kasan.c:462 [inline]
 [<ffffffff8173f7a9>] kasan_kmalloc+0xc9/0xe0 mm/kasan/kasan.c:532
 [<ffffffff8173bb09>] __do_kmalloc mm/slab.c:3545 [inline]
 [<ffffffff8173bb09>] __kmalloc+0x169/0x6d0 mm/slab.c:3554
 [<ffffffff849a4aea>] kmalloc include/linux/slab.h:483 [inline]
 [<ffffffff849a4aea>] kzalloc include/linux/slab.h:622 [inline]
 [<ffffffff849a4aea>] neigh_alloc net/core/neighbour.c:285 [inline]
 [<ffffffff849a4aea>] __neigh_create+0x1ea/0x19f0 net/core/neighbour.c:457
 [<ffffffff8502ccc1>] ip6_finish_output2+0x841/0x1b90 net/ipv6/ip6_output.c:111
 [<ffffffff85036723>] ip6_finish_output+0x353/0x700 net/ipv6/ip6_output.c:131
 [<ffffffff85036c37>] NF_HOOK_COND include/linux/netfilter.h:233 [inline]
 [<ffffffff85036c37>] ip6_output+0x167/0x530 net/ipv6/ip6_output.c:145
 [<ffffffff8508ac79>] dst_output include/net/dst.h:504 [inline]
 [<ffffffff8508ac79>] NF_HOOK_THRESH.constprop.24+0xc9/0x290 include/linux/netfilter.h:219
 [<ffffffff8508b7c4>] NF_HOOK include/linux/netfilter.h:242 [inline]
 [<ffffffff8508b7c4>] ndisc_send_skb+0x7a4/0x1010 net/ipv6/ndisc.c:471
 [<ffffffff85090046>] ndisc_send_rs+0x116/0x3d0 net/ipv6/ndisc.c:646
 [<ffffffff8505516a>] addrconf_rs_timer+0x28a/0x410 net/ipv6/addrconf.c:3622
 [<ffffffff814a053e>] call_timer_fn+0x14e/0x620 kernel/time/timer.c:1178
 [<ffffffff814a1007>] __run_timers kernel/time/timer.c:1254 [inline]
 [<ffffffff814a1007>] run_timer_softirq+0x5f7/0x9c0 kernel/time/timer.c:1437
 [<ffffffff85bbb26c>] __do_softirq+0x2cc/0xa06 kernel/softirq.c:273
Memory state around the buggy address:
 ffff8800ae74f480: 00 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc
 ffff8800ae74f500: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
>ffff8800ae74f580: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
                                           ^
 ffff8800ae74f600: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
 ffff8800ae74f680: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
==================================================================
==================================================================
BUG: KASAN: slab-out-of-bounds in __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline] at addr ffff8800ae74f5c1
BUG: KASAN: slab-out-of-bounds in mc_hash drivers/net/macvlan.c:225 [inline] at addr ffff8800ae74f5c1
BUG: KASAN: slab-out-of-bounds in macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251 at addr ffff8800ae74f5c1
Read of size 4 by task syz-executor.0/8026
CPU: 1 PID: 8026 Comm: syz-executor.0 Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0dd577e ffff880127ac7878 ffffffff82c7f386 ffff8800ae74f5bf
 ffff880127ac7908 ffff8800ae74f200 ffff88012bc00700 ffff880127ac78f8
 ffffffff81740207 ffffffff816afd26 0000000000000286 0000000000000286
Call Trace:
 [<ffffffff82c7f386>] __dump_stack lib/dump_stack.c:15 [inline]
 [<ffffffff82c7f386>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff81740207>] object_err mm/kasan/report.c:139 [inline]
 [<ffffffff81740207>] print_address_description mm/kasan/report.c:179 [inline]
 [<ffffffff81740207>] kasan_report_error+0x1e7/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174089a>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174089a>] __asan_report_load_n_noabort+0x3a/0x40 mm/kasan/report.c:328
 [<ffffffff838f393f>] __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline]
 [<ffffffff838f393f>] mc_hash drivers/net/macvlan.c:225 [inline]
 [<ffffffff838f393f>] macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251
 [<ffffffff838f5206>] macvlan_queue_xmit drivers/net/macvlan.c:482 [inline]
 [<ffffffff838f5206>] macvlan_start_xmit+0x316/0x610 drivers/net/macvlan.c:525
 [<ffffffff8518c379>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff8518c379>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff8518c379>] packet_direct_xmit+0x429/0x610 net/packet/af_packet.c:271
 [<ffffffff851977b4>] packet_snd net/packet/af_packet.c:2938 [inline]
 [<ffffffff851977b4>] packet_sendmsg+0x1f94/0x4eb0 net/packet/af_packet.c:2963
 [<ffffffff8490e2a5>] sock_sendmsg_nosec net/socket.c:612 [inline]
 [<ffffffff8490e2a5>] sock_sendmsg+0xb5/0xf0 net/socket.c:622
 [<ffffffff8490f279>] SYSC_sendto+0x1c9/0x300 net/socket.c:1648
 [<ffffffff84911569>] SyS_sendto+0x9/0x10 net/socket.c:1616
 [<ffffffff85bb80c0>] entry_SYSCALL_64_fastpath+0x23/0xc1
Object at ffff8800ae74f200, in cache kmalloc-1024
Object allocated with size 704 bytes.
Allocation:
PID = 7937
 [<ffffffff81205056>] save_stack_trace+0x26/0x50 arch/x86/kernel/stacktrace.c:67
 [<ffffffff8173f3e6>] save_stack+0x46/0xd0 mm/kasan/kasan.c:450
 [<ffffffff8173f7a9>] set_track mm/kasan/kasan.c:462 [inline]
 [<ffffffff8173f7a9>] kasan_kmalloc+0xc9/0xe0 mm/kasan/kasan.c:532
 [<ffffffff8173bb09>] __do_kmalloc mm/slab.c:3545 [inline]
 [<ffffffff8173bb09>] __kmalloc+0x169/0x6d0 mm/slab.c:3554
 [<ffffffff849a4aea>] kmalloc include/linux/slab.h:483 [inline]
 [<ffffffff849a4aea>] kzalloc include/linux/slab.h:622 [inline]
 [<ffffffff849a4aea>] neigh_alloc net/core/neighbour.c:285 [inline]
 [<ffffffff849a4aea>] __neigh_create+0x1ea/0x19f0 net/core/neighbour.c:457
 [<ffffffff8502ccc1>] ip6_finish_output2+0x841/0x1b90 net/ipv6/ip6_output.c:111
 [<ffffffff85036723>] ip6_finish_output+0x353/0x700 net/ipv6/ip6_output.c:131
 [<ffffffff85036c37>] NF_HOOK_COND include/linux/netfilter.h:233 [inline]
 [<ffffffff85036c37>] ip6_output+0x167/0x530 net/ipv6/ip6_output.c:145
 [<ffffffff8508ac79>] dst_output include/net/dst.h:504 [inline]
 [<ffffffff8508ac79>] NF_HOOK_THRESH.constprop.24+0xc9/0x290 include/linux/netfilter.h:219
 [<ffffffff8508b7c4>] NF_HOOK include/linux/netfilter.h:242 [inline]
 [<ffffffff8508b7c4>] ndisc_send_skb+0x7a4/0x1010 net/ipv6/ndisc.c:471
 [<ffffffff85090046>] ndisc_send_rs+0x116/0x3d0 net/ipv6/ndisc.c:646
 [<ffffffff8505516a>] addrconf_rs_timer+0x28a/0x410 net/ipv6/addrconf.c:3622
 [<ffffffff814a053e>] call_timer_fn+0x14e/0x620 kernel/time/timer.c:1178
 [<ffffffff814a1007>] __run_timers kernel/time/timer.c:1254 [inline]
 [<ffffffff814a1007>] run_timer_softirq+0x5f7/0x9c0 kernel/time/timer.c:1437
 [<ffffffff85bbb26c>] __do_softirq+0x2cc/0xa06 kernel/softirq.c:273
Memory state around the buggy address:
 ffff8800ae74f480: 00 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc
 ffff8800ae74f500: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
>ffff8800ae74f580: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
                                           ^
 ffff8800ae74f600: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
 ffff8800ae74f680: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
==================================================================
==================================================================
BUG: KASAN: slab-out-of-bounds in __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline] at addr ffff8800ae74f0c1
BUG: KASAN: slab-out-of-bounds in mc_hash drivers/net/macvlan.c:225 [inline] at addr ffff8800ae74f0c1
BUG: KASAN: slab-out-of-bounds in macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251 at addr ffff8800ae74f0c1
Read of size 4 by task syz-executor.1/8034
CPU: 1 PID: 8034 Comm: syz-executor.1 Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0dd577e ffff8800ae747878 ffffffff82c7f386 ffff8800ae74f0bf
 ffff8800ae747908 ffff8800ae74ed80 ffff88012bc00700 ffff8800ae7478f8
 ffffffff81740207 ffffffff816afd26 0000000000000286 0000000000000286
Call Trace:
 [<ffffffff82c7f386>] __dump_stack lib/dump_stack.c:15 [inline]
 [<ffffffff82c7f386>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff81740207>] object_err mm/kasan/report.c:139 [inline]
 [<ffffffff81740207>] print_address_description mm/kasan/report.c:179 [inline]
 [<ffffffff81740207>] kasan_report_error+0x1e7/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174089a>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174089a>] __asan_report_load_n_noabort+0x3a/0x40 mm/kasan/report.c:328
 [<ffffffff838f393f>] __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline]
 [<ffffffff838f393f>] mc_hash drivers/net/macvlan.c:225 [inline]
 [<ffffffff838f393f>] macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251
 [<ffffffff838f5206>] macvlan_queue_xmit drivers/net/macvlan.c:482 [inline]
 [<ffffffff838f5206>] macvlan_start_xmit+0x316/0x610 drivers/net/macvlan.c:525
 [<ffffffff8518c379>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff8518c379>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff8518c379>] packet_direct_xmit+0x429/0x610 net/packet/af_packet.c:271
 [<ffffffff851977b4>] packet_snd net/packet/af_packet.c:2938 [inline]
 [<ffffffff851977b4>] packet_sendmsg+0x1f94/0x4eb0 net/packet/af_packet.c:2963
 [<ffffffff8490e2a5>] sock_sendmsg_nosec net/socket.c:612 [inline]
 [<ffffffff8490e2a5>] sock_sendmsg+0xb5/0xf0 net/socket.c:622
 [<ffffffff8490f279>] SYSC_sendto+0x1c9/0x300 net/socket.c:1648

