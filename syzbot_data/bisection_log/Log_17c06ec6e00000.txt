bisecting cause commit starting from f11421ba4af706cb4f5703de34fa77fba8472776
building syzkaller on 438e1227121e9d4bbca7b12b6e1b715524d512c2
testing commit f11421ba4af706cb4f5703de34fa77fba8472776 with gcc (GCC) 8.1.0
kernel signature: c1d275cbe464296aef29a945cfa1dcc86a953d0a
run #0: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #1: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #2: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #3: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #4: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #5: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #6: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #7: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #8: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #9: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
testing release v5.4
testing commit 219d54332a09e8d8741c1e1982f5eae56099de85 with gcc (GCC) 8.1.0
kernel signature: 072be1220a658c86148dfe537bb87f3e927a5a29
run #0: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #1: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #2: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #3: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #4: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #5: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #6: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #7: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #8: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #9: crashed: KASAN: use-after-free Read in macvlan_broadcast
testing release v5.3
testing commit 4d856f72c10ecb060868ed10ff1b1453943fc6c8 with gcc (GCC) 8.1.0
kernel signature: c0fccf109240589ad853e9cd88a126d9aa50f2a5
run #0: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #1: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #2: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #3: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #4: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #5: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #6: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #7: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #8: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #9: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
testing release v5.2
testing commit 0ecfebd2b52404ae0c54a878c872bb93363ada36 with gcc (GCC) 8.1.0
kernel signature: caa7ec39b982f01a161c936fb72df9fb35547178
run #0: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #1: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #2: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #3: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #4: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #5: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #6: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #7: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #8: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #9: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
testing release v5.1
testing commit e93c9c99a629c61837d5a7fc2120cd2b6c70dbdd with gcc (GCC) 8.1.0
kernel signature: 77fbe06204ba6eb046750b2053f6c84280fc2c1e
run #0: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #1: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #2: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #3: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #4: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #5: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #6: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #7: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #8: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #9: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
testing release v5.0
testing commit 1c163f4c7b3f621efff9b28a47abb36f7378d783 with gcc (GCC) 8.1.0
kernel signature: 6426b66403d22dfadf503e440d91407f32c4c6da
run #0: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #1: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #2: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #3: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #4: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #5: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #6: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #7: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #8: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #9: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
testing release v4.20
testing commit 8fe28cb58bcb235034b64cbbb7550a8a43fd88be with gcc (GCC) 8.1.0
kernel signature: c82311ae53009e29cb9a161e928fcc74e62c7aea
run #0: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #1: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #2: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #3: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #4: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #5: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #6: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #7: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #8: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #9: crashed: KASAN: use-after-free Read in macvlan_broadcast
testing release v4.19
testing commit 84df9525b0c27f3ebc2ebb1864fa62a97fdedb7d with gcc (GCC) 8.1.0
kernel signature: f3237347842e01d3040c6d827a31c8d59ce06fab
run #0: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #1: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #2: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #3: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #4: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #5: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #6: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #7: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #8: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #9: crashed: KASAN: use-after-free Read in macvlan_broadcast
testing release v4.18
testing commit 94710cac0ef4ee177a63b5227664b38c95bbf703 with gcc (GCC) 8.1.0
kernel signature: 4ed6045c9d6463188c271ec6caab31bcd3b3794f
run #0: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #1: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #2: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #3: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #4: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #5: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #6: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #7: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #8: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #9: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
testing release v4.17
testing commit 29dcea88779c856c7dc92040a0c01233263101d4 with gcc (GCC) 8.1.0
kernel signature: 062f3b112596d5d226f93a879d5ad6d1c556b282
run #0: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #1: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #2: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #3: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #4: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #5: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #6: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #7: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #8: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #9: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
testing release v4.16
testing commit 0adb32858b0bddf4ada5f364a84ed60b196dbcda with gcc (GCC) 8.1.0
kernel signature: a2bfc896ed2a7c817ff1a0871c48d8ef303ca986
run #0: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #1: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #2: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #3: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #4: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #5: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #6: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #7: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #8: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #9: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
testing release v4.15
testing commit d8a5b80568a9cb66810e75b182018e9edb68e8ff with gcc (GCC) 8.1.0
kernel signature: 480f726fe2383552e7647315b474487f0cdc5084
run #0: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #1: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #2: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #3: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #4: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #5: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #6: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #7: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #8: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #9: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
testing release v4.14
testing commit bebc6082da0a9f5d47a1ea2edc099bf671058bd4 with gcc (GCC) 8.1.0
kernel signature: 3b712a17260a6f5bfba19a54102274e674c2499c
run #0: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #1: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #2: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #3: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #4: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #5: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #6: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #7: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #8: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #9: crashed: KASAN: use-after-free Read in macvlan_broadcast
testing release v4.13
testing commit 569dbb88e80deb68974ef6fdd6a13edb9d686261 with gcc (GCC) 8.1.0
kernel signature: 064ea2e288ada0439d454116862d44cfcf4650b7
run #0: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #1: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #2: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #3: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #4: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #5: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #6: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #7: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #8: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #9: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
testing release v4.12
testing commit 6f7da290413ba713f0cdd9ff1a2a9bb129ef4f6c with gcc (GCC) 8.1.0
kernel signature: 317c492f4ae8fe204420815a7008baff254e5a50
run #0: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #1: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #2: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #3: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #4: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #5: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #6: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #7: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #8: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #9: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
testing release v4.11
testing commit a351e9b9fc24e982ec2f0e76379a49826036da12 with gcc (GCC) 7.3.0
kernel signature: 2448c4f3666870aa1457c79851f70ca78576b644
run #0: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #1: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #2: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #3: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #4: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #5: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #6: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #7: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #8: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #9: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
testing release v4.10
testing commit c470abd4fde40ea6a0846a2beab642a578c0b8cd with gcc (GCC) 5.5.0
kernel signature: 6ecf041d8199df21e4d3e56e25eed26faeae68e7
run #0: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #1: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #2: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #3: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #4: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #5: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #6: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #7: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #8: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #9: crashed: KASAN: use-after-free Read in macvlan_broadcast
testing release v4.9
testing commit 69973b830859bc6529a7a0468ba0d80ee5117826 with gcc (GCC) 5.5.0
kernel signature: d567860d5595f8e467248c70ea2ad006acc66623
run #0: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #1: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #2: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #3: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #4: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #5: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #6: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #7: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #8: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #9: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
testing release v4.8
testing commit c8d2bc9bc39ebea8437fd974fdbc21847bb897a3 with gcc (GCC) 5.5.0
kernel signature: 266191882ca72ba99bf39dc40d8022ff920786a8
run #0: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #1: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #2: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #3: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #4: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #5: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #6: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #7: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #8: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #9: crashed: KASAN: use-after-free Read in macvlan_broadcast
testing release v4.7
testing commit 523d939ef98fd712632d93a5a2b588e477a7565e with gcc (GCC) 5.5.0
kernel signature: 0d832873c2986389d012cb4db2bb756134875042
run #0: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #1: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #2: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #3: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #4: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #5: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #6: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #7: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #8: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #9: crashed: KASAN: use-after-free Read in macvlan_broadcast
testing release v4.6
testing commit 2dcd0af568b0cf583645c8a317dd12e344b1c72a with gcc (GCC) 5.5.0
kernel signature: 47b32a808a0a2ec3fad6790e12d70084e0acb2b7
run #0: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #1: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #2: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #3: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #4: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #5: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #6: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
run #7: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #8: crashed: KASAN: use-after-free Read in macvlan_broadcast
run #9: crashed: KASAN: slab-out-of-bounds Read in macvlan_broadcast
revisions tested: 21, total time: 3h0m17.14871587s (build: 1h48m7.78261912s, test: 1h9m55.955229211s)
the crash already happened on the oldest tested release
commit msg: Linux 4.6
crash: KASAN: slab-out-of-bounds Read in macvlan_broadcast
IPv6: ADDRCONF(NETDEV_UP): veth0_vlan: link is not ready
device veth0_vlan entered promiscuous mode
IPv6: ADDRCONF(NETDEV_UP): vlan0: link is not ready
IPv6: ADDRCONF(NETDEV_UP): vlan1: link is not ready
==================================================================
BUG: KASAN: slab-out-of-bounds in __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline] at addr ffff8800adf90281
BUG: KASAN: slab-out-of-bounds in mc_hash drivers/net/macvlan.c:225 [inline] at addr ffff8800adf90281
BUG: KASAN: slab-out-of-bounds in macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251 at addr ffff8800adf90281
Read of size 4 by task syz-executor.4/7705
CPU: 1 PID: 7705 Comm: syz-executor.4 Not tainted 4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0dd577e ffff880128167878 ffffffff82c7f386 ffff8800adf9027f
 ffff880128167908 ffff8800adf90268 ffff8800bb9c4f00 ffff8801281678f8
 ffffffff81740207 ffff880129502a40 0000000000000286 0000000000000286
Call Trace:
 [<ffffffff82c7f386>] __dump_stack lib/dump_stack.c:15 [inline]
 [<ffffffff82c7f386>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff81740207>] object_err mm/kasan/report.c:139 [inline]
 [<ffffffff81740207>] print_address_description mm/kasan/report.c:179 [inline]
 [<ffffffff81740207>] kasan_report_error+0x1e7/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174089a>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174089a>] __asan_report_load_n_noabort+0x3a/0x40 mm/kasan/report.c:328
 [<ffffffff838f393f>] __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline]
 [<ffffffff838f393f>] mc_hash drivers/net/macvlan.c:225 [inline]
 [<ffffffff838f393f>] macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251
 [<ffffffff838f5206>] macvlan_queue_xmit drivers/net/macvlan.c:482 [inline]
 [<ffffffff838f5206>] macvlan_start_xmit+0x316/0x610 drivers/net/macvlan.c:525
 [<ffffffff8518c379>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff8518c379>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff8518c379>] packet_direct_xmit+0x429/0x610 net/packet/af_packet.c:271
 [<ffffffff851977b4>] packet_snd net/packet/af_packet.c:2938 [inline]
 [<ffffffff851977b4>] packet_sendmsg+0x1f94/0x4eb0 net/packet/af_packet.c:2963
 [<ffffffff8490e2a5>] sock_sendmsg_nosec net/socket.c:612 [inline]
 [<ffffffff8490e2a5>] sock_sendmsg+0xb5/0xf0 net/socket.c:622
 [<ffffffff8490f279>] SYSC_sendto+0x1c9/0x300 net/socket.c:1648
 [<ffffffff84911569>] SyS_sendto+0x9/0x10 net/socket.c:1616
 [<ffffffff85bb80c0>] entry_SYSCALL_64_fastpath+0x23/0xc1
Object at ffff8800adf90268, in cache ip_fib_alias
Object not allocated yet
Memory state around the buggy address:
 ffff8800adf90180: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
 ffff8800adf90200: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
>ffff8800adf90280: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
                   ^
 ffff8800adf90300: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
 ffff8800adf90380: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
==================================================================
==================================================================
BUG: KASAN: slab-out-of-bounds in __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline] at addr ffff8800adf90281
BUG: KASAN: slab-out-of-bounds in mc_hash drivers/net/macvlan.c:225 [inline] at addr ffff8800adf90281
BUG: KASAN: slab-out-of-bounds in macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251 at addr ffff8800adf90281
Read of size 4 by task syz-executor.4/7709
CPU: 1 PID: 7709 Comm: syz-executor.4 Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0dd577e ffff8800ad87f878 ffffffff82c7f386 ffff8800adf9027f
 ffff8800ad87f908 ffff8800adf90268 ffff8800bb9c4f00 ffff8800ad87f8f8
 ffffffff81740207 ffffffff816afd26 0000000000000286 0000000000000286
Call Trace:
 [<ffffffff82c7f386>] __dump_stack lib/dump_stack.c:15 [inline]
 [<ffffffff82c7f386>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff81740207>] object_err mm/kasan/report.c:139 [inline]
 [<ffffffff81740207>] print_address_description mm/kasan/report.c:179 [inline]
 [<ffffffff81740207>] kasan_report_error+0x1e7/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174089a>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174089a>] __asan_report_load_n_noabort+0x3a/0x40 mm/kasan/report.c:328
 [<ffffffff838f393f>] __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline]
 [<ffffffff838f393f>] mc_hash drivers/net/macvlan.c:225 [inline]
 [<ffffffff838f393f>] macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251
 [<ffffffff838f5206>] macvlan_queue_xmit drivers/net/macvlan.c:482 [inline]
 [<ffffffff838f5206>] macvlan_start_xmit+0x316/0x610 drivers/net/macvlan.c:525
 [<ffffffff8518c379>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff8518c379>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff8518c379>] packet_direct_xmit+0x429/0x610 net/packet/af_packet.c:271
 [<ffffffff851977b4>] packet_snd net/packet/af_packet.c:2938 [inline]
 [<ffffffff851977b4>] packet_sendmsg+0x1f94/0x4eb0 net/packet/af_packet.c:2963
 [<ffffffff8490e2a5>] sock_sendmsg_nosec net/socket.c:612 [inline]
 [<ffffffff8490e2a5>] sock_sendmsg+0xb5/0xf0 net/socket.c:622
 [<ffffffff8490f279>] SYSC_sendto+0x1c9/0x300 net/socket.c:1648
 [<ffffffff84911569>] SyS_sendto+0x9/0x10 net/socket.c:1616
 [<ffffffff85bb80c0>] entry_SYSCALL_64_fastpath+0x23/0xc1
Object at ffff8800adf90268, in cache ip_fib_alias
Object not allocated yet
Memory state around the buggy address:
 ffff8800adf90180: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
 ffff8800adf90200: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
>ffff8800adf90280: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
                   ^
 ffff8800adf90300: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
 ffff8800adf90380: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
==================================================================
==================================================================
BUG: KASAN: slab-out-of-bounds in __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline] at addr ffff8800adf90281
BUG: KASAN: slab-out-of-bounds in mc_hash drivers/net/macvlan.c:225 [inline] at addr ffff8800adf90281
BUG: KASAN: slab-out-of-bounds in macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251 at addr ffff8800adf90281
Read of size 4 by task syz-executor.4/7713
CPU: 1 PID: 7713 Comm: syz-executor.4 Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0dd577e ffff8800adf77878 ffffffff82c7f386 ffff8800adf9027f
 ffff8800adf77908 ffff8800adf90268 ffff8800bb9c4f00 ffff8800adf778f8
 ffffffff81740207 ffffffff816afd26 0000000000000286 0000000000000286
Call Trace:
 [<ffffffff82c7f386>] __dump_stack lib/dump_stack.c:15 [inline]
 [<ffffffff82c7f386>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff81740207>] object_err mm/kasan/report.c:139 [inline]
 [<ffffffff81740207>] print_address_description mm/kasan/report.c:179 [inline]
 [<ffffffff81740207>] kasan_report_error+0x1e7/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174089a>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174089a>] __asan_report_load_n_noabort+0x3a/0x40 mm/kasan/report.c:328
 [<ffffffff838f393f>] __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline]
 [<ffffffff838f393f>] mc_hash drivers/net/macvlan.c:225 [inline]
 [<ffffffff838f393f>] macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251
 [<ffffffff838f5206>] macvlan_queue_xmit drivers/net/macvlan.c:482 [inline]
 [<ffffffff838f5206>] macvlan_start_xmit+0x316/0x610 drivers/net/macvlan.c:525
 [<ffffffff8518c379>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff8518c379>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff8518c379>] packet_direct_xmit+0x429/0x610 net/packet/af_packet.c:271
 [<ffffffff851977b4>] packet_snd net/packet/af_packet.c:2938 [inline]
 [<ffffffff851977b4>] packet_sendmsg+0x1f94/0x4eb0 net/packet/af_packet.c:2963
 [<ffffffff8490e2a5>] sock_sendmsg_nosec net/socket.c:612 [inline]
 [<ffffffff8490e2a5>] sock_sendmsg+0xb5/0xf0 net/socket.c:622
 [<ffffffff8490f279>] SYSC_sendto+0x1c9/0x300 net/socket.c:1648
 [<ffffffff84911569>] SyS_sendto+0x9/0x10 net/socket.c:1616
 [<ffffffff85bb80c0>] entry_SYSCALL_64_fastpath+0x23/0xc1
Object at ffff8800adf90268, in cache ip_fib_alias
Object not allocated yet
Memory state around the buggy address:
 ffff8800adf90180: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
 ffff8800adf90200: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
>ffff8800adf90280: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
                   ^
 ffff8800adf90300: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
 ffff8800adf90380: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
==================================================================
==================================================================
BUG: KASAN: slab-out-of-bounds in __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline] at addr ffff8800adf90281
BUG: KASAN: slab-out-of-bounds in mc_hash drivers/net/macvlan.c:225 [inline] at addr ffff8800adf90281
BUG: KASAN: slab-out-of-bounds in macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251 at addr ffff8800adf90281
Read of size 4 by task syz-executor.4/7717
CPU: 1 PID: 7717 Comm: syz-executor.4 Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0dd577e ffff8800ad87f878 ffffffff82c7f386 ffff8800adf9027f
 ffff8800ad87f908 ffff8800adf90268 ffff8800bb9c4f00 ffff8800ad87f8f8
 ffffffff81740207 ffffffff816afd26 0000000000000286 0000000000000286
Call Trace:
 [<ffffffff82c7f386>] __dump_stack lib/dump_stack.c:15 [inline]
 [<ffffffff82c7f386>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff81740207>] object_err mm/kasan/report.c:139 [inline]
 [<ffffffff81740207>] print_address_description mm/kasan/report.c:179 [inline]
 [<ffffffff81740207>] kasan_report_error+0x1e7/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174089a>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174089a>] __asan_report_load_n_noabort+0x3a/0x40 mm/kasan/report.c:328
 [<ffffffff838f393f>] __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline]
 [<ffffffff838f393f>] mc_hash drivers/net/macvlan.c:225 [inline]
 [<ffffffff838f393f>] macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251
 [<ffffffff838f5206>] macvlan_queue_xmit drivers/net/macvlan.c:482 [inline]
 [<ffffffff838f5206>] macvlan_start_xmit+0x316/0x610 drivers/net/macvlan.c:525
 [<ffffffff8518c379>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff8518c379>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff8518c379>] packet_direct_xmit+0x429/0x610 net/packet/af_packet.c:271
 [<ffffffff851977b4>] packet_snd net/packet/af_packet.c:2938 [inline]
 [<ffffffff851977b4>] packet_sendmsg+0x1f94/0x4eb0 net/packet/af_packet.c:2963
 [<ffffffff8490e2a5>] sock_sendmsg_nosec net/socket.c:612 [inline]
 [<ffffffff8490e2a5>] sock_sendmsg+0xb5/0xf0 net/socket.c:622
 [<ffffffff8490f279>] SYSC_sendto+0x1c9/0x300 net/socket.c:1648
 [<ffffffff84911569>] SyS_sendto+0x9/0x10 net/socket.c:1616
 [<ffffffff85bb80c0>] entry_SYSCALL_64_fastpath+0x23/0xc1
Object at ffff8800adf90268, in cache ip_fib_alias
Object not allocated yet
Memory state around the buggy address:
 ffff8800adf90180: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
 ffff8800adf90200: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
>ffff8800adf90280: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
                   ^
 ffff8800adf90300: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
 ffff8800adf90380: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
==================================================================
==================================================================
BUG: KASAN: slab-out-of-bounds in __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline] at addr ffff8800adf90281
BUG: KASAN: slab-out-of-bounds in mc_hash drivers/net/macvlan.c:225 [inline] at addr ffff8800adf90281
BUG: KASAN: slab-out-of-bounds in macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251 at addr ffff8800adf90281
Read of size 4 by task syz-executor.4/7721
CPU: 1 PID: 7721 Comm: syz-executor.4 Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0dd577e ffff8800adf77878 ffffffff82c7f386 ffff8800adf9027f
 ffff8800adf77908 ffff8800adf90268 ffff8800bb9c4f00 ffff8800adf778f8
 ffffffff81740207 ffffffff816afd26 0000000000000286 0000000000000286
Call Trace:
 [<ffffffff82c7f386>] __dump_stack lib/dump_stack.c:15 [inline]
 [<ffffffff82c7f386>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff81740207>] object_err mm/kasan/report.c:139 [inline]
 [<ffffffff81740207>] print_address_description mm/kasan/report.c:179 [inline]
 [<ffffffff81740207>] kasan_report_error+0x1e7/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174089a>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174089a>] __asan_report_load_n_noabort+0x3a/0x40 mm/kasan/report.c:328
 [<ffffffff838f393f>] __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline]
 [<ffffffff838f393f>] mc_hash drivers/net/macvlan.c:225 [inline]
 [<ffffffff838f393f>] macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251
 [<ffffffff838f5206>] macvlan_queue_xmit drivers/net/macvlan.c:482 [inline]
 [<ffffffff838f5206>] macvlan_start_xmit+0x316/0x610 drivers/net/macvlan.c:525
 [<ffffffff8518c379>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff8518c379>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff8518c379>] packet_direct_xmit+0x429/0x610 net/packet/af_packet.c:271
 [<ffffffff851977b4>] packet_snd net/packet/af_packet.c:2938 [inline]
 [<ffffffff851977b4>] packet_sendmsg+0x1f94/0x4eb0 net/packet/af_packet.c:2963
 [<ffffffff8490e2a5>] sock_sendmsg_nosec net/socket.c:612 [inline]
 [<ffffffff8490e2a5>] sock_sendmsg+0xb5/0xf0 net/socket.c:622
 [<ffffffff8490f279>] SYSC_sendto+0x1c9/0x300 net/socket.c:1648
 [<ffffffff84911569>] SyS_sendto+0x9/0x10 net/socket.c:1616
 [<ffffffff85bb80c0>] entry_SYSCALL_64_fastpath+0x23/0xc1
Object at ffff8800adf90268, in cache ip_fib_alias
Object not allocated yet
Memory state around the buggy address:
 ffff8800adf90180: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
 ffff8800adf90200: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
>ffff8800adf90280: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
                   ^
 ffff8800adf90300: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
 ffff8800adf90380: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
==================================================================
==================================================================
BUG: KASAN: slab-out-of-bounds in __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline] at addr ffff8800adf90281
BUG: KASAN: slab-out-of-bounds in mc_hash drivers/net/macvlan.c:225 [inline] at addr ffff8800adf90281
BUG: KASAN: slab-out-of-bounds in macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251 at addr ffff8800adf90281
Read of size 4 by task syz-executor.4/7725
CPU: 1 PID: 7725 Comm: syz-executor.4 Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0dd577e ffff880128187878 ffffffff82c7f386 ffff8800adf9027f
 ffff880128187908 ffff8800adf90268 ffff8800bb9c4f00 ffff8801281878f8
 ffffffff81740207 ffffffff816afd26 0000000000000286 0000000000000286
Call Trace:
 [<ffffffff82c7f386>] __dump_stack lib/dump_stack.c:15 [inline]
 [<ffffffff82c7f386>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff81740207>] object_err mm/kasan/report.c:139 [inline]
 [<ffffffff81740207>] print_address_description mm/kasan/report.c:179 [inline]
 [<ffffffff81740207>] kasan_report_error+0x1e7/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174089a>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174089a>] __asan_report_load_n_noabort+0x3a/0x40 mm/kasan/report.c:328
 [<ffffffff838f393f>] __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline]
 [<ffffffff838f393f>] mc_hash drivers/net/macvlan.c:225 [inline]
 [<ffffffff838f393f>] macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251
 [<ffffffff838f5206>] macvlan_queue_xmit drivers/net/macvlan.c:482 [inline]
 [<ffffffff838f5206>] macvlan_start_xmit+0x316/0x610 drivers/net/macvlan.c:525
 [<ffffffff8518c379>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff8518c379>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff8518c379>] packet_direct_xmit+0x429/0x610 net/packet/af_packet.c:271
 [<ffffffff851977b4>] packet_snd net/packet/af_packet.c:2938 [inline]
 [<ffffffff851977b4>] packet_sendmsg+0x1f94/0x4eb0 net/packet/af_packet.c:2963
 [<ffffffff8490e2a5>] sock_sendmsg_nosec net/socket.c:612 [inline]
 [<ffffffff8490e2a5>] sock_sendmsg+0xb5/0xf0 net/socket.c:622
 [<ffffffff8490f279>] SYSC_sendto+0x1c9/0x300 net/socket.c:1648
 [<ffffffff84911569>] SyS_sendto+0x9/0x10 net/socket.c:1616
 [<ffffffff85bb80c0>] entry_SYSCALL_64_fastpath+0x23/0xc1
Object at ffff8800adf90268, in cache ip_fib_alias
Object not allocated yet
Memory state around the buggy address:
 ffff8800adf90180: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
 ffff8800adf90200: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
>ffff8800adf90280: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
                   ^
 ffff8800adf90300: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
 ffff8800adf90380: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
==================================================================
IPv6: ADDRCONF(NETDEV_CHANGE): veth0_virt_wifi: link becomes ready
IPv6: ADDRCONF(NETDEV_CHANGE): veth0_vlan: link becomes ready
IPv6: ADDRCONF(NETDEV_CHANGE): vlan0: link becomes ready
IPv6: ADDRCONF(NETDEV_CHANGE): vlan1: link becomes ready
device veth1_vlan entered promiscuous mode
IPv6: ADDRCONF(NETDEV_UP): veth0_vlan: link is not ready
device veth0_vlan entered promiscuous mode
IPv6: ADDRCONF(NETDEV_UP): vlan0: link is not ready
IPv6: ADDRCONF(NETDEV_UP): vlan1: link is not ready
IPv6: ADDRCONF(NETDEV_CHANGE): veth0_vlan: link becomes ready
device veth1_vlan entered promiscuous mode
IPv6: ADDRCONF(NETDEV_CHANGE): vlan0: link becomes ready
IPv6: ADDRCONF(NETDEV_CHANGE): vlan1: link becomes ready
IPv6: ADDRCONF(NETDEV_UP): veth0_virt_wifi: link is not ready
IPv6: ADDRCONF(NETDEV_CHANGE): veth0_virt_wifi: link becomes ready
IPv6: ADDRCONF(NETDEV_UP): veth0_virt_wifi: link is not ready
IPv6: ADDRCONF(NETDEV_UP): veth0_vlan: link is not ready
device veth0_vlan entered promiscuous mode
IPv6: ADDRCONF(NETDEV_UP): vlan0: link is not ready
IPv6: ADDRCONF(NETDEV_UP): vlan1: link is not ready
==================================================================
BUG: KASAN: use-after-free in __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline] at addr ffff8800adf81a81
BUG: KASAN: use-after-free in mc_hash drivers/net/macvlan.c:225 [inline] at addr ffff8800adf81a81
BUG: KASAN: use-after-free in macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251 at addr ffff8800adf81a81
IPv6: ADDRCONF(NETDEV_CHANGE): veth0_virt_wifi: link becomes ready
IPv6: ADDRCONF(NETDEV_CHANGE): veth0_vlan: link becomes ready
IPv6: ADDRCONF(NETDEV_CHANGE): vlan0: link becomes ready
IPv6: ADDRCONF(NETDEV_CHANGE): vlan1: link becomes ready
Read of size 4 by task syz-executor.3/7811
device veth1_vlan entered promiscuous mode
page:ffffea0002b7e040 count:0 mapcount:0 mapping:          (null) index:0x0
flags: 0xfffe0000000000()
page dumped because: kasan: bad access detected
CPU: 0 PID: 7811 Comm: syz-executor.3 Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0dd577e ffff8800ad827878 ffffffff82c7f386 ffff8800adf81a7f
 ffff8800ad827908 ffff8800adf81a81 ffff8800b19862c0 ffff8800ad8278f8
 ffffffff817405ba ffffffff816afd26 0000000000000286 0000000000000286
Call Trace:
 [<ffffffff82c7f386>] __dump_stack lib/dump_stack.c:15 [inline]
 [<ffffffff82c7f386>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff817405ba>] print_address_description mm/kasan/report.c:190 [inline]
 [<ffffffff817405ba>] kasan_report_error+0x59a/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174089a>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174089a>] __asan_report_load_n_noabort+0x3a/0x40 mm/kasan/report.c:328
IPv6: ADDRCONF(NETDEV_UP): veth0_virt_wifi: link is not ready
 [<ffffffff838f393f>] __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline]
 [<ffffffff838f393f>] mc_hash drivers/net/macvlan.c:225 [inline]
 [<ffffffff838f393f>] macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251
IPv6: ADDRCONF(NETDEV_CHANGE): veth0_virt_wifi: link becomes ready
 [<ffffffff838f5206>] macvlan_queue_xmit drivers/net/macvlan.c:482 [inline]
 [<ffffffff838f5206>] macvlan_start_xmit+0x316/0x610 drivers/net/macvlan.c:525
 [<ffffffff8518c379>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff8518c379>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff8518c379>] packet_direct_xmit+0x429/0x610 net/packet/af_packet.c:271
 [<ffffffff851977b4>] packet_snd net/packet/af_packet.c:2938 [inline]
 [<ffffffff851977b4>] packet_sendmsg+0x1f94/0x4eb0 net/packet/af_packet.c:2963
IPv6: ADDRCONF(NETDEV_UP): veth0_vlan: link is not ready
device veth0_vlan entered promiscuous mode
IPv6: ADDRCONF(NETDEV_UP): vlan0: link is not ready
IPv6: ADDRCONF(NETDEV_UP): vlan1: link is not ready
IPv6: ADDRCONF(NETDEV_CHANGE): veth0_vlan: link becomes ready
IPv6: ADDRCONF(NETDEV_CHANGE): vlan0: link becomes ready
IPv6: ADDRCONF(NETDEV_CHANGE): vlan1: link becomes ready
 [<ffffffff8490e2a5>] sock_sendmsg_nosec net/socket.c:612 [inline]
 [<ffffffff8490e2a5>] sock_sendmsg+0xb5/0xf0 net/socket.c:622
 [<ffffffff8490f279>] SYSC_sendto+0x1c9/0x300 net/socket.c:1648
 [<ffffffff84911569>] SyS_sendto+0x9/0x10 net/socket.c:1616
 [<ffffffff85bb80c0>] entry_SYSCALL_64_fastpath+0x23/0xc1
Memory state around the buggy address:
 ffff8800adf81980: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
 ffff8800adf81a00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
>ffff8800adf81a80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
                   ^
 ffff8800adf81b00: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8800adf81b80: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
IPv6: ADDRCONF(NETDEV_UP): veth0_vlan: link is not ready
device veth0_vlan entered promiscuous mode
IPv6: ADDRCONF(NETDEV_UP): vlan0: link is not ready
IPv6: ADDRCONF(NETDEV_UP): vlan1: link is not ready
IPv6: ADDRCONF(NETDEV_CHANGE): veth0_vlan: link becomes ready
IPv6: ADDRCONF(NETDEV_CHANGE): vlan0: link becomes ready
IPv6: ADDRCONF(NETDEV_CHANGE): vlan1: link becomes ready
device veth1_vlan entered promiscuous mode
==================================================================
device veth1_vlan entered promiscuous mode
==================================================================
BUG: KASAN: use-after-free in __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline] at addr ffff8800ad955ac1
BUG: KASAN: use-after-free in mc_hash drivers/net/macvlan.c:225 [inline] at addr ffff8800ad955ac1
BUG: KASAN: use-after-free in macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251 at addr ffff8800ad955ac1
Read of size 4 by task syz-executor.2/7865
CPU: 1 PID: 7865 Comm: syz-executor.2 Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0dd577e ffff8800ad9df878 ffffffff82c7f386 ffff8800ad955abf
 ffff8800ad9df908 ffff8800ad9546c0 ffff88012bd1ab00 ffff8800ad9df8f8
 ffffffff81740207 ffffffff816afd26 0000000000000286 0000000000000286
Call Trace:
 [<ffffffff82c7f386>] __dump_stack lib/dump_stack.c:15 [inline]
 [<ffffffff82c7f386>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff81740207>] object_err mm/kasan/report.c:139 [inline]
 [<ffffffff81740207>] print_address_description mm/kasan/report.c:179 [inline]
 [<ffffffff81740207>] kasan_report_error+0x1e7/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174089a>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174089a>] __asan_report_load_n_noabort+0x3a/0x40 mm/kasan/report.c:328
 [<ffffffff838f393f>] __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline]
 [<ffffffff838f393f>] mc_hash drivers/net/macvlan.c:225 [inline]
 [<ffffffff838f393f>] macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251
 [<ffffffff838f5206>] macvlan_queue_xmit drivers/net/macvlan.c:482 [inline]
 [<ffffffff838f5206>] macvlan_start_xmit+0x316/0x610 drivers/net/macvlan.c:525
 [<ffffffff8518c379>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff8518c379>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff8518c379>] packet_direct_xmit+0x429/0x610 net/packet/af_packet.c:271
 [<ffffffff851977b4>] packet_snd net/packet/af_packet.c:2938 [inline]
 [<ffffffff851977b4>] packet_sendmsg+0x1f94/0x4eb0 net/packet/af_packet.c:2963
 [<ffffffff8490e2a5>] sock_sendmsg_nosec net/socket.c:612 [inline]
 [<ffffffff8490e2a5>] sock_sendmsg+0xb5/0xf0 net/socket.c:622
 [<ffffffff8490f279>] SYSC_sendto+0x1c9/0x300 net/socket.c:1648
 [<ffffffff84911569>] SyS_sendto+0x9/0x10 net/socket.c:1616
 [<ffffffff85bb80c0>] entry_SYSCALL_64_fastpath+0x23/0xc1
Object at ffff8800ad9546c0, in cache task_struct
Object freed, allocated with size 5888 bytes
Allocation:
PID = 2261
 [<ffffffff81205056>] save_stack_trace+0x26/0x50 arch/x86/kernel/stacktrace.c:67
 [<ffffffff8173f3e6>] save_stack+0x46/0xd0 mm/kasan/kasan.c:450
 [<ffffffff8173f7a9>] set_track mm/kasan/kasan.c:462 [inline]
 [<ffffffff8173f7a9>] kasan_kmalloc+0xc9/0xe0 mm/kasan/kasan.c:532
 [<ffffffff8173fbe2>] kasan_slab_alloc+0x12/0x20 mm/kasan/kasan.c:482
 [<ffffffff8173aa54>] kmem_cache_alloc_node+0x154/0x6b0 mm/slab.c:3471
 [<ffffffff81338fcd>] alloc_task_struct_node kernel/fork.c:142 [inline]
 [<ffffffff81338fcd>] dup_task_struct kernel/fork.c:350 [inline]
 [<ffffffff81338fcd>] copy_process.part.37+0x1fd/0x5ae0 kernel/fork.c:1311
 [<ffffffff8133eca8>] copy_process kernel/fork.c:1282 [inline]
 [<ffffffff8133eca8>] _do_fork+0x158/0xbb0 kernel/fork.c:1731
 [<ffffffff8133f724>] kernel_thread+0x24/0x30 kernel/fork.c:1792
 [<ffffffff813842db>] call_usermodehelper_exec_sync kernel/kmod.c:275 [inline]
 [<ffffffff813842db>] call_usermodehelper_exec_work+0xdb/0x1f0 kernel/kmod.c:327
 [<ffffffff8139210b>] process_one_work+0x69b/0x1570 kernel/workqueue.c:2122
 [<ffffffff813930b7>] worker_thread+0xd7/0xf10 kernel/workqueue.c:2256
 [<ffffffff813a3a09>] kthread+0x209/0x2d0 kernel/kthread.c:209
 [<ffffffff85bb8312>] ret_from_fork+0x22/0x50 arch/x86/entry/entry_64.S:392
Deallocation:
PID = 2261
 [<ffffffff81205056>] save_stack_trace+0x26/0x50 arch/x86/kernel/stacktrace.c:67
 [<ffffffff8173f3e6>] save_stack+0x46/0xd0 mm/kasan/kasan.c:450
 [<ffffffff8173fc8b>] set_track mm/kasan/kasan.c:462 [inline]
 [<ffffffff8173fc8b>] kasan_slab_free+0x9b/0xb0 mm/kasan/kasan.c:501
 [<ffffffff81738e74>] __cache_free mm/slab.c:3332 [inline]
 [<ffffffff81738e74>] kmem_cache_free+0x94/0x500 mm/slab.c:3583
 [<ffffffff81338370>] free_task_struct kernel/fork.c:147 [inline]
 [<ffffffff81338370>] free_task+0xd0/0x170 kernel/fork.c:240
 [<ffffffff8133858e>] __put_task_struct+0x17e/0x390 kernel/fork.c:271
 [<ffffffff813479f8>] put_task_struct include/linux/sched.h:2068 [inline]
 [<ffffffff813479f8>] delayed_put_task_struct+0x148/0x2b0 kernel/exit.c:164
 [<ffffffff8148c603>] __rcu_reclaim kernel/rcu/rcu.h:118 [inline]
 [<ffffffff8148c603>] rcu_do_batch kernel/rcu/tree.c:2681 [inline]
 [<ffffffff8148c603>] invoke_rcu_callbacks kernel/rcu/tree.c:2947 [inline]
 [<ffffffff8148c603>] __rcu_process_callbacks kernel/rcu/tree.c:2914 [inline]
 [<ffffffff8148c603>] rcu_process_callbacks+0xe73/0x15d0 kernel/rcu/tree.c:2931
 [<ffffffff85bbb26c>] __do_softirq+0x2cc/0xa06 kernel/softirq.c:273
Memory state around the buggy address:
 ffff8800ad955980: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ffff8800ad955a00: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
>ffff8800ad955a80: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
                                           ^
 ffff8800ad955b00: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ffff8800ad955b80: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
==================================================================
==================================================================
BUG: KASAN: slab-out-of-bounds in __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline] at addr ffff8800ad95a0c1
BUG: KASAN: slab-out-of-bounds in mc_hash drivers/net/macvlan.c:225 [inline] at addr ffff8800ad95a0c1
BUG: KASAN: slab-out-of-bounds in macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251 at addr ffff8800ad95a0c1
Read of size 4 by task syz-executor.3/7879
CPU: 1 PID: 7879 Comm: syz-executor.3 Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0dd577e ffff8800ada47878 ffffffff82c7f386 ffff8800ad95a0bf
 ffff8800ada47908 ffff8800ad95a080 ffff88012bc00200 ffff8800ada478f8
 ffffffff81740207 ffffffff816afd26 0000000000000286 0000000000000286
Call Trace:
 [<ffffffff82c7f386>] __dump_stack lib/dump_stack.c:15 [inline]
 [<ffffffff82c7f386>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff81740207>] object_err mm/kasan/report.c:139 [inline]
 [<ffffffff81740207>] print_address_description mm/kasan/report.c:179 [inline]
 [<ffffffff81740207>] kasan_report_error+0x1e7/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174089a>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174089a>] __asan_report_load_n_noabort+0x3a/0x40 mm/kasan/report.c:328
 [<ffffffff838f393f>] __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline]
 [<ffffffff838f393f>] mc_hash drivers/net/macvlan.c:225 [inline]
 [<ffffffff838f393f>] macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251
 [<ffffffff838f5206>] macvlan_queue_xmit drivers/net/macvlan.c:482 [inline]
 [<ffffffff838f5206>] macvlan_start_xmit+0x316/0x610 drivers/net/macvlan.c:525
 [<ffffffff8518c379>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff8518c379>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff8518c379>] packet_direct_xmit+0x429/0x610 net/packet/af_packet.c:271
 [<ffffffff851977b4>] packet_snd net/packet/af_packet.c:2938 [inline]
 [<ffffffff851977b4>] packet_sendmsg+0x1f94/0x4eb0 net/packet/af_packet.c:2963
 [<ffffffff8490e2a5>] sock_sendmsg_nosec net/socket.c:612 [inline]
 [<ffffffff8490e2a5>] sock_sendmsg+0xb5/0xf0 net/socket.c:622
 [<ffffffff8490f279>] SYSC_sendto+0x1c9/0x300 net/socket.c:1648
 [<ffffffff84911569>] SyS_sendto+0x9/0x10 net/socket.c:1616
 [<ffffffff85bb80c0>] entry_SYSCALL_64_fastpath+0x23/0xc1
Object at ffff8800ad95a080, in cache kmalloc-64
Object allocated with size 64 bytes.
Allocation:
PID = 4
 [<ffffffff81205056>] save_stack_trace+0x26/0x50 arch/x86/kernel/stacktrace.c:67
 [<ffffffff8173f3e6>] save_stack+0x46/0xd0 mm/kasan/kasan.c:450
 [<ffffffff8173f7a9>] set_track mm/kasan/kasan.c:462 [inline]
 [<ffffffff8173f7a9>] kasan_kmalloc+0xc9/0xe0 mm/kasan/kasan.c:532
 [<ffffffff8173cdd2>] kmem_cache_alloc_trace+0x142/0x6b0 mm/slab.c:3447
 [<ffffffff84991c53>] kmalloc include/linux/slab.h:478 [inline]
 [<ffffffff84991c53>] dst_cow_metrics_generic+0x43/0xb0 net/core/dst.c:318
 [<ffffffff850669ff>] ipv6_cow_metrics+0x5f/0x150 net/ipv6/route.c:188
 [<ffffffff85072333>] dst_metrics_write_ptr include/net/dst.h:143 [inline]
 [<ffffffff85072333>] dst_metric_set include/net/dst.h:204 [inline]
 [<ffffffff85072333>] icmp6_dst_alloc+0x463/0x560 net/ipv6/route.c:1637
 [<ffffffff8508bb33>] ndisc_send_skb+0xb13/0x1010 net/ipv6/ndisc.c:451
 [<ffffffff8508f643>] ndisc_send_ns+0x283/0x6e0 net/ipv6/ndisc.c:595
 [<ffffffff85056095>] addrconf_dad_work+0x645/0x980 net/ipv6/addrconf.c:3813
 [<ffffffff8139210b>] process_one_work+0x69b/0x1570 kernel/workqueue.c:2122
 [<ffffffff813930b7>] worker_thread+0xd7/0xf10 kernel/workqueue.c:2256
 [<ffffffff813a3a09>] kthread+0x209/0x2d0 kernel/kthread.c:209
 [<ffffffff85bb8312>] ret_from_fork+0x22/0x50 arch/x86/entry/entry_64.S:392
Memory state around the buggy address:
 ffff8800ad959f80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
 ffff8800ad95a000: 00 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc
>ffff8800ad95a080: 00 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc
                                           ^
 ffff8800ad95a100: 00 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc
 ffff8800ad95a180: 00 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc
==================================================================
==================================================================
BUG: KASAN: use-after-free in __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline] at addr ffff8800ad958281
BUG: KASAN: use-after-free in mc_hash drivers/net/macvlan.c:225 [inline] at addr ffff8800ad958281
BUG: KASAN: use-after-free in macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251 at addr ffff8800ad958281
Read of size 4 by task syz-executor.1/7924
page:ffffea0002b65600 count:0 mapcount:0 mapping:          (null) index:0x0
flags: 0xfffe0000000000()
page dumped because: kasan: bad access detected
CPU: 1 PID: 7924 Comm: syz-executor.1 Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0dd577e ffff8800ad9ef878 ffffffff82c7f386 ffff8800ad95827f
 ffff8800ad9ef908 ffff8800ad958281 ffff8800b1b76340 ffff8800ad9ef8f8
 ffffffff817405ba ffffffff816afd26 0000000000000286 0000000000000286
Call Trace:
 [<ffffffff82c7f386>] __dump_stack lib/dump_stack.c:15 [inline]
 [<ffffffff82c7f386>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff817405ba>] print_address_description mm/kasan/report.c:190 [inline]
 [<ffffffff817405ba>] kasan_report_error+0x59a/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174089a>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174089a>] __asan_report_load_n_noabort+0x3a/0x40 mm/kasan/report.c:328
 [<ffffffff838f393f>] __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline]
 [<ffffffff838f393f>] mc_hash drivers/net/macvlan.c:225 [inline]
 [<ffffffff838f393f>] macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251
 [<ffffffff838f5206>] macvlan_queue_xmit drivers/net/macvlan.c:482 [inline]
 [<ffffffff838f5206>] macvlan_start_xmit+0x316/0x610 drivers/net/macvlan.c:525
 [<ffffffff8518c379>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff8518c379>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff8518c379>] packet_direct_xmit+0x429/0x610 net/packet/af_packet.c:271
 [<ffffffff851977b4>] packet_snd net/packet/af_packet.c:2938 [inline]
 [<ffffffff851977b4>] packet_sendmsg+0x1f94/0x4eb0 net/packet/af_packet.c:2963
 [<ffffffff8490e2a5>] sock_sendmsg_nosec net/socket.c:612 [inline]
 [<ffffffff8490e2a5>] sock_sendmsg+0xb5/0xf0 net/socket.c:622
 [<ffffffff8490f279>] SYSC_sendto+0x1c9/0x300 net/socket.c:1648
 [<ffffffff84911569>] SyS_sendto+0x9/0x10 net/socket.c:1616
 [<ffffffff85bb80c0>] entry_SYSCALL_64_fastpath+0x23/0xc1
Memory state around the buggy address:
 ffff8800ad958180: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8800ad958200: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
>ffff8800ad958280: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
                   ^
 ffff8800ad958300: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8800ad958380: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
==================================================================
==================================================================
BUG: KASAN: use-after-free in __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline] at addr ffff8800ad959341
BUG: KASAN: use-after-free in mc_hash drivers/net/macvlan.c:225 [inline] at addr ffff8800ad959341
BUG: KASAN: use-after-free in macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251 at addr ffff8800ad959341
Read of size 4 by task syz-executor.5/7934
page:ffffea0002b65640 count:0 mapcount:0 mapping:          (null) index:0x0
flags: 0xfffe0000000000()
page dumped because: kasan: bad access detected
CPU: 0 PID: 7934 Comm: syz-executor.5 Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0dd577e ffff8800ad89f878 ffffffff82c7f386 ffff8800ad95933f
 ffff8800ad89f908 ffff8800ad959341 ffff8800ade224c0 ffff8800ad89f8f8
 ffffffff817405ba ffffffff816afd26 0000000000000286 0000000000000286
Call Trace:
 [<ffffffff82c7f386>] __dump_stack lib/dump_stack.c:15 [inline]
 [<ffffffff82c7f386>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff817405ba>] print_address_description mm/kasan/report.c:190 [inline]
 [<ffffffff817405ba>] kasan_report_error+0x59a/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174089a>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174089a>] __asan_report_load_n_noabort+0x3a/0x40 mm/kasan/report.c:328
 [<ffffffff838f393f>] __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline]
 [<ffffffff838f393f>] mc_hash drivers/net/macvlan.c:225 [inline]
 [<ffffffff838f393f>] macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251
 [<ffffffff838f5206>] macvlan_queue_xmit drivers/net/macvlan.c:482 [inline]
 [<ffffffff838f5206>] macvlan_start_xmit+0x316/0x610 drivers/net/macvlan.c:525
 [<ffffffff8518c379>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff8518c379>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff8518c379>] packet_direct_xmit+0x429/0x610 net/packet/af_packet.c:271
 [<ffffffff851977b4>] packet_snd net/packet/af_packet.c:2938 [inline]
 [<ffffffff851977b4>] packet_sendmsg+0x1f94/0x4eb0 net/packet/af_packet.c:2963
 [<ffffffff8490e2a5>] sock_sendmsg_nosec net/socket.c:612 [inline]
 [<ffffffff8490e2a5>] sock_sendmsg+0xb5/0xf0 net/socket.c:622
 [<ffffffff8490f279>] SYSC_sendto+0x1c9/0x300 net/socket.c:1648
 [<ffffffff84911569>] SyS_sendto+0x9/0x10 net/socket.c:1616
 [<ffffffff85bb80c0>] entry_SYSCALL_64_fastpath+0x23/0xc1
Memory state around the buggy address:
 ffff8800ad959200: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8800ad959280: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
>ffff8800ad959300: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
                                           ^
 ffff8800ad959380: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8800ad959400: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
==================================================================
==================================================================
BUG: KASAN: slab-out-of-bounds in __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline] at addr ffff8800ad95a5c1
BUG: KASAN: slab-out-of-bounds in mc_hash drivers/net/macvlan.c:225 [inline] at addr ffff8800ad95a5c1
BUG: KASAN: slab-out-of-bounds in macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251 at addr ffff8800ad95a5c1
Read of size 4 by task syz-executor.4/7930
CPU: 1 PID: 7930 Comm: syz-executor.4 Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0dd577e ffff8800ada8f878 ffffffff82c7f386 ffff8800ad95a5bf
 ffff8800ada8f908 ffff8800ad95a580 ffff88012bc00200 ffff8800ada8f8f8
 ffffffff81740207 ffffffff816afd26 0000000000000286 0000000000000286
Call Trace:
 [<ffffffff82c7f386>] __dump_stack lib/dump_stack.c:15 [inline]
 [<ffffffff82c7f386>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff81740207>] object_err mm/kasan/report.c:139 [inline]
 [<ffffffff81740207>] print_address_description mm/kasan/report.c:179 [inline]
 [<ffffffff81740207>] kasan_report_error+0x1e7/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174089a>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174089a>] __asan_report_load_n_noabort+0x3a/0x40 mm/kasan/report.c:328
 [<ffffffff838f393f>] __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline]
 [<ffffffff838f393f>] mc_hash drivers/net/macvlan.c:225 [inline]
 [<ffffffff838f393f>] macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251
 [<ffffffff838f5206>] macvlan_queue_xmit drivers/net/macvlan.c:482 [inline]
 [<ffffffff838f5206>] macvlan_start_xmit+0x316/0x610 drivers/net/macvlan.c:525
 [<ffffffff8518c379>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff8518c379>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff8518c379>] packet_direct_xmit+0x429/0x610 net/packet/af_packet.c:271
 [<ffffffff851977b4>] packet_snd net/packet/af_packet.c:2938 [inline]
 [<ffffffff851977b4>] packet_sendmsg+0x1f94/0x4eb0 net/packet/af_packet.c:2963
 [<ffffffff8490e2a5>] sock_sendmsg_nosec net/socket.c:612 [inline]
 [<ffffffff8490e2a5>] sock_sendmsg+0xb5/0xf0 net/socket.c:622
 [<ffffffff8490f279>] SYSC_sendto+0x1c9/0x300 net/socket.c:1648
 [<ffffffff84911569>] SyS_sendto+0x9/0x10 net/socket.c:1616
 [<ffffffff85bb80c0>] entry_SYSCALL_64_fastpath+0x23/0xc1
Object at ffff8800ad95a580, in cache kmalloc-64
Object allocated with size 64 bytes.
Allocation:
PID = 4
 [<ffffffff81205056>] save_stack_trace+0x26/0x50 arch/x86/kernel/stacktrace.c:67
 [<ffffffff8173f3e6>] save_stack+0x46/0xd0 mm/kasan/kasan.c:450
 [<ffffffff8173f7a9>] set_track mm/kasan/kasan.c:462 [inline]
 [<ffffffff8173f7a9>] kasan_kmalloc+0xc9/0xe0 mm/kasan/kasan.c:532
 [<ffffffff8173cdd2>] kmem_cache_alloc_trace+0x142/0x6b0 mm/slab.c:3447
 [<ffffffff84991c53>] kmalloc include/linux/slab.h:478 [inline]
 [<ffffffff84991c53>] dst_cow_metrics_generic+0x43/0xb0 net/core/dst.c:318
 [<ffffffff850669ff>] ipv6_cow_metrics+0x5f/0x150 net/ipv6/route.c:188
 [<ffffffff85072333>] dst_metrics_write_ptr include/net/dst.h:143 [inline]
 [<ffffffff85072333>] dst_metric_set include/net/dst.h:204 [inline]
 [<ffffffff85072333>] icmp6_dst_alloc+0x463/0x560 net/ipv6/route.c:1637
 [<ffffffff850b6e28>] mld_sendpack+0x578/0xb80 net/ipv6/mcast.c:1633
 [<ffffffff850b83c4>] mld_send_initial_cr.part.30+0xd4/0x110 net/ipv6/mcast.c:2049
 [<ffffffff850c2465>] mld_send_initial_cr net/ipv6/mcast.c:2033 [inline]
 [<ffffffff850c2465>] ipv6_mc_dad_complete+0x85/0x110 net/ipv6/mcast.c:2056
 [<ffffffff850556df>] addrconf_dad_completed+0x3ef/0x760 net/ipv6/addrconf.c:3867
 [<ffffffff8505621b>] addrconf_dad_work+0x7cb/0x980 net/ipv6/addrconf.c:3800
 [<ffffffff8139210b>] process_one_work+0x69b/0x1570 kernel/workqueue.c:2122
 [<ffffffff813930b7>] worker_thread+0xd7/0xf10 kernel/workqueue.c:2256
 [<ffffffff813a3a09>] kthread+0x209/0x2d0 kernel/kthread.c:209
 [<ffffffff85bb8312>] ret_from_fork+0x22/0x50 arch/x86/entry/entry_64.S:392
Memory state around the buggy address:
 ffff8800ad95a480: 00 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc
 ffff8800ad95a500: 00 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc
>ffff8800ad95a580: 00 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc
                                           ^
 ffff8800ad95a600: 00 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc
 ffff8800ad95a680: 00 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc
==================================================================
==================================================================
BUG: KASAN: use-after-free in __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline] at addr ffff8800ad958001
BUG: KASAN: use-after-free in mc_hash drivers/net/macvlan.c:225 [inline] at addr ffff8800ad958001
BUG: KASAN: use-after-free in macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251 at addr ffff8800ad958001
Read of size 4 by task syz-executor.4/7958
page:ffffea0002b65600 count:0 mapcount:0 mapping:          (null) index:0x0
flags: 0xfffe0000000000()
page dumped because: kasan: bad access detected
CPU: 1 PID: 7958 Comm: syz-executor.4 Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0dd577e ffff8800ada8f878 ffffffff82c7f386 ffff8800ad957fff
 ffff8800ada8f908 ffff8800ad958001 ffff8800ae6ca100 ffff8800ada8f8f8
 ffffffff817405ba ffffffff816afd26 0000000000000286 0000000000000286
Call Trace:
 [<ffffffff82c7f386>] __dump_stack lib/dump_stack.c:15 [inline]
 [<ffffffff82c7f386>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff817405ba>] print_address_description mm/kasan/report.c:190 [inline]
 [<ffffffff817405ba>] kasan_report_error+0x59a/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174089a>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174089a>] __asan_report_load_n_noabort+0x3a/0x40 mm/kasan/report.c:328
 [<ffffffff838f393f>] __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline]
 [<ffffffff838f393f>] mc_hash drivers/net/macvlan.c:225 [inline]
 [<ffffffff838f393f>] macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251
 [<ffffffff838f5206>] macvlan_queue_xmit drivers/net/macvlan.c:482 [inline]
 [<ffffffff838f5206>] macvlan_start_xmit+0x316/0x610 drivers/net/macvlan.c:525
 [<ffffffff8518c379>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff8518c379>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff8518c379>] packet_direct_xmit+0x429/0x610 net/packet/af_packet.c:271
 [<ffffffff851977b4>] packet_snd net/packet/af_packet.c:2938 [inline]
 [<ffffffff851977b4>] packet_sendmsg+0x1f94/0x4eb0 net/packet/af_packet.c:2963
 [<ffffffff8490e2a5>] sock_sendmsg_nosec net/socket.c:612 [inline]
 [<ffffffff8490e2a5>] sock_sendmsg+0xb5/0xf0 net/socket.c:622
 [<ffffffff8490f279>] SYSC_sendto+0x1c9/0x300 net/socket.c:1648
 [<ffffffff84911569>] SyS_sendto+0x9/0x10 net/socket.c:1616
 [<ffffffff85bb80c0>] entry_SYSCALL_64_fastpath+0x23/0xc1
Memory state around the buggy address:
 ffff8800ad957f00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
 ffff8800ad957f80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
>ffff8800ad958000: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
                   ^
 ffff8800ad958080: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8800ad958100: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
==================================================================
==================================================================
BUG: KASAN: slab-out-of-bounds in __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline] at addr ffff8800ad95a0c1
BUG: KASAN: slab-out-of-bounds in mc_hash drivers/net/macvlan.c:225 [inline] at addr ffff8800ad95a0c1
BUG: KASAN: slab-out-of-bounds in macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251 at addr ffff8800ad95a0c1
Read of size 4 by task syz-executor.3/7970
CPU: 0 PID: 7970 Comm: syz-executor.3 Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0dd577e ffff8800adaa7878 ffffffff82c7f386 ffff8800ad95a0bf
 ffff8800adaa7908 ffff8800ad95a080 ffff88012bc00200 ffff8800adaa78f8
 ffffffff81740207 ffffffff816afd26 0000000000000286 0000000000000286
Call Trace:
 [<ffffffff82c7f386>] __dump_stack lib/dump_stack.c:15 [inline]
 [<ffffffff82c7f386>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff81740207>] object_err mm/kasan/report.c:139 [inline]
 [<ffffffff81740207>] print_address_description mm/kasan/report.c:179 [inline]
 [<ffffffff81740207>] kasan_report_error+0x1e7/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174089a>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174089a>] __asan_report_load_n_noabort+0x3a/0x40 mm/kasan/report.c:328
 [<ffffffff838f393f>] __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline]
 [<ffffffff838f393f>] mc_hash drivers/net/macvlan.c:225 [inline]
 [<ffffffff838f393f>] macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251
 [<ffffffff838f5206>] macvlan_queue_xmit drivers/net/macvlan.c:482 [inline]
 [<ffffffff838f5206>] macvlan_start_xmit+0x316/0x610 drivers/net/macvlan.c:525
 [<ffffffff8518c379>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff8518c379>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff8518c379>] packet_direct_xmit+0x429/0x610 net/packet/af_packet.c:271
 [<ffffffff851977b4>] packet_snd net/packet/af_packet.c:2938 [inline]
 [<ffffffff851977b4>] packet_sendmsg+0x1f94/0x4eb0 net/packet/af_packet.c:2963
 [<ffffffff8490e2a5>] sock_sendmsg_nosec net/socket.c:612 [inline]
 [<ffffffff8490e2a5>] sock_sendmsg+0xb5/0xf0 net/socket.c:622
 [<ffffffff8490f279>] SYSC_sendto+0x1c9/0x300 net/socket.c:1648
 [<ffffffff84911569>] SyS_sendto+0x9/0x10 net/socket.c:1616
 [<ffffffff85bb80c0>] entry_SYSCALL_64_fastpath+0x23/0xc1
Object at ffff8800ad95a080, in cache kmalloc-64
Object allocated with size 64 bytes.
Allocation:
PID = 4
 [<ffffffff81205056>] save_stack_trace+0x26/0x50 arch/x86/kernel/stacktrace.c:67
 [<ffffffff8173f3e6>] save_stack+0x46/0xd0 mm/kasan/kasan.c:450
 [<ffffffff8173f7a9>] set_track mm/kasan/kasan.c:462 [inline]
 [<ffffffff8173f7a9>] kasan_kmalloc+0xc9/0xe0 mm/kasan/kasan.c:532
 [<ffffffff8173cdd2>] kmem_cache_alloc_trace+0x142/0x6b0 mm/slab.c:3447
 [<ffffffff84991c53>] kmalloc include/linux/slab.h:478 [inline]
 [<ffffffff84991c53>] dst_cow_metrics_generic+0x43/0xb0 net/core/dst.c:318
 [<ffffffff850669ff>] ipv6_cow_metrics+0x5f/0x150 net/ipv6/route.c:188
 [<ffffffff85072333>] dst_metrics_write_ptr include/net/dst.h:143 [inline]
 [<ffffffff85072333>] dst_metric_set include/net/dst.h:204 [inline]
 [<ffffffff85072333>] icmp6_dst_alloc+0x463/0x560 net/ipv6/route.c:1637
 [<ffffffff8508bb33>] ndisc_send_skb+0xb13/0x1010 net/ipv6/ndisc.c:451
 [<ffffffff8508f643>] ndisc_send_ns+0x283/0x6e0 net/ipv6/ndisc.c:595
 [<ffffffff85056095>] addrconf_dad_work+0x645/0x980 net/ipv6/addrconf.c:3813
 [<ffffffff8139210b>] process_one_work+0x69b/0x1570 kernel/workqueue.c:2122
 [<ffffffff813930b7>] worker_thread+0xd7/0xf10 kernel/workqueue.c:2256
 [<ffffffff813a3a09>] kthread+0x209/0x2d0 kernel/kthread.c:209
 [<ffffffff85bb8312>] ret_from_fork+0x22/0x50 arch/x86/entry/entry_64.S:392
Memory state around the buggy address:
 ffff8800ad959f80: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8800ad95a000: 00 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc
>ffff8800ad95a080: 00 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc
                                           ^
 ffff8800ad95a100: 00 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc
 ffff8800ad95a180: 00 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc
==================================================================
==================================================================
BUG: KASAN: slab-out-of-bounds in __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline] at addr ffff8800ad84e341
BUG: KASAN: slab-out-of-bounds in mc_hash drivers/net/macvlan.c:225 [inline] at addr ffff8800ad84e341
BUG: KASAN: slab-out-of-bounds in macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251 at addr ffff8800ad84e341
Read of size 4 by task syz-executor.1/7975
CPU: 0 PID: 7975 Comm: syz-executor.1 Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0dd577e ffff8800ada87878 ffffffff82c7f386 ffff8800ad84e33f
 ffff8800ada87908 ffff8800ad84e040 ffff88012bc00700 ffff8800ada878f8
 ffffffff81740207 ffffffff816afd26 0000000000000286 0000000000000286
Call Trace:
 [<ffffffff82c7f386>] __dump_stack lib/dump_stack.c:15 [inline]
 [<ffffffff82c7f386>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff81740207>] object_err mm/kasan/report.c:139 [inline]
 [<ffffffff81740207>] print_address_description mm/kasan/report.c:179 [inline]
 [<ffffffff81740207>] kasan_report_error+0x1e7/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174089a>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174089a>] __asan_report_load_n_noabort+0x3a/0x40 mm/kasan/report.c:328
 [<ffffffff838f393f>] __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline]
 [<ffffffff838f393f>] mc_hash drivers/net/macvlan.c:225 [inline]
 [<ffffffff838f393f>] macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251
 [<ffffffff838f5206>] macvlan_queue_xmit drivers/net/macvlan.c:482 [inline]
 [<ffffffff838f5206>] macvlan_start_xmit+0x316/0x610 drivers/net/macvlan.c:525
 [<ffffffff8518c379>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff8518c379>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff8518c379>] packet_direct_xmit+0x429/0x610 net/packet/af_packet.c:271
 [<ffffffff851977b4>] packet_snd net/packet/af_packet.c:2938 [inline]
 [<ffffffff851977b4>] packet_sendmsg+0x1f94/0x4eb0 net/packet/af_packet.c:2963
 [<ffffffff8490e2a5>] sock_sendmsg_nosec net/socket.c:612 [inline]
 [<ffffffff8490e2a5>] sock_sendmsg+0xb5/0xf0 net/socket.c:622
 [<ffffffff8490f279>] SYSC_sendto+0x1c9/0x300 net/socket.c:1648
 [<ffffffff84911569>] SyS_sendto+0x9/0x10 net/socket.c:1616
 [<ffffffff85bb80c0>] entry_SYSCALL_64_fastpath+0x23/0xc1
Object at ffff8800ad84e040, in cache kmalloc-1024
Object allocated with size 704 bytes.
Allocation:
PID = 3408
 [<ffffffff81205056>] save_stack_trace+0x26/0x50 arch/x86/kernel/stacktrace.c:67
 [<ffffffff8173f3e6>] save_stack+0x46/0xd0 mm/kasan/kasan.c:450
 [<ffffffff8173f7a9>] set_track mm/kasan/kasan.c:462 [inline]
 [<ffffffff8173f7a9>] kasan_kmalloc+0xc9/0xe0 mm/kasan/kasan.c:532
 [<ffffffff8173bb09>] __do_kmalloc mm/slab.c:3545 [inline]
 [<ffffffff8173bb09>] __kmalloc+0x169/0x6d0 mm/slab.c:3554
 [<ffffffff849a4aea>] kmalloc include/linux/slab.h:483 [inline]
 [<ffffffff849a4aea>] kzalloc include/linux/slab.h:622 [inline]
 [<ffffffff849a4aea>] neigh_alloc net/core/neighbour.c:285 [inline]
 [<ffffffff849a4aea>] __neigh_create+0x1ea/0x19f0 net/core/neighbour.c:457
 [<ffffffff8502ccc1>] ip6_finish_output2+0x841/0x1b90 net/ipv6/ip6_output.c:111
 [<ffffffff85036723>] ip6_finish_output+0x353/0x700 net/ipv6/ip6_output.c:131
 [<ffffffff85036c37>] NF_HOOK_COND include/linux/netfilter.h:233 [inline]
 [<ffffffff85036c37>] ip6_output+0x167/0x530 net/ipv6/ip6_output.c:145
 [<ffffffff8508ac79>] dst_output include/net/dst.h:504 [inline]
 [<ffffffff8508ac79>] NF_HOOK_THRESH.constprop.24+0xc9/0x290 include/linux/netfilter.h:219
 [<ffffffff8508b7c4>] NF_HOOK include/linux/netfilter.h:242 [inline]
 [<ffffffff8508b7c4>] ndisc_send_skb+0x7a4/0x1010 net/ipv6/ndisc.c:471
 [<ffffffff85090046>] ndisc_send_rs+0x116/0x3d0 net/ipv6/ndisc.c:646
 [<ffffffff8505516a>] addrconf_rs_timer+0x28a/0x410 net/ipv6/addrconf.c:3622
 [<ffffffff814a053e>] call_timer_fn+0x14e/0x620 kernel/time/timer.c:1178
 [<ffffffff814a1007>] __run_timers kernel/time/timer.c:1254 [inline]
 [<ffffffff814a1007>] run_timer_softirq+0x5f7/0x9c0 kernel/time/timer.c:1437
 [<ffffffff85bbb26c>] __do_softirq+0x2cc/0xa06 kernel/softirq.c:273
Memory state around the buggy address:
 ffff8800ad84e200: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
 ffff8800ad84e280: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
>ffff8800ad84e300: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
                                           ^
 ffff8800ad84e380: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
 ffff8800ad84e400: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
==================================================================
==================================================================
BUG: KASAN: slab-out-of-bounds in __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline] at addr ffff8800ad953001
BUG: KASAN: slab-out-of-bounds in mc_hash drivers/net/macvlan.c:225 [inline] at addr ffff8800ad953001
BUG: KASAN: slab-out-of-bounds in macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251 at addr ffff8800ad953001
Read of size 4 by task syz-executor.4/7990
CPU: 0 PID: 7990 Comm: syz-executor.4 Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0dd577e ffff8800adad7878 ffffffff82c7f386 ffff8800ad952fff
 ffff8800adad7908 ffff8800ad953040 ffff8801de721300 ffff8800adad78f8
 ffffffff81740207 ffffffff816afd26 0000000000000286 0000000000000286
Call Trace:
 [<ffffffff82c7f386>] __dump_stack lib/dump_stack.c:15 [inline]
 [<ffffffff82c7f386>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff81740207>] object_err mm/kasan/report.c:139 [inline]
 [<ffffffff81740207>] print_address_description mm/kasan/report.c:179 [inline]
 [<ffffffff81740207>] kasan_report_error+0x1e7/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174089a>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174089a>] __asan_report_load_n_noabort+0x3a/0x40 mm/kasan/report.c:328
 [<ffffffff838f393f>] __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline]
 [<ffffffff838f393f>] mc_hash drivers/net/macvlan.c:225 [inline]
 [<ffffffff838f393f>] macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251
 [<ffffffff838f5206>] macvlan_queue_xmit drivers/net/macvlan.c:482 [inline]
 [<ffffffff838f5206>] macvlan_start_xmit+0x316/0x610 drivers/net/macvlan.c:525
 [<ffffffff8518c379>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff8518c379>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff8518c379>] packet_direct_xmit+0x429/0x610 net/packet/af_packet.c:271
 [<ffffffff851977b4>] packet_snd net/packet/af_packet.c:2938 [inline]
 [<ffffffff851977b4>] packet_sendmsg+0x1f94/0x4eb0 net/packet/af_packet.c:2963
 [<ffffffff8490e2a5>] sock_sendmsg_nosec net/socket.c:612 [inline]
 [<ffffffff8490e2a5>] sock_sendmsg+0xb5/0xf0 net/socket.c:622
 [<ffffffff8490f279>] SYSC_sendto+0x1c9/0x300 net/socket.c:1648
 [<ffffffff84911569>] SyS_sendto+0x9/0x10 net/socket.c:1616
 [<ffffffff85bb80c0>] entry_SYSCALL_64_fastpath+0x23/0xc1
Object at ffff8800ad953040, in cache skbuff_head_cache
Object allocated with size 232 bytes.
Allocation:
PID = 7990
 [<ffffffff81205056>] save_stack_trace+0x26/0x50 arch/x86/kernel/stacktrace.c:67
 [<ffffffff8173f3e6>] save_stack+0x46/0xd0 mm/kasan/kasan.c:450
 [<ffffffff8173f7a9>] set_track mm/kasan/kasan.c:462 [inline]
 [<ffffffff8173f7a9>] kasan_kmalloc+0xc9/0xe0 mm/kasan/kasan.c:532
 [<ffffffff8173fbe2>] kasan_slab_alloc+0x12/0x20 mm/kasan/kasan.c:482
 [<ffffffff8173aa54>] kmem_cache_alloc_node+0x154/0x6b0 mm/slab.c:3471
 [<ffffffff849278e8>] __alloc_skb+0xa8/0x5b0 net/core/skbuff.c:218
 [<ffffffff8492cd6d>] alloc_skb include/linux/skbuff.h:895 [inline]
 [<ffffffff8492cd6d>] alloc_skb_with_frags+0x8d/0x4b0 net/core/skbuff.c:4557
 [<ffffffff84918929>] sock_alloc_send_pskb+0x5c9/0x740 net/core/sock.c:1851
 [<ffffffff85197063>] packet_alloc_skb net/packet/af_packet.c:2799 [inline]
 [<ffffffff85197063>] packet_snd net/packet/af_packet.c:2885 [inline]
 [<ffffffff85197063>] packet_sendmsg+0x1843/0x4eb0 net/packet/af_packet.c:2963
 [<ffffffff8490e2a5>] sock_sendmsg_nosec net/socket.c:612 [inline]
 [<ffffffff8490e2a5>] sock_sendmsg+0xb5/0xf0 net/socket.c:622
 [<ffffffff8490f279>] SYSC_sendto+0x1c9/0x300 net/socket.c:1648
 [<ffffffff84911569>] SyS_sendto+0x9/0x10 net/socket.c:1616
 [<ffffffff85bb80c0>] entry_SYSCALL_64_fastpath+0x23/0xc1
Memory state around the buggy address:
 ffff8800ad952f00: fb fb fb fb fb fb fb fb fb fb fb fb fb fc fc fc
 ffff8800ad952f80: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
>ffff8800ad953000: fc fc fc fc fc fc fc fc 00 00 00 00 00 00 00 00
                   ^
 ffff8800ad953080: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
 ffff8800ad953100: 00 00 00 00 00 fc fc fc fc fc fc fc fc fc fc fc
==================================================================
==================================================================
BUG: KASAN: use-after-free in __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline] at addr ffff8800ad958281
BUG: KASAN: use-after-free in mc_hash drivers/net/macvlan.c:225 [inline] at addr ffff8800ad958281
BUG: KASAN: use-after-free in macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251 at addr ffff8800ad958281
Read of size 4 by task syz-executor.3/7993
page:ffffea0002b65600 count:0 mapcount:0 mapping:          (null) index:0x0
flags: 0xfffe0000000000()
page dumped because: kasan: bad access detected
CPU: 1 PID: 7993 Comm: syz-executor.3 Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0dd577e ffff8800adaf7878 ffffffff82c7f386 ffff8800ad95827f
 ffff8800adaf7908 ffff8800ad958281 ffff8800b19862c0 ffff8800adaf78f8
 ffffffff817405ba ffffffff816afd26 0000000000000286 0000000000000286
Call Trace:
 [<ffffffff82c7f386>] __dump_stack lib/dump_stack.c:15 [inline]
 [<ffffffff82c7f386>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff817405ba>] print_address_description mm/kasan/report.c:190 [inline]
 [<ffffffff817405ba>] kasan_report_error+0x59a/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174089a>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174089a>] __asan_report_load_n_noabort+0x3a/0x40 mm/kasan/report.c:328
 [<ffffffff838f393f>] __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline]
 [<ffffffff838f393f>] mc_hash drivers/net/macvlan.c:225 [inline]
 [<ffffffff838f393f>] macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251
 [<ffffffff838f5206>] macvlan_queue_xmit drivers/net/macvlan.c:482 [inline]
 [<ffffffff838f5206>] macvlan_start_xmit+0x316/0x610 drivers/net/macvlan.c:525
 [<ffffffff8518c379>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff8518c379>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff8518c379>] packet_direct_xmit+0x429/0x610 net/packet/af_packet.c:271
 [<ffffffff851977b4>] packet_snd net/packet/af_packet.c:2938 [inline]
 [<ffffffff851977b4>] packet_sendmsg+0x1f94/0x4eb0 net/packet/af_packet.c:2963
 [<ffffffff8490e2a5>] sock_sendmsg_nosec net/socket.c:612 [inline]
 [<ffffffff8490e2a5>] sock_sendmsg+0xb5/0xf0 net/socket.c:622
 [<ffffffff8490f279>] SYSC_sendto+0x1c9/0x300 net/socket.c:1648
 [<ffffffff84911569>] SyS_sendto+0x9/0x10 net/socket.c:1616
 [<ffffffff85bb80c0>] entry_SYSCALL_64_fastpath+0x23/0xc1
Memory state around the buggy address:
 ffff8800ad958180: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8800ad958200: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
>ffff8800ad958280: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
                   ^
 ffff8800ad958300: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
 ffff8800ad958380: ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff
==================================================================
==================================================================
BUG: KASAN: slab-out-of-bounds in __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline] at addr ffff8800ad95a5c1
BUG: KASAN: slab-out-of-bounds in mc_hash drivers/net/macvlan.c:225 [inline] at addr ffff8800ad95a5c1
BUG: KASAN: slab-out-of-bounds in macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251 at addr ffff8800ad95a5c1
Read of size 4 by task syz-executor.2/8011
CPU: 1 PID: 8011 Comm: syz-executor.2 Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0dd577e ffff8800ad997878 ffffffff82c7f386 ffff8800ad95a5bf
 ffff8800ad997908 ffff8800ad95a580 ffff88012bc00200 ffff8800ad9978f8
 ffffffff81740207 ffffffff816afd26 0000000000000286 0000000000000286
Call Trace:
 [<ffffffff82c7f386>] __dump_stack lib/dump_stack.c:15 [inline]
 [<ffffffff82c7f386>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff81740207>] object_err mm/kasan/report.c:139 [inline]
 [<ffffffff81740207>] print_address_description mm/kasan/report.c:179 [inline]
 [<ffffffff81740207>] kasan_report_error+0x1e7/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174089a>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174089a>] __asan_report_load_n_noabort+0x3a/0x40 mm/kasan/report.c:328
 [<ffffffff838f393f>] __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline]
 [<ffffffff838f393f>] mc_hash drivers/net/macvlan.c:225 [inline]
 [<ffffffff838f393f>] macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251
 [<ffffffff838f5206>] macvlan_queue_xmit drivers/net/macvlan.c:482 [inline]
 [<ffffffff838f5206>] macvlan_start_xmit+0x316/0x610 drivers/net/macvlan.c:525
 [<ffffffff8518c379>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff8518c379>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff8518c379>] packet_direct_xmit+0x429/0x610 net/packet/af_packet.c:271
 [<ffffffff851977b4>] packet_snd net/packet/af_packet.c:2938 [inline]
 [<ffffffff851977b4>] packet_sendmsg+0x1f94/0x4eb0 net/packet/af_packet.c:2963
 [<ffffffff8490e2a5>] sock_sendmsg_nosec net/socket.c:612 [inline]
 [<ffffffff8490e2a5>] sock_sendmsg+0xb5/0xf0 net/socket.c:622
 [<ffffffff8490f279>] SYSC_sendto+0x1c9/0x300 net/socket.c:1648
 [<ffffffff84911569>] SyS_sendto+0x9/0x10 net/socket.c:1616
 [<ffffffff85bb80c0>] entry_SYSCALL_64_fastpath+0x23/0xc1
Object at ffff8800ad95a580, in cache kmalloc-64
Object allocated with size 64 bytes.
Allocation:
PID = 4
 [<ffffffff81205056>] save_stack_trace+0x26/0x50 arch/x86/kernel/stacktrace.c:67
 [<ffffffff8173f3e6>] save_stack+0x46/0xd0 mm/kasan/kasan.c:450
 [<ffffffff8173f7a9>] set_track mm/kasan/kasan.c:462 [inline]
 [<ffffffff8173f7a9>] kasan_kmalloc+0xc9/0xe0 mm/kasan/kasan.c:532
 [<ffffffff8173cdd2>] kmem_cache_alloc_trace+0x142/0x6b0 mm/slab.c:3447
 [<ffffffff84991c53>] kmalloc include/linux/slab.h:478 [inline]
 [<ffffffff84991c53>] dst_cow_metrics_generic+0x43/0xb0 net/core/dst.c:318
 [<ffffffff850669ff>] ipv6_cow_metrics+0x5f/0x150 net/ipv6/route.c:188
 [<ffffffff85072333>] dst_metrics_write_ptr include/net/dst.h:143 [inline]
 [<ffffffff85072333>] dst_metric_set include/net/dst.h:204 [inline]
 [<ffffffff85072333>] icmp6_dst_alloc+0x463/0x560 net/ipv6/route.c:1637
 [<ffffffff850b6e28>] mld_sendpack+0x578/0xb80 net/ipv6/mcast.c:1633
 [<ffffffff850b83c4>] mld_send_initial_cr.part.30+0xd4/0x110 net/ipv6/mcast.c:2049
 [<ffffffff850c2465>] mld_send_initial_cr net/ipv6/mcast.c:2033 [inline]
 [<ffffffff850c2465>] ipv6_mc_dad_complete+0x85/0x110 net/ipv6/mcast.c:2056
 [<ffffffff850556df>] addrconf_dad_completed+0x3ef/0x760 net/ipv6/addrconf.c:3867
 [<ffffffff8505621b>] addrconf_dad_work+0x7cb/0x980 net/ipv6/addrconf.c:3800
 [<ffffffff8139210b>] process_one_work+0x69b/0x1570 kernel/workqueue.c:2122
 [<ffffffff813930b7>] worker_thread+0xd7/0xf10 kernel/workqueue.c:2256
 [<ffffffff813a3a09>] kthread+0x209/0x2d0 kernel/kthread.c:209
 [<ffffffff85bb8312>] ret_from_fork+0x22/0x50 arch/x86/entry/entry_64.S:392
Memory state around the buggy address:
 ffff8800ad95a480: 00 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc
 ffff8800ad95a500: 00 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc
>ffff8800ad95a580: 00 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc
                                           ^
 ffff8800ad95a600: 00 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc
 ffff8800ad95a680: 00 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc
==================================================================
==================================================================
BUG: KASAN: slab-out-of-bounds in __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline] at addr ffff8800ad953501
BUG: KASAN: slab-out-of-bounds in mc_hash drivers/net/macvlan.c:225 [inline] at addr ffff8800ad953501
BUG: KASAN: slab-out-of-bounds in macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251 at addr ffff8800ad953501
Read of size 4 by task syz-executor.5/8007
CPU: 0 PID: 8007 Comm: syz-executor.5 Tainted: G    B           4.6.0-syzkaller #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011
 1ffffffff0dd577e ffff8801281c7878 ffffffff82c7f386 ffff8800ad9534ff
 ffff8801281c7908 ffff8800ad953400 ffff8801de721300 ffff8801281c78f8
 ffffffff81740207 ffffffff816afd26 0000000000000286 0000000000000286
Call Trace:
 [<ffffffff82c7f386>] __dump_stack lib/dump_stack.c:15 [inline]
 [<ffffffff82c7f386>] dump_stack+0xe6/0x120 lib/dump_stack.c:51
 [<ffffffff81740207>] object_err mm/kasan/report.c:139 [inline]
 [<ffffffff81740207>] print_address_description mm/kasan/report.c:179 [inline]
 [<ffffffff81740207>] kasan_report_error+0x1e7/0x5c0 mm/kasan/report.c:275
 [<ffffffff8174089a>] kasan_report mm/kasan/report.c:297 [inline]
 [<ffffffff8174089a>] __asan_report_load_n_noabort+0x3a/0x40 mm/kasan/report.c:328
 [<ffffffff838f393f>] __get_unaligned_cpu32 include/linux/unaligned/packed_struct.h:19 [inline]
 [<ffffffff838f393f>] mc_hash drivers/net/macvlan.c:225 [inline]
 [<ffffffff838f393f>] macvlan_broadcast+0x48f/0x5b0 drivers/net/macvlan.c:251
 [<ffffffff838f5206>] macvlan_queue_xmit drivers/net/macvlan.c:482 [inline]
 [<ffffffff838f5206>] macvlan_start_xmit+0x316/0x610 drivers/net/macvlan.c:525
 [<ffffffff8518c379>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff8518c379>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff8518c379>] packet_direct_xmit+0x429/0x610 net/packet/af_packet.c:271
 [<ffffffff851977b4>] packet_snd net/packet/af_packet.c:2938 [inline]
 [<ffffffff851977b4>] packet_sendmsg+0x1f94/0x4eb0 net/packet/af_packet.c:2963
 [<ffffffff8490e2a5>] sock_sendmsg_nosec net/socket.c:612 [inline]
 [<ffffffff8490e2a5>] sock_sendmsg+0xb5/0xf0 net/socket.c:622
 [<ffffffff8490f279>] SYSC_sendto+0x1c9/0x300 net/socket.c:1648
 [<ffffffff84911569>] SyS_sendto+0x9/0x10 net/socket.c:1616
 [<ffffffff85bb80c0>] entry_SYSCALL_64_fastpath+0x23/0xc1
Object at ffff8800ad953400, in cache skbuff_head_cache
Object freed, allocated with size 232 bytes
Allocation:
PID = 7843
 [<ffffffff81205056>] save_stack_trace+0x26/0x50 arch/x86/kernel/stacktrace.c:67
 [<ffffffff8173f3e6>] save_stack+0x46/0xd0 mm/kasan/kasan.c:450
 [<ffffffff8173f7a9>] set_track mm/kasan/kasan.c:462 [inline]
 [<ffffffff8173f7a9>] kasan_kmalloc+0xc9/0xe0 mm/kasan/kasan.c:532
 [<ffffffff8173fbe2>] kasan_slab_alloc+0x12/0x20 mm/kasan/kasan.c:482
 [<ffffffff8173aa54>] kmem_cache_alloc_node+0x154/0x6b0 mm/slab.c:3471
 [<ffffffff849278e8>] __alloc_skb+0xa8/0x5b0 net/core/skbuff.c:218
 [<ffffffff83d0e2b0>] alloc_skb include/linux/skbuff.h:895 [inline]
 [<ffffffff83d0e2b0>] new_skb+0x20/0x1d0 drivers/block/aoe/aoecmd.c:67
 [<ffffffff83d19303>] aoecmd_cfg_pkts drivers/block/aoe/aoecmd.c:427 [inline]
 [<ffffffff83d19303>] aoecmd_cfg+0x1a3/0x580 drivers/block/aoe/aoecmd.c:1433
 [<ffffffff83d1dc6c>] discover_timer+0xdc/0x130 drivers/block/aoe/aoemain.c:44
 [<ffffffff814a053e>] call_timer_fn+0x14e/0x620 kernel/time/timer.c:1178
 [<ffffffff814a1007>] __run_timers kernel/time/timer.c:1254 [inline]
 [<ffffffff814a1007>] run_timer_softirq+0x5f7/0x9c0 kernel/time/timer.c:1437
 [<ffffffff85bbb26c>] __do_softirq+0x2cc/0xa06 kernel/softirq.c:273
Deallocation:
PID = 2415
 [<ffffffff81205056>] save_stack_trace+0x26/0x50 arch/x86/kernel/stacktrace.c:67
 [<ffffffff8173f3e6>] save_stack+0x46/0xd0 mm/kasan/kasan.c:450
 [<ffffffff8173fc8b>] set_track mm/kasan/kasan.c:462 [inline]
 [<ffffffff8173fc8b>] kasan_slab_free+0x9b/0xb0 mm/kasan/kasan.c:501
 [<ffffffff81738e74>] __cache_free mm/slab.c:3332 [inline]
 [<ffffffff81738e74>] kmem_cache_free+0x94/0x500 mm/slab.c:3583
 [<ffffffff84924f0c>] kfree_skbmem+0xac/0xd0 net/core/skbuff.c:622
 [<ffffffff8492c4c5>] __kfree_skb+0x15/0x20 net/core/skbuff.c:684
 [<ffffffff8492c560>] kfree_skb+0x90/0x2f0 net/core/skbuff.c:704
 [<ffffffff85260f1a>] nr_xmit+0xaa/0x100 net/netrom/nr_dev.c:148
 [<ffffffff8497d9d9>] __netdev_start_xmit include/linux/netdevice.h:3928 [inline]
 [<ffffffff8497d9d9>] netdev_start_xmit include/linux/netdevice.h:3937 [inline]
 [<ffffffff8497d9d9>] xmit_one net/core/dev.c:2871 [inline]
 [<ffffffff8497d9d9>] dev_hard_start_xmit+0x6b9/0x1140 net/core/dev.c:2887
 [<ffffffff84980375>] __dev_queue_xmit+0x1b85/0x1f40 net/core/dev.c:3358
 [<ffffffff8498073b>] dev_queue_xmit+0xb/0x10 net/core/dev.c:3392
 [<ffffffff83d1dd68>] tx+0x68/0xb0 drivers/block/aoe/aoenet.c:63
 [<ffffffff83d0f5c4>] kthread+0x1c4/0x360 drivers/block/aoe/aoecmd.c:1300
 [<ffffffff813a3a09>] kthread+0x209/0x2d0 kernel/kthread.c:209
 [<ffffffff85bb8312>] ret_from_fork+0x22/0x50 arch/x86/entry/entry_64.S:392
Memory state around the buggy address:
 ffff8800ad953400: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ffff8800ad953480: fb fb fb fb fb fb fb fb fb fb fb fb fb fc fc fc
>ffff8800ad953500: fc fc fc fc fc fc fc fc fb fb fb fb fb fb fb fb
                   ^
 ffff8800ad953580: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
 ffff8800ad953600: fb fb fb fb fb fc fc fc fc fc fc fc fc fc fc fc
==================================================================

